{"version":3,"sources":["graphics/top-bar-logo_0_0.png","graphics/play-solid.svg","graphics/arrow-to-left-regular.svg","graphics/arrow-to-right-regular.svg","graphics/search-minus-solid.svg","graphics/search-plus-solid.svg","containers/Navigation.tsx","containers/ResourceLoader.tsx","graphics/arrow-alt-to-top-regular.svg","graphics/file-import-regular.svg","graphics/trash-solid.svg","annotations/AnnotationSubmitter.tsx","annotations/selectionHandler.tsx","graphics/info-circle-regular.svg","annotations/AnnotationItem.tsx","annotations/annotationList.tsx","annotations/playlistItem.tsx","annotations/renditionsPlaylist.tsx","search/SearchQuery.ts","containers/FtempoSearch.tsx","../../trompa-annotation-component/dist/utils.js","../../trompa-annotation-component/dist/annotations/Annotation.js","../../trompa-annotation-component/dist/annotations/Rating.js","../../trompa-annotation-component/dist/audio-visualiser/WaveForm.js","../../trompa-annotation-component/dist/resources/SessionViewer.js","../../trompa-annotation-component/dist/API/CEAPI.js","../../trompa-annotation-component/dist/resources/AudioObject.js","../../trompa-annotation-component/dist/API/SolidAPI.js","../../trompa-annotation-component/dist/resources/AudioSelector.js","../../trompa-annotation-component/dist/resources/DefinedTermSetEditor.js","containers/SelectableScoreApp.tsx","containers/SolidWrapper.tsx","containers/HelpPage.tsx","containers/AnnotatorRouter.tsx","App.tsx","index.tsx"],"names":["module","exports","Navigation","session","useContext","SessionContext","location","useLocation","history","useHistory","Navbar","bg","expand","Brand","href","src","Logo","alt","Nav","className","Link","as","to","info","isLoggedIn","Text","style","display","alignItems","datasetUrl","webId","thingUrl","marginLeft","property","FOAF","name","iri","value","onLogout","go","Button","oidcIssuer","redirectUrl","window","origin","pathname","search","MUSIC_COMPOSITION_FRAGMENT","gql","EARLY_MUSIC_WORKS","FtempoCatalogueSearchType","filters","preprocessQuery","query","searchAllQuery","searchQuery","processSearchResult","result","Array","isArray","itemListElement","searchConfig","SearchConfig","searchTypes","renderSearchResult","type","item","onClick","composer","length","variant","heading","title","source","sampleScores","url","ResourceLoader","useState","userUrl","setUserUrl","loadUrl","push","Row","Col","sm","map","score","key","e","preventDefault","Form","onSubmit","Control","placeholder","onChange","target","config","uri","placeholderText","onResultClick","node","workExample","contentUrl","_path","_excluded","_extends","Object","assign","i","arguments","prototype","hasOwnProperty","call","apply","this","_objectWithoutProperties","excluded","sourceKeys","keys","indexOf","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","_ref","svgRef","props","createElement","focusable","role","viewBox","ref","fill","d","ForwardRef","forwardRef","DescribingInput","body","setBody","id","uuidv4","CueImageInput","LinkingInput","CueMediaInput","seconds","pattern","PlaylistInput","AnnotationSubmitter","motivation","setMotivation","bodyEmpty","constructor","Check","inline","label","checked","annotation","selection","elem","getAttribute","created","Date","toISOString","creator","console","log","saveAnnotation","width","height","Selectors","SelectionHandler","state","selectorString","newSelectorString","setState","handleStringChange","filter","val","selector","updateSelectorList","Component","AnnotationItem","showDetails","stopPropagation","parent","closest","details","querySelector","isVisible","classList","remove","add","visibleDetails","showReplyDetails","replyTarget","replyTargetId","onAnnoReplyHandler","showConfirm","confirmScreen","isConfirmVisible","visibleConfirm","onPlayClick","bodyMedia","onMediaClick","onPreviewclick","_children","children","isPictureShowing","document","addEventListener","previewButtonContent","onShowReplyClick","rootAnno","replyTargetAnnos","querySelectorAll","forEach","replyTargetAnno","replyTargetAnnoId","dataset","replyAnnotationTarget","rootAnnoTargetId","selfId","areRepliesVisible","isClicked","appendChild","showReplyHandler","noLongerShowing","from","getElementsByClassName","noReplyShowing","showing","showingReply","annoContainer","warn","renderSwitch","permission","modifyPermissionsElement","date","replies","areRepliesPresent","reply","datasetWithAcl","getPublicAccess","read","getAgentAccessAll","userMayModifyAccess","grantPublic","icons","unchecked","aria-hidden","data-prefix","data-icon","xmlns","vertical-align","revokePublic","commonAnnoComponents","deleteAnno","paddingTop","onMouseEnter","onMouseLeave","replyButtonsCluster","showRepliesButtonContent","bodyD","bodyL","repTarget","data-target","data-self-id","startsWith","rel","appendURL","cleanMediaString","split","PlayLogo","alignContent","textAlign","maxWidth","maxHeight","marginTop","data-reply-annotation-target","resourceAcl","undefined","aclModified","userId","resp","bind","updateDatasetAcl","testReplyRetrieval","auth","fetch","method","then","a","response","json","data","ok","error","message","status","Promise","reject","onRefreshClick","catch","currentSession","s","getSolidDatasetWithAcl","hasResourceAcl","getResourceAcl","now","hasAccessibleAcl","hasFallbackAcl","createAclFromFallbackAcl","userControllableResourceAcl","setAgentResourceAccess","append","write","control","nextProps","nextState","updatedAcl","setPublicResourceAccess","saveAclFor","AnnotationList","order","sortedFilteredAnno","allEntries","anno","filteringEntries","includes","sort","b","localeCompare","focusId","currentTarget","c","noFocusElement","focusElement","annoIdFragment","substr","lastIndexOf","React","PlaylistItem","delete","link","frameBorder","RenditionsPlaylist","visible","setVisible","pitchesToIntervalMapping","pitches","interval_mapping","alphabet","pitch_nums","pitch","toUpperCase","oct","pitch_intervals","letter","Math","abs","join","FtempoSearch","mei","vrvToolkit","getMEI","meiVoiceQueryStrings","staffDefinitions","getElementsByTagName","staffs","sd","staffLabel","attributes","innerHTML","n","getNamedItem","notes","measures","measure","measureStaffs","staff","measureStaffId","note","nattrs","pname","parseInt","ret","parseMei","DOMParser","parseFromString","selectedOption","setSelectedOption","searchResults","setSearchResults","selectedVoice","codestring","headers","JSON","stringify","disabled","allowZeroExpanded","randomColor","alpha","random","startAndEndFromAnnotation","start","end","AnnotationTarget","fragmentStart","fragmentEnd","AnnotationMotivation","TimeFragmentType","__extends","extendStatics","setPrototypeOf","__proto__","p","TypeError","String","__","create","__assign","t","dataModelItemToJSONLD","dataModelItem","resource","jsonldRepresentation","toJSONLD","k","translatedTarget","targetObjectWithResourceToUrlString","toString","targetUrl","URL","TextDirection","AnnotationType","_super","NotAnAnnotationError","Error","AnnotationExternalWebResource","params","format","language","processingLanguage","textDirection","AnnotationTextualBody","_this","TextualBody","defineProperty","get","hash","substring","set","fragment","enumerable","configurable","fragmentToStartAndEnd","exec","parseFloat","existingEnd","timeString","existingStart","isNaN","Number","targetUri","frag","Annotation","isNew","identifier","customMotivation","canonical","via","_a","WHOLE","PUNCTUAL","RANGE","newTP","Rating","onInputChange","event","onRatingChange","getComponentFromType","ratingValue","_b","bestRating","_c","worstRating","filledStars","emptyStars","_jsxs","color","fontSize","_jsx","min","max","ProgressBar","render","htmlFor","Waveform","form","createRef","componentDidMount","initialRegions","wavesurfer","WaveSurfer","barWidth","cursorWidth","container","backend","interact","progressColor","responsive","waveColor","cursorColor","plugins","RegionsPlugin","regions","dragSelection","slop","TimelinePlugin","CursorPlugin","showTime","customShowTimeStyle","bottom","track","load","on","enableDragSelection","region","shiftKey","playLoop","play","throttledSelectRegion","throttledCreateRegion","throttledUpdateRegion","throttledDeleteRegion","once","pause","playing","drawer","doubleClick","clickPosition","handleEvent","computedStartTime","util","getRegionSnapToGridValue","getDuration","computedStartTimeFloat","toPrecision","resize","addRegion","loadRegions","createNewRegion","updateRegionInWaveSurfer","selectedRegion","list","isPunctual","update","deleteRegionInWaveSurfer","annotationId","selectRegionInWaveSurfer","fireEvent","handlePlay","isPlaying","Boolean","_throttle","updateRegion","leading","deleteRegion","selectRegion","createRegion","resourceURL","SessionViewer","templateObject_1","templateObject_2","templateObject_3","templateObject_4","templateObject_5","templateObject_6","templateObject_7","templateObject_8","templateObject_9","templateObject_10","templateObject_11","templateObject_12","templateObject_13","templateObject_14","templateObject_15","templateObject_16","templateObject_17","templateObject_18","templateObject_19","templateObject_20","templateObject_21","templateObject_22","templateObject_23","templateObject_24","templateObject_25","templateObject_26","templateObject_27","templateObject_28","httpVerb","__awaiter","thisArg","_arguments","P","generator","resolve","fulfilled","step","next","rejected","done","__generator","f","y","g","_","sent","trys","ops","verb","Symbol","iterator","v","op","pop","AudioSelector","nodeid","searchNode","error_1","debug","trompaClient","getThingById","ThingInterface","onSelect","Group","controlId","xs","__makeTemplateObject","cooked","raw","TrompaError","GetThingInterfaceById","TrompaClient","authProxyUrl","apolloClient","getApiToken","apiTokenExpired","token","localStorage","setItem","apiToken","getItem","decoded","jwt_decode","exp","bodyId","_i","response_1","targetId","response_2","e_1","_d","mutate","mutation","CreateAnnotationTextualBody","variables","errors","CreateAnnotationCETarget","field","fieldName","MergeAnnotationCETargetTarget","annotationCeTargetId","ceNodeId","nodeId","CreateAnnotation","MergeAnnotationBodyText","bodyNodeId","MergeAnnotationTargetNode","targetNodeId","deleteAnnotation","DeleteAnnotation","getAnnotation","GetAnnotation","getAnnotationsForUser","user","GetAnnotationsForCreator","getAnnotationsForItem","GetAnnotationsForItem","getAnnotationToolkitForItem","itemId","GetAnnotationToolkitForItem","deleteDefinedTerm","definedTermSetIdentifier","definedTermIdentifier","DeleteDefinedTerm","deleteDefinedTermSet","DeleteDefinedTermSet","createOrUpdateDefinedTerm","dtsIdentifier","definedTerm","CreateDefinedTerm","termCode","additionalType","MergeDefinedTermSetHasDefinedTerm","dtsId","dtId","createOrUpdateDefinedTermSet","definedTermSet","CreateDefinedTermSet","getDefinedTermSetsForUser","QueryDefinedTermSetForUser","getAnnotationPaletteForUser","getAnnotationToolkitForUser","getRatingDefinitionsForUser","GetRatingDefinitionsForUser","createRatingDefinition","ratingDefinition","CreateRating","description","deleteRating","ratingIdentifier","DeleteRating","createMotivation","CreateAnnotationCEMotivation","broaderUrl","broaderMotivation","deleteMotivation","DeleteAnnotationCEMotivation","getMotivationsForUser","GetAnnotationCEMotivationsForUser","annotationFromCE","ceannotation","CE_URL","targetNode","endsWith","bodyUrl","bodyText","bodyNode","__typename","parseMotivationValue","motivationUrl","motivationDefinedTerm","motivationNode","ceMotivation","newAnnotation","formatted","motivationValue","COMMENTING","DESCRIBING","TAGGING","CLASSIFYING","ASSESSING","LINKING","DefinedTermFragment","DefinedTermSetFragment","annotation_common","__spreadArray","il","j","DefinedTermSetEditor","createDefinedTermSet","dts","existingData","newData","newDtsName","hasDefinedTerm","slice","createDefinedTerm","selectedDts","dt","newDtName","index","e_2","splice","dtIdentifier","dtIndex","existingDefinedTerms","e_3","setSelectedDts","selected","updateNewDtsName","updateNewDtName","DefinedTermSet","lg","ListGroup","Item","action","active","size","InputGroup","FormControl","_Fragment","AudioObject","onProperty","ApplicationMode","SolidClient","solidRESTInteraction","payload","fetchOptions","err","isPublicReadable","resourceUri","access","userControlsAccess","getAgentAccess","controlRead","grantPublicReadable","setPublicAccess","newAccess","revokePublicReadable","profileDocUri","profileDataset","profile","postUrl","podUrl","getSolidDataset","getThing","getUrl","WS","storage","POST","annotationUrl","DELETE","fetchAnnotation","GET","fetchAnnotations","containerUrl","containerDataset","annotationUrls","annotationPromises","annotations","filtered","getContainedResourceUrlAll","all","responses","readerPromises","getReader","dataAllResponses","TextDecoder","decode","parse","passes","valsInAnno_1","viewPortHeight","outerHeight","viewPortWidth","outerWidth","defaultVerovioHeight","defaultVerovioWidth","SelectableScoreApp","player","zoomIn","initialZoom","vrvOptions","scale","initialHeight","pageHeight","initialWidth","pageWidth","newVrvOptions","zoomOut","replyAnnotationTargetId","solidClient","solidSession","submitUri","annoToDisplay","onReceiveAnnotationContainerContent","currentMedia","seekTo","replace","current","content","alert","mb","measuresToAnnotationsMapList","distinctMeasures","jsonTarget","element","el","Set","annoId","newMap","measureToAnnoMap","m","mId","currentAnnotation","measuresToAnnotationsMap","annotatedMeasuresOnScreen","measureId","coords","convertCoords","measureBox","measureBoxBackground","coordsBox","left","floor","x","top","ceil","x2","y2","setAttribute","onclick","bgBoxes","frontBox","box","bgBoxId","handleAnnoShowingUpdate","bodies","_annoIds","jsonIds","_filteredAnnoIds","compare","annotationsToDisplay","handleScoreUpdate","scoreElement","annotate","applicationMode","Annotate","annoValue","hasContent","scoreReady","Ready","adjustPageHeight","footer","unit","handleSelectionChange","handlePageTurn","getElementById","getBBox","staff1","bbox","tagName","offset","parentElement","getBoundingClientRect","matrix","getScreenCTM","buttonContent","ArrowToLeft","SearchMinus","SearchPlus","ArrowToRight","onSelectionChange","onScoreUpdate","selectionArea","onScoreReady","Search","vrvTk","controls","onReady","connect","dispatch","bindActionCreators","SolidWrapper","userInput","setUserInput","useSession","HelpPage","AnnotatorRouter","URLSearchParams","exact","path","client","ApolloClient","cache","InMemoryCache","App","createStoreWithMiddleware","applyMiddleware","thunk","ReduxPromise","createStore","sessionId","onSessionRestore","u","store","reducers","Container","fluid","paddingLeft","ReactDOM"],"mappings":"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","file":"static/js/main.160bd493.chunk.js","sourcesContent":["module.exports = \"data:image/png;base64,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\"","module.exports = __webpack_public_path__ + \"static/media/play-solid.f79fe6ae.svg\";","module.exports = __webpack_public_path__ + \"static/media/arrow-to-left-regular.1bf90cef.svg\";","module.exports = __webpack_public_path__ + \"static/media/arrow-to-right-regular.f0cdfa6a.svg\";","module.exports = __webpack_public_path__ + \"static/media/search-minus-solid.bc6bab64.svg\";","module.exports = __webpack_public_path__ + \"static/media/search-plus-solid.5485d017.svg\";","import { useContext } from \"react\";\nimport { Nav, Navbar } from \"react-bootstrap-v5\";\nimport {\n  CombinedDataProvider,\n  LoginButton,\n  LogoutButton,\n  SessionContext,\n  Text,\n} from \"@inrupt/solid-ui-react\";\n\nimport { FOAF } from \"@inrupt/lit-generated-vocab-common\";\nimport { Link, useHistory, useLocation } from \"react-router-dom\";\nimport { Button } from \"react-bootstrap-v5\";\nimport React from \"react\";\n\nimport Logo from \"../graphics/top-bar-logo_0_0.png\";\n\nexport default function Navigation() {\n  const trompaIdp = \"https://trompa-solid.upf.edu\";\n  const { session } = useContext(SessionContext);\n  const location = useLocation();\n  const history = useHistory();\n\n  return (\n    <Navbar bg=\"light\" expand=\"xl\">\n      <Navbar.Brand href=\"#home\">\n        <img src={Logo} alt=\"Trompa logo\" />\n        Music scholars annotation tool\n      </Navbar.Brand>\n      <Nav className=\"me-auto\">\n        <Nav.Link as={Link} to=\"/\">\n          Home\n        </Nav.Link>\n        <Nav.Link as={Link} to=\"/help\">\n          Help\n        </Nav.Link>\n      </Nav>\n      <Nav>\n        {session.info.isLoggedIn ? (\n          <Navbar.Text style={{ display: \"inline-flex\", alignItems: \"center\" }}>\n            <CombinedDataProvider\n              datasetUrl={session.info.webId!}\n              thingUrl={session.info.webId!}\n            >\n              Logged in:{\" \"}\n              <Text\n                style={{ marginLeft: \".1vw\" }}\n                property={FOAF.name.iri.value}\n              />\n            </CombinedDataProvider>\n            &emsp;\n            <LogoutButton\n              onLogout={() => {\n                // Tell react-router to \"reload\" this page so that we refresh all items that check the user session\n                history.go(0);\n              }}\n            >\n              <Button className=\"logoutButton\">Log out</Button>\n            </LogoutButton>\n          </Navbar.Text>\n        ) : (\n          <LoginButton\n            oidcIssuer={trompaIdp}\n            redirectUrl={\n              window.location.origin +\n              \"/music-scholars-annotator\" +\n              \"/#\" +\n              location.pathname +\n              location.search\n            }\n          >\n            <Button className=\"loginButton\">Log in</Button>\n          </LoginButton>\n        )}\n      </Nav>\n    </Navbar>\n  );\n}\n","import React, { useState } from \"react\";\nimport MultiModalComponent, {\n  SearchConfig,\n  SearchResult,\n} from \"trompa-multimodal-component\";\nimport { Button, Col, Form, Row } from \"react-bootstrap-v5\";\nimport { useHistory } from \"react-router-dom\";\nimport gql from \"graphql-tag\";\n\nconst CE_URL = \"https://api.trompamusic.eu\";\n\nconst MUSIC_COMPOSITION_FRAGMENT = gql`\n  fragment MusicCompositionFrag on MusicComposition {\n    identifier\n    contributor\n    name\n    source\n    title\n    composer {\n      name\n    }\n    workExample(filter: { encodingFormat: \"application/mei+xml\" }) {\n      ... on MediaObject {\n        identifier\n        source\n        contentUrl\n        encodingFormat\n      }\n    }\n  }\n`;\n\nconst EARLY_MUSIC_WORKS = gql`\n  ${MUSIC_COMPOSITION_FRAGMENT}\n  query ($query: String!) {\n    allResults: ItemList(identifier: \"e91489d7-a776-40dd-8abf-0c934922bd99\") {\n      identifier\n      name\n      itemListElement(filter: { name_regexp: $query }) {\n        __typename\n        ...MusicCompositionFrag\n      }\n    }\n  }\n`;\n\nclass FtempoCatalogueSearchType {\n  name = \"MusicComposition\";\n\n  static filters = [];\n\n  static preprocessQuery = (query: string) => {\n    return `(?i).*${query}.*`;\n  };\n\n  static searchAllQuery = EARLY_MUSIC_WORKS;\n\n  static searchQuery = gql`\n    ${MUSIC_COMPOSITION_FRAGMENT}\n    query ($filter: _ThingInterfaceFilter) {\n      results: ItemList(identifier: \"e91489d7-a776-40dd-8abf-0c934922bd99\") {\n        identifier\n        name\n        itemListElement(filter: $filter, first: 50) {\n          ...MusicCompositionFrag\n        }\n      }\n    }\n  `;\n\n  static processSearchResult = (result: any) => {\n    // Find the itemListElements of this ItemList, instead of a list of ItemLists\n    if (Array.isArray(result) && result[0]) {\n      return result[0].itemListElement;\n    }\n\n    return [];\n  };\n}\n\nconst searchConfig = new SearchConfig({\n  searchTypes: [FtempoCatalogueSearchType],\n});\n\nconst renderSearchResult = (\n  type: string,\n  item: any,\n  onClick: (item: any) => void\n) => {\n  if (type === \"MusicComposition\") {\n    let composer = null;\n    if (item.composer.length > 0) {\n      composer = item.composer[0].name;\n    }\n    return (\n      <SearchResult\n        variant=\"default\"\n        type=\"Composition\"\n        heading={composer}\n        title={item.name || item.title}\n        source={item.source}\n        onClick={() => onClick(item)}\n      />\n    );\n  }\n  return (\n    <SearchResult\n      title={item.title}\n      variant=\"default\"\n      onClick={() => onClick(item)}\n    />\n  );\n};\n\nconst sampleScores = [\n  {\n    name: \"Mahler - Symphony No. 4 (Piano 4 hands version)\",\n    url: \"https://raw.githubusercontent.com/trompamusic-encodings/Mahler_Symphony_No4_Doblinger-4hands/master/Mahler_No4_1-Doblinger-4hands.mei\",\n  },\n  {\n    name: \"Orlando di Lasso - Bon jour, mon coeur (from https://cpdl.org)\",\n    url: \"https://trompa-mtg.upf.edu/data/meiconversion/79f3e3c5-29b7-424f-9144-4cc6d720c206.mei\",\n  },\n];\n\nexport default function ResourceLoader() {\n  const [userUrl, setUserUrl] = useState(\"\");\n  const history = useHistory();\n\n  const loadUrl = (url: string) => {\n    history.push({\n      pathname: \"/annotate\",\n      search: `?resource=${url}`,\n    });\n  };\n\n  return (\n    <Row>\n      <Col sm={2} />\n      <Col>\n        <p>&nbsp;</p>\n        <h2>Load a score</h2>\n        <h3>Use a sample score</h3>\n        <ul>\n          {sampleScores.map((score) => {\n            return (\n              <li key={score.url}>\n                <a\n                  href={`/annotate?resource=${score.url}`}\n                  onClick={(e) => {\n                    e.preventDefault();\n                    loadUrl(score.url);\n                  }}\n                >\n                  {score.name}\n                </a>\n              </li>\n            );\n          })}\n        </ul>\n        <p>or</p>\n        <h3>Load an MEI URL</h3>\n        <Form\n          onSubmit={(e) => {\n            e.preventDefault();\n            if (userUrl && userUrl !== \"\") {\n              loadUrl(userUrl);\n            }\n          }}\n        >\n          <Row>\n            <Col sm={11}>\n              <Form.Control\n                type=\"input\"\n                placeholder=\"Enter URL\"\n                value={userUrl}\n                onChange={(e) => setUserUrl(e.target.value)}\n              />\n            </Col>\n            <Col>\n              <Button\n                variant=\"primary\"\n                type=\"submit\"\n                onClick={() => {\n                  if (userUrl && userUrl !== \"\") {\n                    loadUrl(userUrl);\n                  }\n                }}\n              >\n                Load\n              </Button>\n            </Col>\n          </Row>\n        </Form>\n        <p>or</p>\n        <h3>Search the TROMPA early music database</h3>\n        <MultiModalComponent\n          config={searchConfig}\n          uri={CE_URL}\n          renderSearchResult={renderSearchResult}\n          placeholderText=\"Search for a composition...\"\n          onResultClick={(node: any) => {\n            if (node.workExample.length) {\n              loadUrl(node.workExample[0].contentUrl);\n            }\n          }}\n        />\n      </Col>\n      <Col sm={2} />\n    </Row>\n  );\n}\n","var _path;\n\nvar _excluded = [\"svgRef\", \"title\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar SvgArrowAltToTopRegular = function SvgArrowAltToTopRegular(_ref) {\n  var svgRef = _ref.svgRef,\n      title = _ref.title,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    \"aria-hidden\": \"true\",\n    focusable: \"false\",\n    \"data-prefix\": \"far\",\n    \"data-icon\": \"arrow-alt-to-top\",\n    className: \"svg-inline--fa fa-arrow-alt-to-top fa-w-12\",\n    role: \"img\",\n    viewBox: \"0 0 384 512\",\n    ref: svgRef\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", null, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    fill: \"currentColor\",\n    d: \"M48 336h51.6v96c0 26.5 21.5 48 48 48h88.6c26.5 0 48-21.5 48-48v-96h51.6c42.6 0 64.2-51.7 33.9-81.9l-143.9-144c-18.7-18.7-49.1-18.7-67.9 0l-144 144C-16 284.2 5.3 336 48 336zm144-192l144 144h-99.7v144h-88.6V288H48l144-144zM0 68V44c0-6.6 5.4-12 12-12h360c6.6 0 12 5.4 12 12v24c0 6.6-5.4 12-12 12H12C5.4 80 0 74.6 0 68z\"\n  })));\n};\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  return /*#__PURE__*/React.createElement(SvgArrowAltToTopRegular, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/arrow-alt-to-top-regular.ee4119b1.svg\";\nexport { ForwardRef as ReactComponent };","var _path;\n\nvar _excluded = [\"svgRef\", \"title\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar SvgFileImportRegular = function SvgFileImportRegular(_ref) {\n  var svgRef = _ref.svgRef,\n      title = _ref.title,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    \"aria-hidden\": \"true\",\n    focusable: \"false\",\n    \"data-prefix\": \"far\",\n    \"data-icon\": \"file-import\",\n    className: \"svg-inline--fa fa-file-import fa-w-16\",\n    role: \"img\",\n    viewBox: \"0 0 512 512\",\n    ref: svgRef\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", null, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    fill: \"currentColor\",\n    d: \"M497.83 97.98L413.94 14.1c-9-9-21.2-14.1-33.89-14.1H175.99C149.5.1 128 21.6 128 48.09v215.98H12c-6.63 0-12 5.37-12 12v24c0 6.63 5.37 12 12 12h276v48.88c0 10.71 12.97 16.05 20.52 8.45l71.77-72.31c4.95-4.99 4.95-13.04 0-18.03l-71.77-72.31c-7.55-7.6-20.52-2.26-20.52 8.45v48.88H175.99V48.09h159.97v103.98c0 13.3 10.7 23.99 24 23.99H464v287.95H175.99V360.07H128v103.94c0 26.49 21.5 47.99 47.99 47.99h287.94c26.5 0 48.07-21.5 48.07-47.99V131.97c0-12.69-5.17-24.99-14.17-33.99zm-113.88 30.09V51.99l76.09 76.08h-76.09z\"\n  })));\n};\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  return /*#__PURE__*/React.createElement(SvgFileImportRegular, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/file-import-regular.b820b76d.svg\";\nexport { ForwardRef as ReactComponent };","var _path;\n\nvar _excluded = [\"svgRef\", \"title\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar SvgTrashSolid = function SvgTrashSolid(_ref) {\n  var svgRef = _ref.svgRef,\n      title = _ref.title,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    \"aria-hidden\": \"true\",\n    focusable: \"false\",\n    \"data-prefix\": \"fas\",\n    \"data-icon\": \"trash\",\n    className: \"svg-inline--fa fa-trash fa-w-14\",\n    role: \"img\",\n    viewBox: \"0 0 448 512\",\n    ref: svgRef\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", null, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    fill: \"currentColor\",\n    d: \"M432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16zM53.2 467a48 48 0 0 0 47.9 45h245.8a48 48 0 0 0 47.9-45L416 128H32z\"\n  })));\n};\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  return /*#__PURE__*/React.createElement(SvgTrashSolid, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/trash-solid.a3e4c2f7.svg\";\nexport { ForwardRef as ReactComponent };","import React, { useState } from \"react\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport { ReactComponent as ArrowAltToTop } from \"../graphics/arrow-alt-to-top-regular.svg\";\nimport { ReactComponent as FileImport } from \"../graphics/file-import-regular.svg\";\nimport { Form } from \"react-bootstrap-v5\";\n\ninterface AnnotationSubmitterProps {\n  uri: string;\n  creator: string;\n  selection: Element[];\n  saveAnnotation: (annotation: Annotation) => void;\n  onRefreshClick: () => void;\n}\n\ninterface InputProps {\n  body: any;\n  setBody: (body: any) => void;\n}\n\n/**\n * An input for an `oa:describing` annotation\n * @param onBodyChange a callback to set the body of an annotation with this input\n */\nconst DescribingInput = ({ body, setBody }: InputProps) => {\n  return (\n    <textarea\n      className=\"textArea\"\n      id=\"annotationContent\"\n      value={body.value}\n      placeholder=\"Add your annotation...\"\n      onChange={(e) => {\n        setBody({ id: uuidv4(), type: \"TextualBody\", value: e.target.value });\n      }}\n    />\n  );\n};\n\nconst CueImageInput = ({ body, setBody }: InputProps) => {\n  return (\n    <textarea\n      className=\"textArea\"\n      id=\"annotationContent\"\n      value={body.value}\n      placeholder=\"Insert your image link...\"\n      onChange={(e) => {\n        setBody({ id: e.target.value });\n      }}\n    />\n  );\n};\n\n// TODO: This has the same body as CueImageInput, could be reused?\nconst LinkingInput = ({ body, setBody }: InputProps) => {\n  return (\n    <textarea\n      className=\"textArea\"\n      id=\"annotationContent\"\n      value={body.value}\n      placeholder=\"Insert your URI link...\"\n      onChange={(e) => {\n        setBody({ id: e.target.value });\n      }}\n    />\n  );\n};\n\nconst CueMediaInput = ({ body, setBody }: InputProps) => {\n  const value = body.value || \"\";\n  const seconds = body.seconds || \"\";\n\n  return (\n    <div>\n      <input\n        type=\"text\"\n        value={value}\n        name=\"value\"\n        placeholder=\"enter link here\"\n        onChange={(e) => {\n          setBody({ id: e.target.value + \"#t=\" + seconds });\n        }}\n        className=\"sizedTextBox\"\n      />\n      <span> jump to: </span>\n      <input\n        type=\"text\"\n        pattern=\"[0-9]\"\n        placeholder=\"seconds\"\n        name=\"seconds\"\n        value={seconds}\n        onChange={(e) => {\n          setBody({ id: value + \"#t=\" + e.target.value });\n        }}\n        className=\"sizedTextBox\"\n      />\n    </div>\n  );\n};\n\nconst PlaylistInput = ({ body, setBody }: InputProps) => {\n  const value = body.value || \"\";\n  const title = body.title || \"\";\n  let id = body.id;\n  if (!id) {\n    id = uuidv4();\n  }\n\n  return (\n    <div>\n      <input\n        type=\"text\"\n        value={value}\n        name=\"value\"\n        placeholder=\"enter link here\"\n        onChange={(e) => {\n          setBody({ id, type: \"TextualBody\", title, value: e.target.value });\n        }}\n        className=\"sizedTextBox\"\n      />\n      <span> with title: </span>\n      <input\n        type=\"text\"\n        placeholder=\"title\"\n        name=\"seconds\"\n        value={title}\n        onChange={(e) => {\n          setBody({ id, type: \"TextualBody\", title: e.target.value, value });\n        }}\n        className=\"sizedTextBox\"\n      />\n    </div>\n  );\n};\n\nconst AnnotationSubmitter = (props: AnnotationSubmitterProps) => {\n  const [motivation, setMotivation] = useState(\"describing\");\n  const [body, setBody] = useState({});\n\n  const saveAnnotation = () => {\n    const annotation = {\n      \"@context\": \"https://www.w3.org/ns/anno.jsonld\",\n      target: props.selection.map((elem: Element) => {\n        return { id: props.uri + \"#\" + elem.getAttribute(\"id\") };\n      }), //this takes the measure id selected by the user\n      type: \"Annotation\",\n      motivation: motivation,\n      body: [body],\n      created: new Date().toISOString(),\n      creator: props.creator,\n    } as Annotation;\n    if (!bodyEmpty()) {\n      props.saveAnnotation(annotation);\n      setBody({});\n    } else {\n      console.log(\"annotation is empty, not saving\");\n    }\n  };\n\n  const annotationTypeDefinitions = [\n    {\n      value: \"Describing\",\n      motivation: \"describing\",\n      title: \"links external resources to the annotation\",\n    },\n    {\n      value: \"Linking\",\n      motivation: \"linking\",\n      title: \"adds a textual content to the annotation\",\n    },\n    {\n      value: \"Cue Media\",\n      motivation: \"trompa:cueMedia\",\n      title: \"links a media content to the annotation\",\n    },\n    {\n      value: \"Image\",\n      motivation: \"trompa:cueImage\",\n      title: \"links an image content to the annotation\",\n    },\n    {\n      value: \"Playlist\",\n      motivation: \"trompa:playlist\",\n      title: \"adds a textual content to the annotation\",\n    },\n  ];\n\n  const bodyEmpty = () => {\n    return Object.keys(body).length === 0 && body.constructor === Object;\n  };\n\n  return (\n    <div className=\"App\">\n      <div className=\"container__app\">\n        <h3>Annotation type</h3>\n        {annotationTypeDefinitions.map((d) => {\n          return (\n            <Form.Check\n              inline\n              key={d.motivation}\n              id={`annotationType-${d.motivation}`}\n              type=\"radio\"\n              label={d.value}\n              name=\"annotationType\"\n              value={d.value}\n              onChange={() => {\n                setMotivation(d.motivation);\n                setBody({});\n              }}\n              checked={motivation === d.motivation}\n            />\n          );\n        })}\n\n        <div className=\"addAnnotations\">\n          {motivation === \"describing\" && (\n            <DescribingInput body={body} setBody={setBody} />\n          )}\n          {motivation === \"linking\" && (\n            <LinkingInput body={body} setBody={setBody} />\n          )}\n          {motivation === \"trompa:cueMedia\" && (\n            <CueMediaInput body={body} setBody={setBody} />\n          )}\n          {motivation === \"trompa:cueImage\" && (\n            <CueImageInput body={body} setBody={setBody} />\n          )}\n          {motivation === \"trompa:playlist\" && (\n            <PlaylistInput body={body} setBody={setBody} />\n          )}\n          <button\n            className={\n              bodyEmpty() ? \"disabledSubmitButton\" : \"enabledSubmitButton\"\n            }\n            title=\"click to post your annotation to your solid POD\"\n            onClick={saveAnnotation}\n          >\n            {!bodyEmpty() && (\n              <>\n                <ArrowAltToTop style={{ width: \"1em\", height: \"1em\" }} /> Submit\n                to your Solid POD\n              </>\n            )}\n            {bodyEmpty() && (\n              <>\n                <FileImport style={{ width: \"1em\", height: \"1em\" }} /> Write\n                something to begin...\n              </>\n            )}\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default AnnotationSubmitter;\n","/* manages the rendering of the checkbox component mapping across the selectors const */\n/* and uses updateSelectorList to update the selectorString Prop passed from the selctableScore main app*/\nimport React, { Component } from \"react\";\nimport { Form } from \"react-bootstrap-v5\";\n\nconst Selectors: SelectorType[] = [\n  {\n    name: \"Note\",\n    value: \".note\",\n  },\n\n  {\n    name: \"Measure\",\n    value: \".measure\",\n  },\n\n  {\n    name: \"Dynamics\",\n    value: \".dynam\",\n  },\n\n  {\n    name: \"Directives\",\n    value: \".dir\",\n  },\n];\n\ntype SelectorType = {\n  name: string;\n  value: string;\n};\n\ntype SelectionHandlerProps = {\n  selectorString: string[];\n  handleStringChange: (st: string[]) => void;\n};\n\ntype SelectionHandlerState = {\n  selectorString: string[];\n};\n\nexport default class SelectionHandler extends Component<\n  SelectionHandlerProps,\n  SelectionHandlerState\n> {\n  state = {\n    selectorString: [],\n  };\n\n  updateSelectorList(e: any, value: string) {\n    if (e.target.checked) {\n      //append to array\n      const newSelectorString = [...this.state.selectorString, value];\n      this.setState(\n        {\n          selectorString: newSelectorString,\n        },\n        () => {\n          this.props.handleStringChange(this.state.selectorString);\n        }\n      );\n    } else {\n      //remove from array\n      this.setState(\n        {\n          selectorString: this.state.selectorString.filter(function (val) {\n            return val !== value;\n          }),\n        },\n        () => {\n          this.props.handleStringChange(this.state.selectorString);\n        }\n      );\n    }\n  }\n\n  render() {\n    return (\n      <div>\n        <h3>Selection type</h3>\n        <Form>\n          {Selectors.map((selector) => {\n            return (\n              <Form.Check\n                inline\n                key={selector.name}\n                label={selector.name}\n                name=\"selector\"\n                value={selector.value}\n                id={`selector-${selector.name}`}\n                onChange={(e) => this.updateSelectorList(e, selector.value)}\n              />\n            );\n          })}\n        </Form>\n      </div>\n    );\n  }\n}\n\nexport type { SelectorType };\n","var _path;\n\nvar _excluded = [\"svgRef\", \"title\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar SvgInfoCircleRegular = function SvgInfoCircleRegular(_ref) {\n  var svgRef = _ref.svgRef,\n      title = _ref.title,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    \"aria-hidden\": \"true\",\n    focusable: \"false\",\n    \"data-prefix\": \"far\",\n    \"data-icon\": \"info-circle\",\n    className: \"svg-inline--fa fa-info-circle fa-w-16\",\n    role: \"img\",\n    viewBox: \"0 0 512 512\",\n    ref: svgRef\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", null, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    fill: \"currentColor\",\n    d: \"M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 448c-110.532 0-200-89.431-200-200 0-110.495 89.472-200 200-200 110.491 0 200 89.471 200 200 0 110.53-89.431 200-200 200zm0-338c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z\"\n  })));\n};\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  return /*#__PURE__*/React.createElement(SvgInfoCircleRegular, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/info-circle-regular.41efc81e.svg\";\nexport { ForwardRef as ReactComponent };","/* item that contains the annotation contents, the renderSwitch function assign specific display to the specfic anntation based on its motivation*/\nimport React, { ChangeEvent, Component, MouseEvent } from \"react\";\nimport auth from \"solid-auth-client\";\nimport Toggle from \"react-toggle\";\nimport {\n  getSolidDatasetWithAcl,\n  hasResourceAcl,\n  hasFallbackAcl,\n  hasAccessibleAcl,\n  createAclFromFallbackAcl,\n  getResourceAcl,\n  setAgentResourceAccess,\n  setPublicResourceAccess,\n  saveAclFor,\n  getPublicAccess,\n  getAgentAccessAll,\n  AclDataset,\n} from \"@inrupt/solid-client\";\n\nimport PlayLogo from \"../graphics/play-solid.svg\";\nimport { ReactComponent as Trash } from \"../graphics/trash-solid.svg\";\nimport { ReactComponent as InfoCircle } from \"../graphics/info-circle-regular.svg\";\n\ntype AnnotationItemProps = {\n  annotation: Annotation;\n  onRefreshClick: () => void;\n  onAnnoReplyHandler: (\n    replyTarget: AnnotationTarget[],\n    replyTargetId: string\n  ) => void;\n  onMediaClick: (id: string) => void;\n  showReplyHandler: () => void;\n  areRepliesVisible: boolean;\n  replyAnnotationTarget: any[];\n};\n\ntype AnnotationItemState = {\n  isClicked: boolean;\n  userMayModifyAccess: boolean;\n  resourceAcl?: AclDataset;\n  aclModified: number;\n  datasetWithAcl?: AclDataset;\n  userId?: string;\n  isPictureShowing: boolean;\n  previewButtonContent: string;\n  showRepliesButtonContent: string;\n  isConfirmVisible: boolean;\n  isVisible: boolean;\n  resp: string;\n};\n\nclass AnnotationItem extends Component<\n  AnnotationItemProps,\n  AnnotationItemState\n> {\n  constructor(props: Readonly<AnnotationItemProps>) {\n    super(props);\n    this.state = {\n      isClicked: false,\n      userMayModifyAccess: false,\n      resourceAcl: undefined,\n      aclModified: 0,\n      datasetWithAcl: undefined,\n      userId: undefined,\n      isPictureShowing: false,\n      previewButtonContent: \"Show preview\",\n      showRepliesButtonContent: \"Toggle replies\",\n      isConfirmVisible: false,\n      isVisible: false,\n      resp: \"\",\n    };\n    this.grantPublic = this.grantPublic.bind(this);\n    this.revokePublic = this.revokePublic.bind(this);\n    this.updateDatasetAcl = this.updateDatasetAcl.bind(this);\n    this.deleteAnno = this.deleteAnno.bind(this);\n    // this.changeContent = this.changeContent.bind(this);\n  }\n\n  deleteAnno(e: MouseEvent<HTMLButtonElement>) {\n    const parent = (e.target as Element).closest(\".rootAnno\");\n    const testReplyRetrieval = document.querySelectorAll(\".replyAnno\");\n\n    if (testReplyRetrieval) {\n      testReplyRetrieval.forEach((replyTargetAnno) => {\n        const replyTargetAnnoId = (replyTargetAnno as HTMLElement).dataset\n          .replyAnnotationTarget;\n        const rootAnnoTargetId = (parent as HTMLElement)!.dataset.selfId;\n        if (replyTargetAnnoId === rootAnnoTargetId) {\n          console.log(\n            \"replies found: \",\n            (replyTargetAnno as HTMLElement).dataset.selfId\n          );\n          auth\n            .fetch((replyTargetAnno as HTMLElement).dataset.selfId!, {\n              method: \"DELETE\",\n            })\n            .then(() => {\n              console.log(\"replies deleted\");\n            });\n        }\n      });\n    }\n    auth\n      .fetch(this.props.annotation[\"@id\"]!, { method: \"DELETE\" })\n      .then(async (response) => {\n        const data = await response.json();\n        // check for error response\n        if (!response.ok) {\n          // get error message from body or default to response status\n          const error = (data && data.message) || response.status;\n          return Promise.reject(error);\n        }\n\n        this.setState({ resp: \"success\" });\n      })\n      // @ts-ignore\n      .then(this.props.onRefreshClick())\n      .catch(() => {\n        console.warn(\"Your annotation has been deleted, refreshing...\");\n      });\n  }\n\n  showDetails = (e: MouseEvent<HTMLButtonElement>) => {\n    e.preventDefault();\n    e.stopPropagation();\n    const parent = (e.target as HTMLElement).closest(\".rootAnno\");\n    const details = parent!.querySelector(\".hiddenDetails\");\n    if (details && !this.state.isVisible) {\n      this.setState({ isVisible: true });\n      details.classList.remove(\"hiddenDetails\");\n      details.classList.add(\"showDetails\");\n    } else {\n      if (this.state.isVisible) {\n        this.setState({ isVisible: false });\n        const visibleDetails = parent!.querySelector(\".showDetails\");\n        visibleDetails!.classList.remove(\"showDetails\");\n        visibleDetails!.classList.add(\"hiddenDetails\");\n      }\n    }\n  };\n\n  showReplyDetails = (e: MouseEvent<HTMLButtonElement>) => {\n    e.preventDefault();\n    e.stopPropagation();\n    const parent = (e.target as HTMLElement).closest(\".quoteContent\");\n    const details = parent!.querySelector(\".hiddenDetails\");\n    if (details && !this.state.isVisible) {\n      this.setState({ isVisible: true });\n      details.classList.remove(\"hiddenDetails\");\n      details.classList.add(\"showDetails\");\n    } else {\n      if (this.state.isVisible) {\n        this.setState({ isVisible: false });\n        const visibleDetails = parent!.querySelector(\".showDetails\");\n        visibleDetails!.classList.remove(\"showDetails\");\n        visibleDetails!.classList.add(\"hiddenDetails\");\n      }\n    }\n  };\n  onClick = (e: MouseEvent<HTMLButtonElement>) => {\n    e.preventDefault();\n    e.stopPropagation();\n    const replyTarget = this.props.annotation.target;\n    const replyTargetId = this.props.annotation[\"@id\"];\n    this.props.onAnnoReplyHandler(replyTarget, replyTargetId!);\n    console.log(\"reply target id\", replyTargetId);\n  };\n\n  componentDidMount() {\n    this.updateDatasetAcl();\n  }\n\n  showConfirm = (e: MouseEvent<HTMLButtonElement>) => {\n    e.preventDefault();\n    e.stopPropagation();\n    const parent = (e.target as HTMLElement).closest(\".rootAnno\");\n    const confirmScreen = parent!.querySelector(\".hiddenConfirm\");\n    if (confirmScreen && !this.state.isConfirmVisible) {\n      this.setState({ isConfirmVisible: !this.state.isConfirmVisible });\n      confirmScreen.classList.remove(\"hiddenConfirm\");\n      confirmScreen.classList.add(\"showConfirm\");\n    } else {\n      if (this.state.isConfirmVisible) {\n        this.setState({ isConfirmVisible: !this.state.isConfirmVisible });\n        const visibleConfirm = parent!.querySelector(\".showConfirm\");\n        visibleConfirm!.classList.remove(\"showConfirm\");\n        visibleConfirm!.classList.add(\"hiddenConfirm\");\n      }\n    }\n  };\n\n  updateDatasetAcl() {\n    auth\n      .currentSession()\n      .then((s) => {\n        getSolidDatasetWithAcl(this.props.annotation[\"@id\"]!, {\n          fetch: auth.fetch,\n        })\n          .then((datasetWithAcl) => {\n            console.log(\"Got dataset: \", datasetWithAcl);\n            let resourceAcl;\n            if (!hasResourceAcl(datasetWithAcl)) {\n              if (!hasAccessibleAcl(datasetWithAcl)) {\n                console.warn(\n                  \"You do not have permission to modify access on \",\n                  this.props.annotation[\"@id\"]\n                );\n              }\n              if (!hasFallbackAcl(datasetWithAcl)) {\n                console.warn(\n                  \"You do not have permission to view access rights list on \",\n                  this.props.annotation[\"@id\"]\n                );\n              } else {\n                // @ts-ignore\n                resourceAcl = createAclFromFallbackAcl(datasetWithAcl);\n                // ensure current user has control in the new ACL\n                const userControllableResourceAcl = setAgentResourceAccess(\n                  resourceAcl,\n                  s!.webId,\n                  { read: true, append: true, write: true, control: true }\n                );\n                this.setState({\n                  userMayModifyAccess: true,\n                  // @ts-ignore\n                  datasetWithAcl: datasetWithAcl,\n                  resourceAcl: userControllableResourceAcl,\n                  aclModified: Date.now(),\n                });\n                console.log(\"Creating ACL from fallback ACL\");\n              }\n            } else {\n              resourceAcl = getResourceAcl(datasetWithAcl);\n              this.setState({\n                userMayModifyAccess: true,\n                // @ts-ignore\n                datasetWithAcl: datasetWithAcl,\n                resourceAcl: resourceAcl,\n                aclModified: Date.now(),\n              });\n              console.log(\"Got resource ACL\");\n            }\n          })\n          .catch((e) =>\n            console.error(\n              \"Couldn't get Solid dataset with ACL: \",\n              this.props.annotation[\"@id\"],\n              e\n            )\n          );\n      })\n      .catch((e) =>\n        console.error(\"Couldn't access the current Solid session: \", e)\n      );\n  }\n\n  shouldComponentUpdate(\n    nextProps: Readonly<AnnotationItemProps>,\n    nextState: Readonly<AnnotationItemState>\n  ) {\n    if (this.state.aclModified !== nextState.aclModified) {\n      // user has enacted an ACL change. Request a re-render accordingly.\n      return true;\n    }\n    return false;\n  }\n\n  onPlayClick = (e: MouseEvent<HTMLButtonElement>) => {\n    e.preventDefault();\n    e.stopPropagation();\n    const bodyMedia: string = this.props.annotation.body[0].id;\n    this.props.onMediaClick(bodyMedia);\n  };\n\n  onPreviewclick = (e: MouseEvent<HTMLButtonElement>) => {\n    e.preventDefault();\n    e.stopPropagation();\n\n    const aimAt = (e.target as HTMLElement).closest(\".rootAnno\");\n    const _children = aimAt!.children[0];\n\n    //const aimAt = rootAnno.contains(\"hiddenContainer\");\n    if (!this.state.isPictureShowing) {\n      this.setState({\n        isPictureShowing: true,\n        previewButtonContent: \"Hide preview\",\n      });\n      console.log(_children);\n      document\n        .querySelector(\".hiddenContainer\")!\n        .addEventListener(\"click\", function (e) {\n          e.stopPropagation();\n        });\n      _children.classList.remove(\"hiddenContainer\");\n      _children.classList.add(\"showContainer\");\n    } else {\n      document\n        .querySelector(\".showContainer\")!\n        .addEventListener(\"click\", function (e) {\n          e.stopPropagation();\n        });\n      this.setState({\n        isPictureShowing: false,\n        previewButtonContent: \"show preview\",\n      });\n      _children.classList.add(\"hiddenContainer\");\n      _children.classList.remove(\"showContainer\");\n    }\n  };\n\n  onShowReplyClick = (e: MouseEvent<HTMLButtonElement>) => {\n    e.preventDefault();\n    e.stopPropagation();\n    const rootAnno = (e.target as HTMLElement).closest(\".rootAnno\");\n    console.log(\"root anno\", rootAnno);\n    const replyTargetAnnos = document.querySelectorAll(\".replyAnno\");\n    if (replyTargetAnnos.length) {\n      replyTargetAnnos.forEach((replyTargetAnno) => {\n        const replyTargetAnnoId = (replyTargetAnno as HTMLElement).dataset\n          .replyAnnotationTarget;\n\n        const rootAnnoTargetId = (rootAnno as HTMLElement)!.dataset.selfId;\n\n        console.log(\"Reply target anno id: \", replyTargetAnnoId);\n        if (replyTargetAnnoId === rootAnnoTargetId) {\n          if (\n            this.props.areRepliesVisible === false ||\n            this.state.isClicked === false\n          ) {\n            this.setState({\n              isClicked: true,\n            });\n            rootAnno!.appendChild(replyTargetAnno);\n            this.props.showReplyHandler();\n\n            //creates an array of all the visible replies\n            const noLongerShowing = Array.from(\n              rootAnno!.getElementsByClassName(\"showReply\")\n            );\n            //hides them\n            noLongerShowing.forEach((noReplyShowing) =>\n              noReplyShowing.classList.add(\"hiddenReply\")\n            );\n            noLongerShowing.forEach((noReplyShowing) =>\n              noReplyShowing.classList.remove(\"showReply\")\n            );\n            //creates an array of the hidden annotations\n            const showing = Array.from(\n              rootAnno!.getElementsByClassName(\"hiddenReply\")\n            );\n            //shows them\n            showing.forEach((showingReply) =>\n              showingReply.classList.add(\"showReply\")\n            );\n            showing.forEach((showingReply) =>\n              showingReply.classList.remove(\"hiddenReply\")\n            );\n          } else {\n            this.setState({\n              isClicked: false,\n            });\n            this.props.showReplyHandler();\n\n            const annoContainer = document.querySelector(\".listContainer\");\n            const noLongerShowing = Array.from(\n              rootAnno!.getElementsByClassName(\"showReply\")\n            );\n            //hides them\n            noLongerShowing.forEach((noReplyShowing) => {\n              noReplyShowing.classList.add(\"hiddenReply\");\n              annoContainer!.appendChild(noReplyShowing);\n            });\n            noLongerShowing.forEach((noReplyShowing) =>\n              noReplyShowing.classList.remove(\"showReply\")\n            );\n          }\n        }\n      });\n    } else console.warn(\"no replies to show for this annotation\");\n  };\n\n  grantPublic(e: ChangeEvent<HTMLInputElement>) {\n    e.preventDefault();\n    e.stopPropagation();\n    auth.currentSession().then((s) => {\n      let updatedAcl = setPublicResourceAccess(this.state.resourceAcl!, {\n        read: true,\n        append: false,\n        write: false,\n        control: false,\n      });\n      // ensure current user has control in the new ACL\n      updatedAcl = setAgentResourceAccess(updatedAcl, s!.webId, {\n        read: true,\n        append: true,\n        write: true,\n        control: true,\n      });\n      // @ts-ignore\n      saveAclFor(this.state.datasetWithAcl!, updatedAcl, { fetch: auth.fetch })\n        .then(() => this.updateDatasetAcl())\n        .catch((e) => console.error(\"Could not grant public access: \", e));\n    });\n  }\n\n  revokePublic(e: ChangeEvent<HTMLInputElement>) {\n    console.log(\"Revoking. Old acl: \", this.state.resourceAcl);\n    e.stopPropagation();\n    e.preventDefault();\n    auth.currentSession().then((s) => {\n      let updatedAcl = setPublicResourceAccess(this.state.resourceAcl!, {\n        read: false,\n        append: false,\n        write: false,\n        control: false,\n      });\n      // ensure current user has control in the new ACL\n      updatedAcl = setAgentResourceAccess(updatedAcl, s!.webId, {\n        read: true,\n        append: true,\n        write: true,\n        control: true,\n      });\n\n      // @ts-ignore\n      saveAclFor(this.state.datasetWithAcl!, updatedAcl, { fetch: auth.fetch })\n        .then(() => this.updateDatasetAcl())\n        .catch((e) => console.error(\"Could not revoke public access: \", e));\n    });\n  }\n\n  renderSwitch = () => {\n    const date = this.props.annotation.created;\n    let permission;\n    let modifyPermissionsElement;\n    let replies = document.querySelectorAll(\".replyAnno\");\n    const selfId = this.props.annotation[\"@id\"];\n    var areRepliesPresent = false;\n    /* check to see if any available replies are present, if not the toggle replies is hidden */\n    if (replies.length) {\n      replies.forEach((reply) => {\n        const target = (reply as HTMLElement).dataset.replyAnnotationTarget;\n        if (target === selfId) {\n          areRepliesPresent = true;\n        }\n      });\n    }\n\n    /* determine permission state of annotation in Solid Pod */\n    if (this.state.datasetWithAcl) {\n      // @ts-ignore\n      if (getPublicAccess(this.state.datasetWithAcl).read)\n        permission = \"public\";\n      else {\n        // @ts-ignore\n        if (Object.keys(getAgentAccessAll(this.state.datasetWithAcl)) > 1)\n          /* declare it as shared if it has any access info for more than one (assumed to be user)\n           * TODO check assumptions...\n           */\n          permission = \"shared\";\n        else permission = \"private\";\n      }\n    } else {\n      permission = \"unknown\";\n    }\n    // Logic to toggle public access on and off\n    // TODO allow sharing with individual agents using setAgentResourceAccess\n    if (!this.state.userMayModifyAccess) {\n      modifyPermissionsElement = (\n        <span className=\"accessPermissions\">No access</span>\n      );\n    } else {\n      if (permission !== \"public\") {\n        modifyPermissionsElement = (\n          <Toggle\n            checked={false}\n            onChange={this.grantPublic}\n            icons={{\n              unchecked: (\n                <svg\n                  aria-hidden=\"true\"\n                  focusable=\"false\"\n                  data-prefix=\"fas\"\n                  data-icon=\"lock\"\n                  className=\"svg-inline--fa fa-lock fa-w-14\"\n                  role=\"img\"\n                  xmlns=\"http://www.w3.org/2000/svg\"\n                  viewBox=\"0 0 576 512\"\n                  vertical-align=\"middle\"\n                >\n                  <path\n                    fill=\"white\"\n                    d=\"M400 224h-24v-72C376 68.2 307.8 0 224 0S72 68.2 72 152v72H48c-26.5 0-48 21.5-48 48v192c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V272c0-26.5-21.5-48-48-48zm-104 0H152v-72c0-39.7 32.3-72 72-72s72 32.3 72 72v72z\"\n                  ></path>\n                </svg>\n              ),\n            }}\n          />\n        );\n      } else if (permission === \"public\") {\n        modifyPermissionsElement = (\n          <Toggle\n            checked={true}\n            onChange={this.revokePublic}\n            icons={{\n              checked: (\n                <svg\n                  aria-hidden=\"true\"\n                  focusable=\"false\"\n                  data-prefix=\"fas\"\n                  data-icon=\"lock-open\"\n                  className=\"svg-inline--fa fa-lock-open fa-w-18\"\n                  role=\"img\"\n                  xmlns=\"http://www.w3.org/2000/svg\"\n                  viewBox=\"0 0 576 512\"\n                >\n                  <path\n                    fill=\"white\"\n                    d=\"M423.5 0C339.5.3 272 69.5 272 153.5V224H48c-26.5 0-48 21.5-48 48v192c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V272c0-26.5-21.5-48-48-48h-48v-71.1c0-39.6 31.7-72.5 71.3-72.9 40-.4 72.7 32.1 72.7 72v80c0 13.3 10.7 24 24 24h32c13.3 0 24-10.7 24-24v-80C576 68 507.5-.3 423.5 0z\"\n                  ></path>\n                </svg>\n              ),\n            }}\n          />\n        );\n      }\n    }\n    /* shared components for all the annotations */\n    let commonAnnoComponents = (\n      <div>\n        <div className=\"hiddenConfirm\">\n          <div>\n            Delete this annotation and its replies?\n            <p>\n              <button className={\"deleteYes\"} onClick={this.deleteAnno}>\n                yes\n              </button>\n              <button className={\"deleteNo\"} onClick={this.showConfirm}>\n                no\n              </button>\n            </p>\n          </div>\n        </div>\n        <div style={{ paddingTop: \"1.5%\" }}>\n          <button className=\"deleteButton\" onClick={this.showConfirm}>\n            <Trash />\n          </button>\n          <button\n            className=\"infoButton\"\n            onMouseEnter={this.showDetails}\n            onMouseLeave={this.showDetails}\n          >\n            <InfoCircle />\n          </button>\n          permissions: {modifyPermissionsElement}\n        </div>\n      </div>\n    );\n    /* cluster of buttons and stuff in the \"annotation footer\" */\n    let replyButtonsCluster = (\n      <div>\n        <div className=\"hiddenDetails\">\n          {\" \"}\n          <p className=\"date\">\n            Created on: {date}, access permissions: {permission}.\n          </p>\n        </div>\n        <div>\n          {areRepliesPresent && (\n            <button\n              className=\"showRepliesButton\"\n              name=\"showRepliesButton\"\n              onClick={this.onShowReplyClick}\n            >\n              {this.state.showRepliesButtonContent}\n            </button>\n          )}\n          <button\n            className=\"replyButton\"\n            name=\"replyButton\"\n            onClick={this.onClick}\n          >\n            Reply\n          </button>\n        </div>\n      </div>\n    );\n\n    //stuff that i am carrying around: the annotation's ID you are replying to, the body (currently sits under annotation.source) and the annotation's specific ID\n    const motivation = this.props.annotation.motivation;\n    const bodyD = this.props.annotation.body[0].value;\n    const bodyL = this.props.annotation.body[0].id;\n    const bodyMedia = this.props.annotation.body[0].id;\n    const target = this.props.annotation.target[0].id;\n    const repTarget = this.props.annotation.target;\n    const creator = this.props.annotation.creator || \"unknown\";\n\n    switch (motivation) {\n      case \"describing\":\n        return (\n          <div\n            className=\"rootAnno annoItem\"\n            data-target={target}\n            data-self-id={selfId}\n          >\n            {\" \"}\n            {commonAnnoComponents}\n            <p>{bodyD}</p>\n            {replyButtonsCluster}\n          </div>\n        );\n      case \"linking\":\n        if (bodyL.startsWith(\"http\")) {\n          return (\n            <div\n              className=\"rootAnno annoItem\"\n              data-target={target}\n              data-self-id={selfId}\n            >\n              <p>\n                {\"\"}\n                {commonAnnoComponents}\n                {\n                  <a\n                    href={bodyL}\n                    onClick={() => false}\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                  >\n                    {bodyL}\n                  </a>\n                }\n              </p>\n              {replyButtonsCluster}\n            </div>\n          );\n        } else {\n          const appendURL = \"https://\" + bodyL;\n          return (\n            <div\n              className=\"rootAnno annoItem\"\n              data-target={target}\n              data-self-id={selfId}\n            >\n              {commonAnnoComponents}\n              <p>\n                {\"\"}\n                {\n                  <a\n                    href={appendURL}\n                    onClick={() => false}\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                  >\n                    {bodyL}\n                  </a>\n                }\n              </p>\n              {replyButtonsCluster}\n            </div>\n          );\n        }\n\n      case \"trompa:cueMedia\":\n        const cleanMediaString = bodyMedia.split(\"#\")[0];\n        return (\n          <div\n            className=\"rootAnno annoItem\"\n            data-target={target}\n            data-self-id={selfId}\n          >\n            {\" \"}\n            {commonAnnoComponents}\n            <p>\n              {cleanMediaString}{\" \"}\n              <button className=\"playButton\" onClick={this.onPlayClick}>\n                {\" \"}\n                <img\n                  src={PlayLogo}\n                  alt=\"\"\n                  style={{\n                    width: \"5px\",\n                    alignContent: \"center\",\n                    textAlign: \"center\",\n                  }}\n                ></img>{\" \"}\n                play{\" \"}\n              </button>\n            </p>\n            {replyButtonsCluster}\n          </div>\n        );\n      case \"trompa:cueImage\":\n        return (\n          <div\n            className=\"rootAnno annoItem\"\n            data-target={target}\n            data-self-id={selfId}\n          >\n            {\" \"}\n            <div className=\"hiddenContainer\">\n              <a href={bodyMedia} target=\"_blank\" rel=\"noopener noreferrer\">\n                <img\n                  title=\"click for full res\"\n                  src={bodyMedia}\n                  alt=\"annotation\"\n                  style={{\n                    maxWidth: \"240px\",\n                    maxHeight: \"135px\",\n                    marginTop: \"5px\",\n                  }}\n                />\n              </a>\n            </div>\n            {commonAnnoComponents}\n            <p>\n              The content of this annotation is a picture, click the button to\n              see a preview{\" \"}\n              <button onClick={this.onPreviewclick}>\n                {this.state.previewButtonContent}{\" \"}\n              </button>\n            </p>\n            {replyButtonsCluster}\n          </div>\n        );\n      case \"trompa:playlist\":\n        return;\n\n      case \"replying\":\n        return (\n          <div\n            data-reply-annotation-target={repTarget}\n            data-self-id={selfId}\n            className=\"replyAnno hiddenReply\"\n          >\n            <div className=\"quoteContent\">\n              <button className=\"deleteButton\" onClick={this.deleteAnno}>\n                <Trash />\n              </button>\n              <button\n                className=\"infoButton\"\n                onMouseEnter={this.showReplyDetails}\n                onMouseLeave={this.showReplyDetails}\n              >\n                <InfoCircle />\n              </button>\n              <p>Reply: {bodyD}</p>\n              <span className=\"hiddenDetails\">\n                {\" \"}\n                <span className=\"date\">\n                  Created on: {date}, access permissions: {permission}.\n                </span>\n              </span>\n            </div>\n          </div>\n        );\n\n      default:\n        console.log(\n          \"no motivation provided defaulting to plain text annotation\",\n          motivation\n        );\n        return (\n          <div className=\"annoItem\" data-target={target}>\n            {\" \"}\n            <p>The plain text content of this annotation is {bodyD}</p>\n            <div className=\"date\">\n              Created on: {date} by {creator} with {motivation} motivation\n            </div>\n          </div>\n        );\n    }\n  };\n\n  render() {\n    return <div className=\"annoItemContainer\">{this.renderSwitch()}</div>;\n  }\n}\n\nexport default AnnotationItem;\n","/* annotationList is the annotationItem container. Filters the annotations in order to render only the one associated to the specific measure selected */\n/* they are ordered chronologically with sortedfilteredAnno and the onClick funciton is attacehd to the annotation item's body to highlight the annotated section of the score*/\n\nimport React from \"react\";\nimport AnnotationItem from \"./AnnotationItem\";\n//import PropTypes from \"prop-types\";\n\ntype AnnoListProps = {\n  filteringEntries: any[];\n  allEntries: any[];\n  onAnnoReplyHandler: (replyTarget: AnnotationTarget[], replyTargetId: string) => void;\n  onMediaClick: (body: string) => void;\n  replyAnnotationTarget: any[];\n  showReplyHandler: () => void;\n  areRepliesVisible: boolean;\n  onRefreshClick: () => void;\n};\n\nexport class AnnotationList extends React.Component<AnnoListProps> {\n  state = {\n    order: \"desc\",\n  };\n\n  render() {\n    const { order } = this.state;\n    const filtering = this.props.allEntries.filter((anno) =>\n      this.props.filteringEntries.includes(anno[\"@id\"])\n    );\n    const sortedFilteredAnno = filtering.sort((a, b) => {\n      const isReverse = order === \"asc\" ? 1 : -1;\n      return isReverse * a.created.localeCompare(b.created);\n    });\n\n    function onClick(e: any) {\n      // e.preventDefault();\n      // e.stopPropagation();\n      console.log(\"i am being clicked\");\n      // figure out this element's focus Id\n      const focusId: any = Array.from(e.currentTarget.classList).filter(\n        (c: any) => c.startsWith(\"focus-\")\n      );\n      if (focusId.length > 1) {\n        console.warn(\"Element with multiple focus Ids!\", e.target);\n      }\n      // remove focus off previous inFocus elements (now outdated)\n      const noLongerInFocusList = Array.from(\n        document.getElementsByClassName(\"inFocus\")\n      );\n      noLongerInFocusList.forEach((noFocusElement) =>\n        noFocusElement.classList.remove(\"inFocus\")\n      );\n      // add focus to newly inFocus elements\n      const inFocusList = Array.from(\n        document.getElementsByClassName(focusId[0])\n      );\n      inFocusList.forEach((focusElement) =>\n        focusElement.classList.add(\"inFocus\")\n      );\n      // scroll page to highlighted item\n      // document\n      //   .querySelector(\".inFocus\")\n      //   .scrollIntoView({ behavior: \"smooth\" });\n    }\n\n    return (\n      <div className=\"listContainer\" id=\"listContainer\">\n        {sortedFilteredAnno.map((item: any) => {\n          const annoIdFragment = item[\"@id\"].substr(\n            item[\"@id\"].lastIndexOf(\"/\") + 1\n          );\n          return (\n            <div\n              className={\"focus-\" + annoIdFragment}\n              onClick={onClick}\n              key={item[\"@id\"]}\n              id={annoIdFragment}\n            >\n              <AnnotationItem\n                annotation={item}\n                onAnnoReplyHandler={this.props.onAnnoReplyHandler}\n                onMediaClick={this.props.onMediaClick}\n                replyAnnotationTarget={this.props.replyAnnotationTarget}\n                showReplyHandler={this.props.showReplyHandler}\n                areRepliesVisible={this.props.areRepliesVisible}\n                onRefreshClick={this.props.onRefreshClick}\n              />\n            </div>\n          );\n        })}\n      </div>\n    );\n  }\n}\n\nexport default AnnotationList;\n","import React, {Component} from \"react\";\nimport auth from \"solid-auth-client\";\n\n\ntype PlaylistItemProps = {\n    annotation: any\n    onRefreshClick: () => void\n}\n\ntype PlaylistItemState = {\n    resp: string\n}\n\nclass PlaylistItem extends Component<PlaylistItemProps, PlaylistItemState> {\n  constructor(props: Readonly<PlaylistItemProps>) {\n    super(props);\n    this.state = {\n      resp: \"\",\n    };\n  }\n\n  delete = () => {\n    auth\n      .fetch(this.props.annotation[\"@id\"], { method: \"DELETE\" })\n      .then(async (response) => {\n        const data = await response.json();\n        // check for error response\n        if (!response.ok) {\n          // get error message from body or default to response status\n          const error = (data && data.message) || response.status;\n          return Promise.reject(error);\n        }\n\n        this.setState({ resp: \"success\" });\n      })\n      .then(() => {\n          this.props.onRefreshClick();\n      })\n      .catch(() => {\n        console.warn(\"Your annotation has been deleted, refreshing...\");\n      });\n  }\n\n  render() {\n    const selfId = this.props.annotation[\"@id\"];\n    const title = this.props.annotation.body[0].seconds;\n    const link = this.props.annotation.body[0].value;\n\n    return (\n      <div className=\"rootAnno playlistItem\">\n        <p>{title}</p>\n        <iframe\n          src={link}\n          title={selfId}\n          frameBorder=\"0\"\n          width=\"400\"\n          height=\"60\"\n        />\n        <button onClick={this.delete}>del</button>\n      </div>\n    );\n  }\n}\n\nexport default PlaylistItem;\n","import React, {FunctionComponent, useState} from \"react\";\nimport PlaylistItem from \"./playlistItem\";\n\n\ntype RenditionsPlaylistProps = {\n  allEntries: any[]\n  onRefreshClick: () => void\n}\n\nconst RenditionsPlaylist :FunctionComponent<RenditionsPlaylistProps> = (props) => {\n  const [visible, setVisible] = useState(false);\n\n    return (\n      <div>\n        <button className=\"renditionButton\" onClick={() => {\n          setVisible(!visible)\n        }}>\n          Show recordings playlist\n        </button>\n        <div className={`playlist ${!visible ? 'hidden' : ''}`}>\n          {props.allEntries.map((anno) => {\n            const motivation = anno.motivation;\n            return (\n              motivation === \"trompa:playlist\" && (\n                <div key={anno[\"@id\"]}>\n                  <PlaylistItem\n                    annotation={anno}\n                    onRefreshClick={props.onRefreshClick}\n                  />\n                </div>\n              )\n            );\n          })}\n        </div>\n      </div>\n    );\n}\n\nexport default RenditionsPlaylist;\n","export type Pitch = {\n  pitch: string;\n  oct: number;\n};\n\nexport function parseMusicXml(document: Document) {\n  const parts = document.getElementsByTagName(\"part\");\n  return Array.from(parts)\n    .map(function (part) {\n      let part_notes: Pitch[] = [];\n      Array.from(part.getElementsByTagName(\"note\")).forEach(function (note) {\n        const pitch = note.getElementsByTagName(\"pitch\");\n        if (pitch.length) {\n          const step = pitch[0].getElementsByTagName(\"step\");\n          const octave = pitch[0].getElementsByTagName(\"octave\");\n          if (step.length && octave.length) {\n            part_notes.push({\n              pitch: step[0].innerHTML,\n              oct: parseInt(octave[0].innerHTML),\n            });\n          }\n        }\n      });\n      return part_notes;\n    })\n    .map(pitchesToIntervalMapping);\n}\n\nexport type Staff = {\n  label: string;\n  notes: Pitch[];\n};\n\nexport function parseMei(document: Document) {\n  const staffDefinitions = document.getElementsByTagName(\"staffDef\");\n  const staffs: { [n: string]: Staff } = {};\n  Array.from(staffDefinitions).forEach(function (sd) {\n    const attributes = sd.attributes;\n    const label = sd.getElementsByTagName(\"label\");\n    let staffLabel: string;\n    if (label.length) {\n      staffLabel = label[0].innerHTML;\n    }\n    const n = attributes?.getNamedItem(\"n\")?.value!;\n    if (n) {\n      staffs[n] = { label: staffLabel!, notes: [] };\n    }\n  });\n\n  const measures = document.getElementsByTagName(\"measure\");\n  Array.from(measures).forEach(function (measure) {\n    const measureStaffs = measure.getElementsByTagName(\"staff\");\n    Array.from(measureStaffs).forEach(function (staff) {\n      const measureStaffId = staff.attributes.getNamedItem(\"n\")?.value!;\n      const notes = staff.getElementsByTagName(\"note\");\n      Array.from(notes).forEach(function (note) {\n        const nattrs = note.attributes;\n        const pname = nattrs.getNamedItem(\"pname\")?.value!;\n        const oct = nattrs.getNamedItem(\"oct\")?.value!;\n        staffs[measureStaffId].notes.push({\n          pitch: pname,\n          oct: parseInt(oct, 10),\n        });\n      });\n    });\n  });\n  let ret: { [key: string]: { label: string; notes: string } } = {};\n  Object.keys(staffs).forEach(function (i) {\n    if (staffs[i].label) {\n      ret[i] = {\n        label: staffs[i].label,\n        notes: pitchesToIntervalMapping(staffs[i].notes),\n      };\n    }\n  });\n  return ret;\n}\n\n/**\n * Take an array of pitches (objects with key pitch (letter) and oct (number))\n * and return a mapping of absolute pitches differences between the notes\n * - if there is no change\n * a for pitch 1, b for pitch 2, c for pitch 3. Upper-case if pitch is increasing,\n * lower-case if pitch is decreasing. Doesn't take in to account accidentals\n * @param pitches\n */\nfunction pitchesToIntervalMapping(pitches: Pitch[]): string {\n  const interval_mapping = \"-abcdefghijklmnopqrstuvwxyz\".split(\"\");\n\n  const alphabet = [\"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\"];\n\n  const pitch_nums = pitches.map(function (e) {\n    // TODO: This replicates the behaviour of the awk script, where g is 0 and a->f is 1-6\n    //  appears to be a bug because of awk string indexes starting from 1\n    return (\n      ((alphabet.indexOf(e.pitch.toUpperCase()) + 1) % 7) + ((7 * e.oct) % 7)\n    );\n  });\n\n  let pitch_intervals = [];\n  // Finish one before the end, because we're looking at the gaps\n  for (let i = 0; i < pitch_nums.length - 1; i++) {\n    pitch_intervals.push(pitch_nums[i + 1] - pitch_nums[i]);\n  }\n  return pitch_intervals\n    .map(function (i) {\n      // Clamp to a maximum interval of 25 notes\n      if (i < -26) i = -26;\n      if (i > 26) i = 26;\n      let letter = interval_mapping[Math.abs(i)];\n      if (i > 0) {\n        letter = letter.toUpperCase();\n      }\n      return letter;\n    })\n    .join(\"\");\n}\n","import React, { useState } from \"react\";\nimport { parseMei } from \"../search/SearchQuery\";\nimport {\n  Accordion,\n  AccordionItem,\n  AccordionItemButton,\n  AccordionItemHeading,\n  AccordionItemPanel,\n} from \"react-accessible-accordion\";\nimport { Button, Form } from \"react-bootstrap-v5\";\n\ninterface FtempoSearchProps {\n  vrvToolkit: any;\n}\n\nconst FtempoSearch = (props: FtempoSearchProps) => {\n  const mei = props.vrvToolkit.getMEI();\n  const meiDoc = new DOMParser().parseFromString(mei, \"text/xml\");\n  const meiVoiceQueryStrings = parseMei(meiDoc);\n  const [selectedOption, setSelectedOption] = useState<string | undefined>(\n    undefined\n  );\n  const [searchResults, setSearchResults] = useState<object[]>([]);\n\n  const doSearch = () => {\n    if (!selectedOption) {\n      return;\n    }\n    const selectedVoice = meiVoiceQueryStrings[selectedOption];\n    if (selectedVoice && selectedVoice.notes) {\n      const query = { codestring: selectedVoice.notes };\n      fetch(\"https://uk-dev-ftempo.rism.digital/api/query\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify(query),\n      })\n        .then((response) => response.json())\n        .then((data) => {\n          setSearchResults(data);\n        });\n    }\n  };\n\n  return (\n    <div className=\"ftempoContainer\">\n      <h3>Search using F-TEMPO (experimental)</h3>\n      {meiVoiceQueryStrings && (\n        <>\n          <p>\n            Search this score on F-TEMPO: select a single voice from this list\n            as query\n          </p>\n          <ul>\n            {Object.keys(meiVoiceQueryStrings).map((e) => {\n              return (\n                <Form.Check\n                  key={e}\n                  type=\"radio\"\n                  name=\"voice\"\n                  value={e}\n                  id={\"voice-\" + e}\n                  checked={selectedOption === e}\n                  onChange={(e) => {\n                    setSelectedOption(e.target.value);\n                    setSearchResults([]);\n                  }}\n                  label={meiVoiceQueryStrings[e].label}\n                />\n              );\n            })}\n            {/*<li><label><input type=\"radio\" name=\"voice\" value=\"all\" checked={this.state.selectedOption === \"all\"} onChange={this.onValueChange} />All voices</label></li>*/}\n          </ul>\n          <Button\n            variant=\"success\"\n            onClick={doSearch}\n            disabled={!selectedOption}\n          >\n            Search\n          </Button>\n        </>\n      )}\n      {searchResults.length > 0 && (\n        <Accordion allowZeroExpanded>\n          {searchResults.map((i: any) => {\n            return (\n              <AccordionItem key={i.id}>\n                <AccordionItemHeading>\n                  <AccordionItemButton>{i.id}</AccordionItemButton>\n                </AccordionItemHeading>\n                <AccordionItemPanel>\n                  <img\n                    src={\n                      \"https://uk-dev-ftempo.rism.digital/img/jpg/\" +\n                      i.id +\n                      \".jpg\"\n                    }\n                    alt=\"\"\n                  />\n                </AccordionItemPanel>\n              </AccordionItem>\n            );\n          })}\n        </Accordion>\n      )}\n    </div>\n  );\n};\n\nexport default FtempoSearch;\n","import { AnnotationTarget } from \"./annotations/Annotation\";\nexport function randomColor(alpha) {\n    return ('rgba(' +\n        [\n            ~~(Math.random() * 255),\n            ~~(Math.random() * 255),\n            ~~(Math.random() * 255),\n            alpha || 1\n        ] +\n        ')');\n}\n/**\n * If contentUrl exists on resource, return the value of it, otherwise\n * return source\n * @param resource\n */\nexport function contentUrlOrSource(resource) {\n    if (resource.contentUrl !== undefined) {\n        return resource.contentUrl;\n    }\n    return resource.source;\n}\n/**\n * If contentUrl exists on resource, return \"contentUrl\" (the name\n * of the field) otherwise return \"source\"\n * @param resource\n */\nexport function nameOfContentUrlOrSource(resource) {\n    if (resource.contentUrl !== undefined) {\n        return \"contentUrl\";\n    }\n    return \"source\";\n}\nexport function startAndEndFromAnnotation(annotation) {\n    var start;\n    var end;\n    if (annotation.target[0] instanceof AnnotationTarget) {\n        start = annotation.target[0].fragmentStart;\n        end = annotation.target[0].fragmentEnd;\n    }\n    else {\n        start = annotation.target[0].start;\n        end = annotation.target[0].end;\n    }\n    return [start, end];\n}\nexport function formatBodyForSolid(start, end, resource, motivation, creator, id, body) {\n    var fragment;\n    if (start === end) {\n        fragment = \"t=\" + start;\n    }\n    else {\n        fragment = \"t=\" + start + \",\" + end;\n    }\n    return {\n        id: id !== null && id !== void 0 ? id : \"\",\n        creator: creator,\n        motivation: motivation,\n        body: body,\n        target: {\n            nodeId: resource.identifier,\n            fieldName: nameOfContentUrlOrSource(resource),\n            fragment: fragment\n        }\n    };\n}\nexport function annotationToWaveSurferRegion(annotation) {\n    var identifier = annotation.identifier;\n    var _a = startAndEndFromAnnotation(annotation), start = _a[0], end = _a[1];\n    if (isNaN(Number(start))) {\n        // No start time to display a region\n        return;\n    }\n    return {\n        id: identifier,\n        color: randomColor(0.1),\n        start: Number(start),\n        end: Number(end),\n    };\n}\nexport function extractNameFromCreatorURI(uri) {\n    if (!uri) {\n        return \"-\";\n    }\n    var regex = /\\w+(?=.trompa-solid.upf.edu)/gm;\n    var matches = regex.exec(uri);\n    if (matches === null || matches === void 0 ? void 0 : matches.length) {\n        return matches[0];\n    }\n    return uri;\n}\nexport function timeToPrecision(time) {\n    if (typeof time === \"undefined\" || time === null) {\n        return NaN;\n    }\n    return Number(Number(time).toFixed(2));\n}\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { startAndEndFromAnnotation } from \"../utils\";\nvar dataModelItemToJSONLD = function (dataModelItem, resource) {\n    // TODO check whether this.id is a http-wrapper URL or just a UUID; if the latter, translate to the former here.\n    if (typeof dataModelItem === 'string' || typeof dataModelItem === 'number') {\n        return dataModelItem;\n    }\n    var jsonldRepresentation;\n    if (dataModelItem instanceof AnnotationTarget) {\n        jsonldRepresentation = dataModelItem.toJSONLD();\n    }\n    else if (Array.isArray(dataModelItem)) {\n        jsonldRepresentation = dataModelItem.map(function (item) {\n            return dataModelItemToJSONLD(item);\n        });\n    }\n    else {\n        jsonldRepresentation = {};\n        Object.keys(dataModelItem).forEach(function (k) {\n            if (dataModelItem[k]) { // skip undefined values\n                jsonldRepresentation[k] = dataModelItemToJSONLD(dataModelItem[k]);\n            }\n        });\n    }\n    // convert targets\n    if (typeof jsonldRepresentation === 'object' && 'target' in jsonldRepresentation) {\n        if (!(Array.isArray(jsonldRepresentation['target']))) {\n            jsonldRepresentation['target'] = [jsonldRepresentation['target']];\n        }\n        jsonldRepresentation['target'] = jsonldRepresentation['target'].map(function (t) {\n            var translatedTarget;\n            if (typeof t === \"object\") {\n                if (resource) {\n                    translatedTarget = targetObjectWithResourceToUrlString(t, resource);\n                }\n                else {\n                    console.error(\"Missing resource for target: \", t, \" for annotation object: \", dataModelItem);\n                    translatedTarget = t.toString();\n                }\n            }\n            else {\n                translatedTarget = t;\n            }\n            return translatedTarget;\n        });\n    }\n    return jsonldRepresentation;\n};\nvar targetObjectWithResourceToUrlString = function (target, resource) {\n    // figure out the url: if fieldName is set, use the value of that field of the Resource\n    var targetUrl;\n    if (\"fieldName\" in target) {\n        targetUrl = resource[target['fieldName']];\n    }\n    else {\n        // ... otherwise use the url field\n        if (!(target instanceof AnnotationTarget)) {\n            targetUrl = target['url'];\n        }\n        else {\n            console.error(\"GOT UNDEFINED TARGET\");\n            targetUrl = \"UNDEFINED FOR AnnotationTarget\"; // FIXME either handle this case if relevant, or use a 'never' type\n        }\n    }\n    // figure out the fragment if one exists\n    if (\"fragment\" in target) {\n        target = new URL(targetUrl + \"#\" + target['fragment']);\n    }\n    else if (\"start\" in target && \"end\" in target) {\n        target = new URL(targetUrl + \"?t=\" + target['start'] + \",\" + target['end']);\n    }\n    else {\n        // no fragment\n        target = new URL(targetUrl);\n    }\n    return target.toString();\n};\nexport var AnnotationMotivation;\n(function (AnnotationMotivation) {\n    AnnotationMotivation[\"COMMENTING\"] = \"commenting\";\n    AnnotationMotivation[\"DESCRIBING\"] = \"describing\";\n    AnnotationMotivation[\"TAGGING\"] = \"tagging\";\n    AnnotationMotivation[\"CLASSIFYING\"] = \"classifying\";\n    AnnotationMotivation[\"ASSESSING\"] = \"assessing\";\n    AnnotationMotivation[\"LINKING\"] = \"linking\";\n})(AnnotationMotivation || (AnnotationMotivation = {}));\nexport var TimeFragmentType;\n(function (TimeFragmentType) {\n    TimeFragmentType[\"RANGE\"] = \"1\";\n    TimeFragmentType[\"PUNCTUAL\"] = \"2\";\n    TimeFragmentType[\"WHOLE\"] = \"3\";\n})(TimeFragmentType || (TimeFragmentType = {}));\nvar NotAnAnnotationError = /** @class */ (function (_super) {\n    __extends(NotAnAnnotationError, _super);\n    function NotAnAnnotationError() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    return NotAnAnnotationError;\n}(Error));\nexport { NotAnAnnotationError };\nexport var TextDirection;\n(function (TextDirection) {\n    TextDirection[\"ltr\"] = \"ltr\";\n    TextDirection[\"rtl\"] = \"rtl\";\n    TextDirection[\"auto\"] = \"auto\";\n})(TextDirection || (TextDirection = {}));\nexport var AnnotationType;\n(function (AnnotationType) {\n    AnnotationType[\"Dataset\"] = \"Dataset\";\n    AnnotationType[\"Image\"] = \"Image\";\n    AnnotationType[\"Video\"] = \"Video\";\n    AnnotationType[\"Sound\"] = \"Sound\";\n    AnnotationType[\"Text\"] = \"Text\";\n    AnnotationType[\"TextualBody\"] = \"TextualBody\";\n})(AnnotationType || (AnnotationType = {}));\nvar AnnotationExternalWebResource = /** @class */ (function () {\n    function AnnotationExternalWebResource(params) {\n        this.id = params.id;\n        this.format = params.format;\n        this.language = params.language;\n        this.processingLanguage = params.processingLanguage;\n        this.textDirection = params.textDirection;\n        this.type = params.type;\n    }\n    AnnotationExternalWebResource.prototype.toJSONLD = function () { return dataModelItemToJSONLD(this); };\n    ;\n    return AnnotationExternalWebResource;\n}());\nexport { AnnotationExternalWebResource };\nvar AnnotationTextualBody = /** @class */ (function (_super) {\n    __extends(AnnotationTextualBody, _super);\n    function AnnotationTextualBody(params) {\n        var _this = _super.call(this, __assign(__assign({}, params), { type: AnnotationType.TextualBody })) || this;\n        _this.value = params.value;\n        return _this;\n    }\n    AnnotationTextualBody.prototype.toJSONLD = function () { return dataModelItemToJSONLD(this); };\n    ;\n    return AnnotationTextualBody;\n}(AnnotationExternalWebResource));\nexport { AnnotationTextualBody };\nvar AnnotationTarget = /** @class */ (function (_super) {\n    __extends(AnnotationTarget, _super);\n    function AnnotationTarget() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Object.defineProperty(AnnotationTarget.prototype, \"fragment\", {\n        /**\n         * Get the fragment for this target's id, omitting the #\n         */\n        get: function () {\n            var url = new URL(this.id);\n            if (url.hash) {\n                // Omit #\n                return url.hash.substring(1);\n            }\n            return undefined;\n        },\n        /**\n         * Set a url fragment on this target's id\n         * @param fragment some fragment, not including the #\n         */\n        set: function (fragment) {\n            if (fragment) {\n                var url = new URL(this.id);\n                url.hash = \"#\" + fragment;\n                this.id = url.toString();\n            }\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * Given a fragment string that represents a time range, parse it to a start and end time.\n     * @param fragment\n     */\n    AnnotationTarget.fragmentToStartAndEnd = function (fragment) {\n        var params = /t=(\\d+(?:\\.\\d+)?)(?:,(\\d+(?:\\.\\d+)?))?/.exec(fragment);\n        if (!params) {\n            return [undefined, undefined];\n        }\n        return [parseFloat(params[1]), (params === null || params === void 0 ? void 0 : params[2]) ? parseFloat(params[2]) : undefined];\n    };\n    Object.defineProperty(AnnotationTarget.prototype, \"fragmentStart\", {\n        /**\n         * If the target id's fragment is a time range, the start of that range\n         */\n        get: function () {\n            if (this.fragment) {\n                var start = AnnotationTarget.fragmentToStartAndEnd(this.fragment)[0];\n                return start;\n            }\n            return undefined;\n        },\n        /**\n         * Set this target's fragment to have a specific start time\n         * @param start\n         */\n        set: function (start) {\n            var existingEnd = this.fragmentEnd;\n            // TODO: If < 0\n            if (start) {\n                this.fragment = this.timeString(start, existingEnd);\n            }\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(AnnotationTarget.prototype, \"fragmentEnd\", {\n        /**\n         * If the target id's fragment is a time range, the end of that range\n         */\n        get: function () {\n            if (this.fragment) {\n                var _a = AnnotationTarget.fragmentToStartAndEnd(this.fragment), end = _a[1];\n                return end;\n            }\n            return undefined;\n        },\n        /**\n         * Set this target's fragment to have a specific end time\n         * @param end\n         */\n        set: function (end) {\n            // TODO this.target.end = Math.max(this.target.start, end);\n            // TODO: Should this raise an error if there's no start set?\n            var existingStart = this.fragmentStart;\n            if (end) {\n                this.fragment = this.timeString(existingStart, end);\n            }\n        },\n        enumerable: false,\n        configurable: true\n    });\n    AnnotationTarget.prototype.timeString = function (start, end) {\n        if (isNaN(Number(start))) {\n            return undefined;\n        }\n        else {\n            if (!isNaN(Number(end)) && start !== end) {\n                return \"t=\" + start + \",\" + end;\n            }\n            return \"t=\" + start;\n        }\n    };\n    AnnotationTarget.prototype.toJSONLD = function () {\n        console.log(\"case: TARGET\");\n        var targetUri = this.id;\n        var frag = this.fragment;\n        if (frag) {\n            targetUri += \"#\" + frag;\n        }\n        return targetUri;\n    };\n    return AnnotationTarget;\n}(AnnotationExternalWebResource));\nexport { AnnotationTarget };\nvar Annotation = /** @class */ (function () {\n    // TODO: Formatting\n    function Annotation(params) {\n        // TODO: Editor-specific, shouldn't be part of data model\n        this.isNew = true;\n        this.identifier = params.identifier;\n        this.target = params.target;\n        this.creator = params.creator;\n        this.created = params.created;\n        this.motivation = params.motivation;\n        this.customMotivation = params.customMotivation;\n        this.body = params.body;\n        this.canonical = params.canonical;\n        this.via = params.via;\n        // TODO: Requires at least 1 target\n    }\n    Annotation.prototype.toJSONLD = function (resource) { return dataModelItemToJSONLD(this, resource); };\n    ;\n    Object.defineProperty(Annotation.prototype, \"timeFragmentType\", {\n        get: function () {\n            var _a = startAndEndFromAnnotation(this), start = _a[0], end = _a[1];\n            if (start !== undefined && !isNaN(start)) {\n                if (end !== undefined && !isNaN(end)) {\n                    return TimeFragmentType.RANGE;\n                }\n                return TimeFragmentType.PUNCTUAL;\n            }\n            return TimeFragmentType.WHOLE;\n        },\n        set: function (newTP) {\n            /*\n            switch (newTP) {\n                case TimeFragmentType.PUNCTUAL:\n                    this.end = undefined;\n                    break;\n                case TimeFragmentType.WHOLE:\n                    this.start = undefined;\n                    this.end = undefined;\n                    break;\n                case TimeFragmentType.RANGE:\n                    this.start = this.start ?? 0.5\n                    this.end = this.end ?? 1\n                    break;\n            }\n             */\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return Annotation;\n}());\nexport default Annotation;\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { jsxs as _jsxs, jsx as _jsx } from \"react/jsx-runtime\";\nimport { Component } from 'react';\nimport { ProgressBar } from 'react-bootstrap-v5';\nimport './Rating.css';\nvar Rating = /** @class */ (function (_super) {\n    __extends(Rating, _super);\n    function Rating() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.onInputChange = function (event) {\n            var onRatingChange = _this.props.onRatingChange;\n            onRatingChange(Number(event.target.value));\n        };\n        _this.getComponentFromType = function () {\n            var _a = _this.props, ratingValue = _a.ratingValue, type = _a.type, _b = _a.bestRating, bestRating = _b === void 0 ? 5 : _b, _c = _a.worstRating, worstRating = _c === void 0 ? 1 : _c;\n            switch (type) {\n                case \"stars\":\n                    var filledStars = Array(ratingValue).fill('★');\n                    var emptyStars = Array(ratingValue).fill('☆');\n                    return _jsxs(\"div\", __assign({ style: { color: 'gold', fontSize: \"1.4em;\" } }, { children: [filledStars.join(''), emptyStars.join('')] }), void 0);\n                case \"range\":\n                default:\n                    return _jsxs(\"div\", __assign({ className: \"form-control rangeInput\" }, { children: [_jsx(\"input\", { type: \"range\", min: worstRating, max: bestRating, value: ratingValue, onChange: _this.onInputChange }, void 0),\n                            ratingValue &&\n                                _jsx(ProgressBar, { now: ratingValue, min: worstRating, max: bestRating, label: ratingValue + \"/\" + bestRating }, void 0)] }), void 0);\n            }\n        };\n        return _this;\n    }\n    Rating.prototype.render = function () {\n        var label = this.props.label;\n        return (_jsxs(\"div\", __assign({ className: \"form-group\" }, { children: [_jsx(\"label\", __assign({ htmlFor: \"value\" }, { children: label }), void 0),\n                this.getComponentFromType()] }), void 0));\n    };\n    return Rating;\n}(Component));\nexport default Rating;\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport React, { Component } from 'react';\nimport WaveSurfer from 'wavesurfer.js';\n// Typescript types are not currenty working for plugins. See https://github.com/katspaugh/wavesurfer.js/issues/2038\n// @ts-ignore\nimport RegionsPlugin from 'wavesurfer.js/dist/plugin/wavesurfer.regions';\n// @ts-ignore\nimport TimelinePlugin from 'wavesurfer.js/dist/plugin/wavesurfer.timeline';\n// @ts-ignore\nimport CursorPlugin from 'wavesurfer.js/dist/plugin/wavesurfer.cursor';\nimport { randomColor } from '../utils';\nimport _throttle from 'lodash.throttle';\nimport './Waveform.css';\nvar Waveform = /** @class */ (function (_super) {\n    __extends(Waveform, _super);\n    function Waveform(props) {\n        var _this = _super.call(this, props) || this;\n        _this.form = React.createRef();\n        _this.componentDidMount = function () {\n            var initialRegions = _this.props.initialRegions;\n            _this.wavesurfer = WaveSurfer.create({\n                barWidth: 1,\n                cursorWidth: 1,\n                container: '#waveform',\n                backend: 'WebAudio',\n                height: 80,\n                interact: true,\n                progressColor: '#2D5BFF',\n                responsive: true,\n                waveColor: '#EFEFEF',\n                cursorColor: 'transparent',\n                plugins: [\n                    RegionsPlugin.create({\n                        regions: initialRegions,\n                        dragSelection: {\n                            slop: 0\n                        }\n                    }),\n                    TimelinePlugin.create({\n                        container: '#wave-timeline'\n                    }),\n                    CursorPlugin.create({\n                        showTime: true,\n                        customShowTimeStyle: { bottom: 0 }\n                    })\n                ]\n            });\n            var track = document.querySelector('#track');\n            if (track) {\n                _this.wavesurfer.load(track);\n            }\n            _this.wavesurfer.on('ready', function () {\n                var _a;\n                // Create new regions on drag\n                (_a = _this.wavesurfer) === null || _a === void 0 ? void 0 : _a.enableDragSelection({\n                    color: randomColor(0.1)\n                });\n            });\n            _this.wavesurfer.on('region-click', function (region, e) {\n                e === null || e === void 0 ? void 0 : e.stopPropagation();\n                // Play on click, loop on shift click\n                (e === null || e === void 0 ? void 0 : e.shiftKey) ? region.playLoop() : region.play();\n            });\n            _this.wavesurfer.on('region-click', _this.throttledSelectRegion);\n            _this.wavesurfer.on('region-created', _this.throttledCreateRegion);\n            _this.wavesurfer.on('region-updated', _this.throttledUpdateRegion);\n            _this.wavesurfer.on('region-removed', _this.throttledDeleteRegion);\n            // this.wavesurfer.on('region-in', this.throttledSelectRegion);\n            // this.wavesurfer.on('region-out', this.deselectRegion);\n            _this.wavesurfer.on('region-play', function (region) {\n                region.once('out', function () {\n                    var _a, _b;\n                    (_a = _this.wavesurfer) === null || _a === void 0 ? void 0 : _a.play(region.start);\n                    (_b = _this.wavesurfer) === null || _b === void 0 ? void 0 : _b.pause();\n                });\n            });\n            _this.wavesurfer.on('play', function () {\n                _this.setState({ playing: true });\n            });\n            _this.wavesurfer.on('pause', function () {\n                _this.setState({ playing: false });\n            });\n            _this.wavesurfer.drawer.on('dblclick', _this.doubleClick);\n        };\n        _this.doubleClick = function (event) {\n            var _a, _b, _c;\n            var clickPosition = (_a = _this.wavesurfer) === null || _a === void 0 ? void 0 : _a.drawer.handleEvent(event, true);\n            //@ts-ignore I know getRegionSnapToGridValue exists on the utils object\n            var computedStartTime = (_b = _this.wavesurfer) === null || _b === void 0 ? void 0 : _b.regions.util.getRegionSnapToGridValue(clickPosition * _this.wavesurfer.getDuration());\n            var computedStartTimeFloat = Number(computedStartTime).toPrecision(2);\n            var region = {\n                start: computedStartTimeFloat,\n                end: computedStartTimeFloat,\n                resize: false,\n            };\n            (_c = _this.wavesurfer) === null || _c === void 0 ? void 0 : _c.addRegion(region);\n        };\n        /** Load regions fetched from API */\n        _this.loadRegions = function (regions) {\n            regions.forEach(function (region) {\n                var _a;\n                // region.color = randomColor(0.1);\n                (_a = _this.wavesurfer) === null || _a === void 0 ? void 0 : _a.addRegion(region);\n            });\n        };\n        _this.createNewRegion = function () {\n            var _a;\n            (_a = _this.wavesurfer) === null || _a === void 0 ? void 0 : _a.addRegion({});\n        };\n        _this.updateRegionInWaveSurfer = function (region) {\n            var id = region.id, start = region.start, end = region.end;\n            if (_this.wavesurfer) {\n                var selectedRegion = _this.wavesurfer.regions.list[id];\n                if (selectedRegion) {\n                    var isPunctual = start === end;\n                    selectedRegion.update({\n                        start: start,\n                        end: end,\n                        resize: isPunctual ? false : true\n                    });\n                    console.log(\"Region saved in wavesurfer:\", selectedRegion);\n                }\n                else {\n                    console.error(\"No region with id\", id);\n                }\n            }\n        };\n        _this.deleteRegionInWaveSurfer = function (annotationId) {\n            var _a;\n            var selectedRegion = (_a = _this.wavesurfer) === null || _a === void 0 ? void 0 : _a.regions.list[annotationId];\n            if (!selectedRegion) {\n                return;\n            }\n            selectedRegion.remove();\n        };\n        _this.selectRegionInWaveSurfer = function (annotationId) {\n            var _a, _b;\n            var selectedRegion = (_a = _this.wavesurfer) === null || _a === void 0 ? void 0 : _a.regions.list[annotationId];\n            if (!selectedRegion) {\n                return;\n            }\n            if (!isNaN(selectedRegion.start)) {\n                (_b = _this.wavesurfer) === null || _b === void 0 ? void 0 : _b.fireEvent('region-click', selectedRegion);\n            }\n        };\n        _this.handlePlay = function () {\n            var _a, _b, _c;\n            var isPlaying = (_a = _this.wavesurfer) === null || _a === void 0 ? void 0 : _a.isPlaying();\n            if (isPlaying) {\n                (_b = _this.wavesurfer) === null || _b === void 0 ? void 0 : _b.pause();\n            }\n            else {\n                (_c = _this.wavesurfer) === null || _c === void 0 ? void 0 : _c.play();\n            }\n            _this.setState({ playing: !Boolean(isPlaying) });\n        };\n        _this.state = {\n            playing: false,\n        };\n        _this.form = React.createRef();\n        _this.throttledUpdateRegion = _throttle(props.updateRegion, 1000, { leading: false });\n        _this.throttledDeleteRegion = _throttle(props.deleteRegion, 1000, { leading: false });\n        _this.throttledSelectRegion = _throttle(props.selectRegion, 250, { leading: false });\n        _this.throttledCreateRegion = _throttle(props.createRegion, 250, { leading: false });\n        return _this;\n    }\n    Waveform.prototype.render = function () {\n        var resourceURL = this.props.resourceURL;\n        return (_jsxs(\"div\", __assign({ id: \"waveformContainer\" }, { children: [_jsx(\"button\", __assign({ className: \"playButton\", onClick: this.handlePlay }, { children: _jsx(\"i\", { className: this.state.playing ? 'pause-button' : 'play-button', title: \"Play/Pause\" }, void 0) }), void 0),\n                _jsxs(\"div\", __assign({ id: \"waveform-and-plugins\" }, { children: [_jsx(\"div\", { id: \"waveform\" }, void 0),\n                        _jsx(\"div\", { id: \"wave-timeline\" }, void 0)] }), void 0),\n                _jsx(\"audio\", { id: \"track\", src: resourceURL }, void 0),\n                _jsx(\"small\", { children: \"Click and drag to create a range annotation, double click to create a punctual annotation\" }, void 0)] }), void 0));\n    };\n    return Waveform;\n}(Component));\n;\nexport default Waveform;\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Row, Col, Card, ListGroup } from 'react-bootstrap-v5';\nimport { AnnotationTarget } from \"../annotations/Annotation\";\nimport \"./SessionViewer.css\";\nimport { extractNameFromCreatorURI, startAndEndFromAnnotation } from '../utils';\nfunction getURLFromTarget(target) {\n    if (!target) {\n        return null;\n    }\n    if (target instanceof AnnotationTarget) {\n        return target.id;\n    }\n    else {\n        // AnnotationCETarget\n        return target.url;\n    }\n}\nfunction SessionViewer(props) {\n    var annotations = props.annotations, selectedAnnotationId = props.selectedAnnotationId, onSelectAnnotation = props.onSelectAnnotation, onSaveSession = props.onSaveSession, onCreateNewAnnotation = props.onCreateNewAnnotation;\n    return (_jsxs(Card, __assign({ className: \"session-viewer\" }, { children: [_jsx(Card.Header, { children: \"Annotations for this session\" }, void 0),\n            _jsxs(ListGroup, { children: [annotations.map(function (annotation) {\n                        var _a;\n                        var _b = startAndEndFromAnnotation(annotation), start = _b[0], end = _b[1];\n                        return (_jsxs(ListGroup.Item, __assign({ action: true, active: annotation.identifier === selectedAnnotationId, onClick: function () {\n                                typeof onSelectAnnotation === \"function\" && onSelectAnnotation(annotation);\n                            } }, { children: [_jsxs(Row, { children: [_jsxs(Col, __assign({ md: \"auto\" }, { children: [\"url: \", getURLFromTarget((_a = annotation.target) === null || _a === void 0 ? void 0 : _a[0])] }), void 0),\n                                        !isNaN(Number(start)) &&\n                                            _jsxs(Col, __assign({ md: \"auto\" }, { children: [\"time:\\u00A0\", start, \" - \", end] }), void 0)] }, void 0),\n                                _jsxs(Row, { children: [_jsx(Col, __assign({ md: \"auto\" }, { children: _jsxs(\"small\", { children: [\"id: \", annotation.identifier] }, void 0) }), void 0),\n                                        _jsx(Col, __assign({ xs: true }, { children: _jsx(\"a\", __assign({ href: annotation.creator }, { children: extractNameFromCreatorURI(annotation.creator) }), void 0) }), void 0)] }, void 0)] }), annotation.identifier));\n                    }),\n                    onCreateNewAnnotation &&\n                        _jsx(ListGroup.Item, __assign({ variant: \"primary\", action: true, onClick: onCreateNewAnnotation }, { children: \"+ Create new annotation\" }), void 0),\n                    onSaveSession &&\n                        _jsx(ListGroup.Item, __assign({ variant: \"success\", action: true, onClick: onSaveSession }, { children: \"Save session\" }), void 0)] }, void 0)] }), void 0));\n}\nexport default SessionViewer;\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __makeTemplateObject = (this && this.__makeTemplateObject) || function (cooked, raw) {\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\n    return cooked;\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport Annotation, { AnnotationExternalWebResource, AnnotationMotivation, AnnotationTarget } from \"../annotations/Annotation\";\nimport { gql } from \"@apollo/client\";\nimport jwt_decode from \"jwt-decode\";\n// For saying that a Rating is just a definition\nexport var ADDITIONAL_TYPE_RATING_DEFINITION = \"https://vocab.trompamusic.eu/vocab#RatingDefinition\";\n// For making DefinedTerms that are a collection of tags\nexport var ADDITIONAL_TYPE_TAG_COLLECTION = \"https://vocab.trompamusic.eu/vocab#TagCollection\";\nexport var ADDITIONAL_TYPE_TAG_COLLECTION_ELEMENT = \"https://vocab.trompamusic.eu/vocab#TagCollectionElement\";\n// For making DefinedTerms that are a collection of annotation motivations\nexport var ADDITIONAL_TYPE_MOTIVATION_COLLECTION = \"https://vocab.trompamusic.eu/vocab#AnnotationMotivationCollection\";\nexport var ADDITIONAL_TYPE_MOTIVATION_COLLECTION_ELEMENT = \"https://vocab.trompamusic.eu/vocab#AnnotationMotivationCollectionElement\";\n// For saying that an ItemList is an annotation toolkit\nexport var ADDITIONAL_TYPE_ANNOTATION_TOOLKIT = \"https://vocab.trompamusic.eu/vocab#AnnotationToolkit\";\n// For saying that an ItemList is an annotation session\nexport var ADDITIONAL_TYPE_ANNOTATION_SESSION = \"https://vocab.trompamusic.eu/vocab#AnnotationSession\";\nexport var OA_ANNOTATION_MOTIVATION_TYPE = \"http://www.w3.org/ns/oa#Motivation\";\nvar TrompaError = /** @class */ (function (_super) {\n    __extends(TrompaError, _super);\n    function TrompaError() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    return TrompaError;\n}(Error));\nexport { TrompaError };\nvar TrompaClient = /** @class */ (function () {\n    function TrompaClient(authProxyUrl, apolloClient) {\n        var _this = this;\n        this.getApiToken = function () { return __awaiter(_this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                if (this.apiTokenExpired()) {\n                    return [2 /*return*/, fetch(this.authProxyUrl).then(function (result) { return result.json(); }).then(function (token) {\n                            localStorage.setItem('CEAuthToken', token.token);\n                            console.debug(\"token true\");\n                            return true;\n                        }).catch(function () {\n                            console.error(\"token false\");\n                            return false;\n                        })];\n                }\n                console.debug(\"not expired, true!\");\n                return [2 /*return*/, true];\n            });\n        }); };\n        this.apiTokenExpired = function () {\n            var apiToken = localStorage.getItem('CEAuthToken');\n            if (apiToken) {\n                var decoded = jwt_decode(apiToken);\n                var now = Date.now() / 1000;\n                // @ts-ignore\n                if (decoded.exp - now < 100) {\n                    return true;\n                }\n                else {\n                    return false;\n                }\n            }\n            return true;\n        };\n        this.saveAnnotation = function (annotation) { return __awaiter(_this, void 0, void 0, function () {\n            var motivation, creator, identifier, bodyId, _i, _a, body, response_1, targetId, _b, _c, target, response_2, response, annotationId, e_1;\n            return __generator(this, function (_d) {\n                switch (_d.label) {\n                    case 0:\n                        // TODO: Update if it already exists\n                        console.debug(annotation);\n                        motivation = annotation.motivation, creator = annotation.creator, identifier = annotation.identifier;\n                        return [4 /*yield*/, this.getApiToken()];\n                    case 1:\n                        _d.sent();\n                        if (!motivation) {\n                            throw new TypeError(\"Annotation must have a motivation\");\n                        }\n                        if (!annotation.target) {\n                            throw new TypeError(\"Annotation must have a target\");\n                        }\n                        if (!annotation.body) return [3 /*break*/, 7];\n                        _i = 0, _a = annotation.body;\n                        _d.label = 2;\n                    case 2:\n                        if (!(_i < _a.length)) return [3 /*break*/, 7];\n                        body = _a[_i];\n                        if (!(body instanceof AnnotationExternalWebResource)) return [3 /*break*/, 3];\n                        return [3 /*break*/, 6];\n                    case 3:\n                        if (!(body.type === \"TextualBody\")) return [3 /*break*/, 5];\n                        return [4 /*yield*/, this.apolloClient.mutate({\n                                mutation: CreateAnnotationTextualBody,\n                                variables: { creator: creator, value: body.value, language: body.language, format: body.format }\n                            })];\n                    case 4:\n                        response_1 = _d.sent();\n                        if (response_1.errors) {\n                            console.error(response_1.errors);\n                        }\n                        else {\n                            bodyId = response_1.data.CreateAnnotationTextualBody.identifier;\n                        }\n                        return [3 /*break*/, 6];\n                    case 5:\n                        if (body.type === \"DefinedTerm\") {\n                        }\n                        else if (body.type === \"NodeBody\") {\n                        }\n                        else if (body.type === \"Rating\") {\n                        }\n                        _d.label = 6;\n                    case 6:\n                        _i++;\n                        return [3 /*break*/, 2];\n                    case 7:\n                        if (!annotation.target) return [3 /*break*/, 14];\n                        _b = 0, _c = annotation.target;\n                        _d.label = 8;\n                    case 8:\n                        if (!(_b < _c.length)) return [3 /*break*/, 14];\n                        target = _c[_b];\n                        if (!(target instanceof AnnotationTarget)) return [3 /*break*/, 9];\n                        return [3 /*break*/, 13];\n                    case 9:\n                        if (!(target.type === 'AnnotationTarget')) return [3 /*break*/, 13];\n                        return [4 /*yield*/, this.apolloClient.mutate({\n                                mutation: CreateAnnotationCETarget,\n                                variables: { creator: creator, field: target.fieldName, fragment: target.fragment }\n                            })];\n                    case 10:\n                        response_2 = _d.sent();\n                        if (!response_2.errors) return [3 /*break*/, 11];\n                        console.error(response_2.errors);\n                        return [3 /*break*/, 13];\n                    case 11:\n                        targetId = response_2.data.CreateAnnotationCETarget.identifier;\n                        return [4 /*yield*/, this.apolloClient.mutate({\n                                mutation: MergeAnnotationCETargetTarget,\n                                variables: { annotationCeTargetId: targetId, ceNodeId: target.nodeId }\n                            })];\n                    case 12:\n                        response_2 = _d.sent();\n                        if (response_2.errors) {\n                            console.error(response_2.errors);\n                        }\n                        _d.label = 13;\n                    case 13:\n                        _b++;\n                        return [3 /*break*/, 8];\n                    case 14: return [4 /*yield*/, this.apolloClient.mutate({\n                            mutation: CreateAnnotation,\n                            variables: { creator: creator, motivation: motivation }\n                        })];\n                    case 15:\n                        response = _d.sent();\n                        if (!response.errors) return [3 /*break*/, 16];\n                        console.error(response.errors);\n                        return [3 /*break*/, 22];\n                    case 16:\n                        annotationId = response.data.CreateAnnotation.identifier;\n                        if (!bodyId) return [3 /*break*/, 18];\n                        return [4 /*yield*/, this.apolloClient.mutate({\n                                mutation: MergeAnnotationBodyText,\n                                variables: { annotationId: annotationId, bodyNodeId: bodyId }\n                            })];\n                    case 17:\n                        response = _d.sent();\n                        if (response.errors) {\n                            console.error(response.errors);\n                        }\n                        _d.label = 18;\n                    case 18:\n                        if (!targetId) return [3 /*break*/, 22];\n                        _d.label = 19;\n                    case 19:\n                        _d.trys.push([19, 21, , 22]);\n                        return [4 /*yield*/, this.apolloClient.mutate({\n                                mutation: MergeAnnotationTargetNode,\n                                variables: { annotationId: annotationId, targetNodeId: targetId }\n                            })];\n                    case 20:\n                        response = _d.sent();\n                        return [3 /*break*/, 22];\n                    case 21:\n                        e_1 = _d.sent();\n                        console.error(e_1);\n                        return [3 /*break*/, 22];\n                    case 22: return [2 /*return*/];\n                }\n            });\n        }); };\n        this.deleteAnnotation = function (identifier) { return __awaiter(_this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.getApiToken()];\n                    case 1:\n                        _a.sent();\n                        return [4 /*yield*/, this.apolloClient.mutate({ mutation: DeleteAnnotation, variables: { annotationId: identifier } })];\n                    case 2: return [2 /*return*/, _a.sent()];\n                }\n            });\n        }); };\n        this.getAnnotation = function (identifier) { return __awaiter(_this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.getApiToken()];\n                    case 1:\n                        _a.sent();\n                        return [4 /*yield*/, this.apolloClient.query({ query: GetAnnotation, variables: { annotationId: identifier } })];\n                    case 2: return [2 /*return*/, _a.sent()];\n                }\n            });\n        }); };\n        this.getAnnotationsForUser = function (user) { return __awaiter(_this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.getApiToken()];\n                    case 1:\n                        _a.sent();\n                        return [4 /*yield*/, this.apolloClient.query({ query: GetAnnotationsForCreator, variables: { creator: user } })];\n                    case 2: return [2 /*return*/, _a.sent()];\n                }\n            });\n        }); };\n        this.getAnnotationsForItem = function (nodeId) {\n            _this.getApiToken();\n            _this.apolloClient.query({ query: GetAnnotationsForItem, variables: { nodeId: nodeId } });\n        };\n        this.getAnnotationToolkitForItem = function (itemId) {\n            _this.getApiToken();\n            _this.apolloClient.query({ query: GetAnnotationToolkitForItem, variables: { itemId: itemId } });\n        };\n        this.deleteDefinedTerm = function (definedTermSetIdentifier, definedTermIdentifier) { return __awaiter(_this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.getApiToken()];\n                    case 1:\n                        if (!!(_a.sent())) return [3 /*break*/, 2];\n                        throw new TrompaError(\"whew\");\n                    case 2: return [4 /*yield*/, this.apolloClient.mutate({\n                            mutation: DeleteDefinedTerm,\n                            variables: { identifier: definedTermIdentifier }\n                        })];\n                    case 3: return [2 /*return*/, _a.sent()];\n                }\n            });\n        }); };\n        this.deleteDefinedTermSet = function (identifier) { return __awaiter(_this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.getApiToken()];\n                    case 1:\n                        if (!!(_a.sent())) return [3 /*break*/, 2];\n                        throw new TrompaError(\"whew\");\n                    case 2: return [4 /*yield*/, this.apolloClient.mutate({\n                            mutation: DeleteDefinedTermSet,\n                            variables: { identifier: identifier }\n                        })];\n                    case 3: return [2 /*return*/, _a.sent()];\n                }\n            });\n        }); };\n        this.createOrUpdateDefinedTerm = function (dtsIdentifier, definedTerm) { return __awaiter(_this, void 0, void 0, function () {\n            var response;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.getApiToken()];\n                    case 1:\n                        if (!!(_a.sent())) return [3 /*break*/, 2];\n                        throw new TrompaError(\"whew\");\n                    case 2: return [4 /*yield*/, this.apolloClient.mutate({\n                            mutation: CreateDefinedTerm,\n                            variables: {\n                                creator: definedTerm.creator,\n                                termCode: definedTerm.termCode,\n                                additionalType: definedTerm.additionalType\n                            }\n                        })];\n                    case 3:\n                        response = _a.sent();\n                        return [4 /*yield*/, this.apolloClient.mutate({\n                                mutation: MergeDefinedTermSetHasDefinedTerm,\n                                variables: {\n                                    dtsId: dtsIdentifier,\n                                    dtId: response.data.CreateDefinedTerm.identifier\n                                }\n                            })];\n                    case 4:\n                        _a.sent();\n                        return [2 /*return*/, { data: response.data.CreateDefinedTerm }];\n                }\n            });\n        }); };\n        this.createOrUpdateDefinedTermSet = function (definedTermSet) { return __awaiter(_this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.getApiToken()];\n                    case 1:\n                        if (!!(_a.sent())) return [3 /*break*/, 2];\n                        throw new TrompaError(\"whew\");\n                    case 2: return [4 /*yield*/, this.apolloClient.mutate({\n                            mutation: CreateDefinedTermSet,\n                            variables: {\n                                creator: definedTermSet.creator,\n                                name: definedTermSet.name,\n                                additionalType: definedTermSet.additionalType\n                            }\n                        })];\n                    case 3: return [2 /*return*/, _a.sent()];\n                }\n            });\n        }); };\n        this.getDefinedTermSetsForUser = function (user, additionalType) { return __awaiter(_this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.getApiToken()];\n                    case 1:\n                        if (!!(_a.sent())) return [3 /*break*/, 2];\n                        throw new TrompaError(\"whew\");\n                    case 2: return [4 /*yield*/, this.apolloClient.query({\n                            query: QueryDefinedTermSetForUser,\n                            variables: { creator: user, additionalType: additionalType }\n                        })];\n                    case 3: return [2 /*return*/, _a.sent()];\n                }\n            });\n        }); };\n        this.getAnnotationPaletteForUser = function (user) {\n            return _this.getDefinedTermSetsForUser(user, ADDITIONAL_TYPE_MOTIVATION_COLLECTION);\n        };\n        this.getAnnotationToolkitForUser = function (user) {\n            return _this.getDefinedTermSetsForUser(user, ADDITIONAL_TYPE_ANNOTATION_TOOLKIT);\n        };\n        this.getThingById = function (id) { return __awaiter(_this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.getApiToken()];\n                    case 1:\n                        _a.sent();\n                        return [4 /*yield*/, this.apolloClient.query({\n                                query: GetThingInterfaceById,\n                                variables: { id: id }\n                            })];\n                    case 2: return [2 /*return*/, _a.sent()];\n                }\n            });\n        }); };\n        this.getRatingDefinitionsForUser = function (user) { return __awaiter(_this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.getApiToken()];\n                    case 1:\n                        if (!!(_a.sent())) return [3 /*break*/, 2];\n                        throw new TrompaError(\"whew\");\n                    case 2: return [4 /*yield*/, this.apolloClient.query({\n                            query: GetRatingDefinitionsForUser,\n                            variables: { creator: user }\n                        })];\n                    case 3: return [2 /*return*/, _a.sent()];\n                }\n            });\n        }); };\n        this.createRatingDefinition = function (ratingDefinition) { return __awaiter(_this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.getApiToken()];\n                    case 1:\n                        if (!!(_a.sent())) return [3 /*break*/, 2];\n                        throw new TrompaError(\"whew\");\n                    case 2: return [4 /*yield*/, this.apolloClient.mutate({\n                            mutation: CreateRating,\n                            variables: { name: ratingDefinition.name, creator: ratingDefinition.creator,\n                                bestRating: ratingDefinition.bestRating, worstRating: ratingDefinition.worstRating,\n                                additionalType: ADDITIONAL_TYPE_RATING_DEFINITION, description: ratingDefinition.description }\n                        })];\n                    case 3: return [2 /*return*/, _a.sent()];\n                }\n            });\n        }); };\n        this.deleteRating = function (ratingIdentifier) { return __awaiter(_this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.getApiToken()];\n                    case 1:\n                        if (!!(_a.sent())) return [3 /*break*/, 2];\n                        throw new TrompaError(\"whew\");\n                    case 2: return [4 /*yield*/, this.apolloClient.mutate({\n                            mutation: DeleteRating,\n                            variables: { identifier: ratingIdentifier }\n                        })];\n                    case 3: return [2 /*return*/, _a.sent()];\n                }\n            });\n        }); };\n        this.createMotivation = function (motivation) { return __awaiter(_this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.getApiToken()];\n                    case 1:\n                        if (!!(_a.sent())) return [3 /*break*/, 2];\n                        throw new TrompaError(\"whew\");\n                    case 2: return [4 /*yield*/, this.apolloClient.mutate({\n                            mutation: CreateAnnotationCEMotivation,\n                            variables: {\n                                title: motivation.title,\n                                creator: motivation.creator,\n                                description: motivation.description,\n                                broaderUrl: motivation.broaderUrl,\n                                broaderMotivation: motivation.broaderMotivation\n                            }\n                        })];\n                    case 3: return [2 /*return*/, _a.sent()];\n                }\n            });\n        }); };\n        this.deleteMotivation = function (identifier) { return __awaiter(_this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.getApiToken()];\n                    case 1:\n                        if (!!(_a.sent())) return [3 /*break*/, 2];\n                        throw new TrompaError(\"whew\");\n                    case 2: return [4 /*yield*/, this.apolloClient.mutate({\n                            mutation: DeleteAnnotationCEMotivation,\n                            variables: { identifier: identifier }\n                        })];\n                    case 3: return [2 /*return*/, _a.sent()];\n                }\n            });\n        }); };\n        this.getMotivationsForUser = function (user) { return __awaiter(_this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.getApiToken()];\n                    case 1:\n                        if (!!(_a.sent())) return [3 /*break*/, 2];\n                        throw new TrompaError(\"whew\");\n                    case 2: return [4 /*yield*/, this.apolloClient.query({\n                            query: GetAnnotationCEMotivationsForUser,\n                            variables: { creator: user }\n                        })];\n                    case 3: return [2 /*return*/, _a.sent()];\n                }\n            });\n        }); };\n        this.authProxyUrl = authProxyUrl;\n        this.apolloClient = apolloClient;\n        this.getApiToken();\n    }\n    TrompaClient.annotationFromCE = function (ceannotation, CE_URL) {\n        var _a;\n        // TODO: Optionally more than 1 target\n        var targetNode = ceannotation.targetNode, targetUrl = ceannotation.targetUrl;\n        if (targetNode === undefined && targetUrl === undefined) {\n            throw new TypeError(\"Annotation has no target\");\n        }\n        var target;\n        if (targetUrl) {\n            // If targetUrl is set, just create a generic AnnotationTarget object whose id\n            // points to that url\n            target = targetUrl === null || targetUrl === void 0 ? void 0 : targetUrl.map(function (url) { return new AnnotationTarget({ id: url }); });\n        }\n        else {\n            // Otherwise, create a specific Trompa AnnotationTarget with the data from the CE\n            target = targetNode === null || targetNode === void 0 ? void 0 : targetNode.map(function (node) {\n                var _a;\n                var start, end;\n                if (node === null || node === void 0 ? void 0 : node.fragment) {\n                    _a = AnnotationTarget.fragmentToStartAndEnd(node.fragment), start = _a[0], end = _a[1];\n                }\n                var url = \"\";\n                // TODO: The field of a CEAnnotationTarget could be anything, but in graphql we\n                //  need to specify the exact fields that we want to return in a query\n                //  For simplicity at the moment, just assume that it's one of\n                //  (url, source) from ThingInterface, or contentUrl from MediaObjectInterface\n                if (node.field === null) {\n                    // Can be empty\n                    url = \"\" + CE_URL + (CE_URL.endsWith(\"/\") ? \"\" : \"/\") + node.target.identifier;\n                }\n                else if (node.field === \"url\") {\n                    url = node.target.url;\n                }\n                else if (node.field === \"source\") {\n                    url = node.target.source;\n                }\n                else if (node.field === \"contentUrl\") {\n                    url = node.target.contentUrl;\n                }\n                else {\n                    throw new TypeError(\"Unsupported targetNode field value\");\n                }\n                return {\n                    identifier: node.identifier,\n                    type: 'AnnotationTarget', nodeId: node.target.identifier,\n                    fieldName: node.field, url: url,\n                    start: start, end: end\n                };\n            });\n        }\n        var body = [];\n        if (ceannotation.bodyUrl && ceannotation.bodyUrl.length > 0) {\n            body = ceannotation.bodyUrl.map(function (url) { return new AnnotationExternalWebResource({ id: url }); });\n        }\n        else if (ceannotation.bodyText && ceannotation.bodyText.length > 0) {\n            body = ceannotation.bodyText.map(function (b) {\n                return {\n                    value: b.value, format: b.format,\n                    identifier: b.identifier, language: b.language,\n                    type: 'TextualBody'\n                };\n            });\n        }\n        else if (ceannotation.bodyNode && ceannotation.bodyNode.length > 0) {\n            body = ceannotation.bodyNode.map(function (b) {\n                if (b.__typename === 'DefinedTerm') {\n                    return {\n                        identifier: b.identifier, type: 'DefinedTerm',\n                        creator: b.creator, additionalType: b.additionalType,\n                        termCode: b.termCode\n                    };\n                }\n                else if (b.__typename === 'Rating') {\n                    return {\n                        identifier: b.identifier, type: 'Rating',\n                        creator: b.creator, bestRating: b.bestRating,\n                        worstRating: b.worstRating, name: b.name,\n                        additionalType: b.additionalType,\n                        ratingValue: b.ratingValue\n                    };\n                }\n                else {\n                    return null;\n                }\n            });\n        }\n        // Motivation. We always have a motivation value (\"base motivation\"), and possibly a custom\n        // one. Custom motivation can be an external URL, a DefinedTerm, or an AnnotationCEMotivation\n        var motivation = this.parseMotivationValue(ceannotation.motivation);\n        var customMotivation;\n        if (ceannotation.motivationUrl && ceannotation.motivationUrl.length > 0) {\n            // TODO: this might be an array??\n            customMotivation = ceannotation.motivationUrl[0];\n        }\n        else if (ceannotation.motivationDefinedTerm) {\n            // TODO: read DefinedTermSet broaderUrl/broaderMotivation\n            var definedTerm = ceannotation.motivationDefinedTerm;\n            customMotivation = {\n                type: 'DefinedTerm', identifier: definedTerm.identifier,\n                creator: definedTerm.creator, additionalType: definedTerm.additionalType,\n                termCode: definedTerm.termCode\n            };\n        }\n        else if (ceannotation.motivationNode && ceannotation.motivationNode.length > 0) {\n            var ceMotivation = ceannotation.motivationNode[0];\n            customMotivation = {\n                type: 'AnnotationCEMotivation', identifier: ceMotivation.identifier,\n                creator: ceMotivation.creator, description: ceMotivation.description,\n                title: ceMotivation.title, broaderUrl: ceMotivation.broaderUrl,\n                broaderMotivation: ceMotivation.broaderMotivation\n            };\n        }\n        var newAnnotation = new Annotation({ identifier: ceannotation.identifier,\n            target: target, creator: ceannotation.creator, created: (_a = ceannotation.created) === null || _a === void 0 ? void 0 : _a.formatted,\n            motivation: motivation, customMotivation: customMotivation, body: body });\n        newAnnotation.isNew = false;\n        return newAnnotation;\n    };\n    /**\n     * The values from the CE are enums, so don't contain the url prefix\n     * @param motivationValue\n     */\n    TrompaClient.parseMotivationValue = function (motivationValue) {\n        switch (motivationValue) {\n            // TODO: This doesn't contain all possible oa:Motivations.\n            //  As the values from the CE are the same as the enum values we could do this better\n            //  by just doing `AnnotationMotivation[value]`, but will still\n            //  need to check what happens if it's an invalid/unexpected value\n            case 'commenting':\n                return AnnotationMotivation.COMMENTING;\n            case 'describing':\n                return AnnotationMotivation.DESCRIBING;\n            case 'tagging':\n                return AnnotationMotivation.TAGGING;\n            case 'classifying':\n                return AnnotationMotivation.CLASSIFYING;\n            case 'assessing':\n                return AnnotationMotivation.ASSESSING;\n            case 'linking':\n                return AnnotationMotivation.LINKING;\n            default:\n                throw new TypeError(\"Not known type\");\n        }\n    };\n    return TrompaClient;\n}());\nexport default TrompaClient;\nvar GetThingInterfaceById = gql(templateObject_1 || (templateObject_1 = __makeTemplateObject([\"\\n    query ThingInterface($id: ID!) {\\n        ThingInterface(identifier: $id) {\\n            __typename\\n            identifier\\n            source\\n            name\\n            title\\n            ... on MediaObjectInterface {\\n                contentUrl\\n            }\\n            ... on AudioObject {\\n                contentUrl\\n            }\\n        }\\n    }\\n\"], [\"\\n    query ThingInterface($id: ID!) {\\n        ThingInterface(identifier: $id) {\\n            __typename\\n            identifier\\n            source\\n            name\\n            title\\n            ... on MediaObjectInterface {\\n                contentUrl\\n            }\\n            ... on AudioObject {\\n                contentUrl\\n            }\\n        }\\n    }\\n\"])));\nexport var DefinedTermFragment = gql(templateObject_2 || (templateObject_2 = __makeTemplateObject([\"\\n    fragment DefinedTermFragment on DefinedTerm {\\n        identifier\\n        additionalType\\n        termCode\\n        image\\n    }\\n\"], [\"\\n    fragment DefinedTermFragment on DefinedTerm {\\n        identifier\\n        additionalType\\n        termCode\\n        image\\n    }\\n\"])));\nexport var DefinedTermSetFragment = gql(templateObject_3 || (templateObject_3 = __makeTemplateObject([\"\\n    \", \"\\n    fragment DefinedTermSetFragment on DefinedTermSet {\\n        type: __typename\\n        identifier\\n        name\\n        creator\\n        additionalType\\n        broaderUrl\\n        broaderMotivation\\n        hasDefinedTerm {\\n            ...DefinedTermFragment\\n        }\\n    }\\n\"], [\"\\n    \", \"\\n    fragment DefinedTermSetFragment on DefinedTermSet {\\n        type: __typename\\n        identifier\\n        name\\n        creator\\n        additionalType\\n        broaderUrl\\n        broaderMotivation\\n        hasDefinedTerm {\\n            ...DefinedTermFragment\\n        }\\n    }\\n\"])), DefinedTermFragment);\nexport var CreateDefinedTermSet = gql(templateObject_4 || (templateObject_4 = __makeTemplateObject([\"\\n    \", \"\\n    mutation CreateDefinedTermSet($creator: String!, $name: String!, $additionalType: String!) {\\n        CreateDefinedTermSet(\\n            additionalType: [$additionalType]\\n            creator: $creator\\n            name: $name\\n        ) {\\n            ...DefinedTermSetFragment\\n        }\\n    }\\n\"], [\"\\n    \", \"\\n    mutation CreateDefinedTermSet($creator: String!, $name: String!, $additionalType: String!) {\\n        CreateDefinedTermSet(\\n            additionalType: [$additionalType]\\n            creator: $creator\\n            name: $name\\n        ) {\\n            ...DefinedTermSetFragment\\n        }\\n    }\\n\"])), DefinedTermSetFragment);\nexport var UpdateDefinedTermSet = gql(templateObject_5 || (templateObject_5 = __makeTemplateObject([\"\\n    \", \"\\n    mutation UpdateDefinedTermSet($identifier: ID!, $creator: String!, $name: String!, $additionalType: String!) {\\n        UpdateDefinedTermSet(\\n            identifier: $identifier\\n            additionalType: [$additionalType]\\n            creator: $creator\\n            name: $name\\n        ) {\\n            ...DefinedTermSetFragment\\n        }\\n    }\\n\"], [\"\\n    \", \"\\n    mutation UpdateDefinedTermSet($identifier: ID!, $creator: String!, $name: String!, $additionalType: String!) {\\n        UpdateDefinedTermSet(\\n            identifier: $identifier\\n            additionalType: [$additionalType]\\n            creator: $creator\\n            name: $name\\n        ) {\\n            ...DefinedTermSetFragment\\n        }\\n    }\\n\"])), DefinedTermSetFragment);\nexport var DeleteDefinedTermSet = gql(templateObject_6 || (templateObject_6 = __makeTemplateObject([\"\\n    mutation DeleteDefinedTermSet($identifier: ID!) {\\n        DeleteDefinedTermSet(identifier: $identifier) {\\n            identifier\\n        }\\n    }\\n\"], [\"\\n    mutation DeleteDefinedTermSet($identifier: ID!) {\\n        DeleteDefinedTermSet(identifier: $identifier) {\\n            identifier\\n        }\\n    }\\n\"])));\nexport var CreateDefinedTerm = gql(templateObject_7 || (templateObject_7 = __makeTemplateObject([\"\\n    mutation CreateDefinedTerm($creator: String!, $additionalType: String!, $termCode: String!, $image: String) {\\n        CreateDefinedTerm(\\n            additionalType: [$additionalType]\\n            creator: $creator\\n            termCode: $termCode\\n            image: $image\\n        ) {\\n            identifier\\n            additionalType\\n            creator\\n            termCode\\n            image\\n        }\\n    }\\n\"], [\"\\n    mutation CreateDefinedTerm($creator: String!, $additionalType: String!, $termCode: String!, $image: String) {\\n        CreateDefinedTerm(\\n            additionalType: [$additionalType]\\n            creator: $creator\\n            termCode: $termCode\\n            image: $image\\n        ) {\\n            identifier\\n            additionalType\\n            creator\\n            termCode\\n            image\\n        }\\n    }\\n\"])));\nexport var UpdateDefinedTerm = gql(templateObject_8 || (templateObject_8 = __makeTemplateObject([\"\\n    mutation UpdateDefinedTerm($identifier: ID!, $creator: String!, $additionalType: String!, $termCode: String, $image: String) {\\n        UpdateDefinedTerm(\\n            identifier: $identifier\\n            additionalType: [$additionalType]\\n            creator: $creator\\n            termCode: $termCode\\n            image: $image\\n        ) {\\n            identifier\\n        }\\n    }\\n\"], [\"\\n    mutation UpdateDefinedTerm($identifier: ID!, $creator: String!, $additionalType: String!, $termCode: String, $image: String) {\\n        UpdateDefinedTerm(\\n            identifier: $identifier\\n            additionalType: [$additionalType]\\n            creator: $creator\\n            termCode: $termCode\\n            image: $image\\n        ) {\\n            identifier\\n        }\\n    }\\n\"])));\nexport var DeleteDefinedTerm = gql(templateObject_9 || (templateObject_9 = __makeTemplateObject([\"\\n    mutation DeleteDefinedTerm($identifier: ID!) {\\n        DeleteDefinedTerm(identifier: $identifier) {\\n            identifier\\n        }\\n    }\\n\"], [\"\\n    mutation DeleteDefinedTerm($identifier: ID!) {\\n        DeleteDefinedTerm(identifier: $identifier) {\\n            identifier\\n        }\\n    }\\n\"])));\nexport var MergeDefinedTermSetHasDefinedTerm = gql(templateObject_10 || (templateObject_10 = __makeTemplateObject([\"\\n    mutation MergeDefinedTermSetHasDefinedTerm($dtsId: ID!, $dtId: ID!) {\\n        MergeDefinedTermSetHasDefinedTerm(\\n            from: {identifier: $dtsId}\\n            to: {identifier: $dtId}\\n        ) {\\n            from {\\n                identifier\\n            }\\n            to {\\n                identifier\\n            }\\n        }\\n    }\\n\"], [\"\\n    mutation MergeDefinedTermSetHasDefinedTerm($dtsId: ID!, $dtId: ID!) {\\n        MergeDefinedTermSetHasDefinedTerm(\\n            from: {identifier: $dtsId}\\n            to: {identifier: $dtId}\\n        ) {\\n            from {\\n                identifier\\n            }\\n            to {\\n                identifier\\n            }\\n        }\\n    }\\n\"])));\nexport var QueryDefinedTermSetForUser = gql(templateObject_11 || (templateObject_11 = __makeTemplateObject([\"\\n    \", \"\\n    query DefinedTermSet($creator: String!, $additionalType: String!) {\\n        DefinedTermSet(creator: $creator filter: {additionalType_contains: [$additionalType]}) {\\n            ...DefinedTermSetFragment\\n        }\\n    }\\n\"], [\"\\n    \", \"\\n    query DefinedTermSet($creator: String!, $additionalType: String!) {\\n        DefinedTermSet(creator: $creator filter: {additionalType_contains: [$additionalType]}) {\\n            ...DefinedTermSetFragment\\n        }\\n    }\\n\"])), DefinedTermSetFragment);\nvar CreateAnnotationTextualBody = gql(templateObject_12 || (templateObject_12 = __makeTemplateObject([\"\\n    mutation CreateAnnotationTextualBody($creator: String!, $value: String!, $format: String, $language: AvailableLanguage){\\n        CreateAnnotationTextualBody(\\n            creator: $creator\\n            value: $value\\n            format: $format\\n            language: $language\\n        ) {\\n            identifier\\n        }\\n    }\\n\"], [\"\\n    mutation CreateAnnotationTextualBody($creator: String!, $value: String!, $format: String, $language: AvailableLanguage){\\n        CreateAnnotationTextualBody(\\n            creator: $creator\\n            value: $value\\n            format: $format\\n            language: $language\\n        ) {\\n            identifier\\n        }\\n    }\\n\"])));\nvar CreateAnnotationCETarget = gql(templateObject_13 || (templateObject_13 = __makeTemplateObject([\"\\n    mutation CreateAnnotationCETarget($creator: String!, $field: String, $fragment: String) {\\n        CreateAnnotationCETarget(\\n            creator: $creator\\n            field: $field\\n            fragment: $fragment\\n        ) {\\n            identifier\\n        }\\n    }\\n\"], [\"\\n    mutation CreateAnnotationCETarget($creator: String!, $field: String, $fragment: String) {\\n        CreateAnnotationCETarget(\\n            creator: $creator\\n            field: $field\\n            fragment: $fragment\\n        ) {\\n            identifier\\n        }\\n    }\\n\"])));\nvar MergeAnnotationCETargetTarget = gql(templateObject_14 || (templateObject_14 = __makeTemplateObject([\"\\n    mutation MergeAnnotationCETargetTarget($annotationCeTargetId: ID!, $ceNodeId: ID!) {\\n        MergeAnnotationCETargetTarget(\\n            from: {identifier: $annotationCeTargetId}\\n            to: {identifier: $ceNodeId}\\n        ) {\\n            from {identifier}\\n            to {identifier}\\n        }\\n    }\\n\"], [\"\\n    mutation MergeAnnotationCETargetTarget($annotationCeTargetId: ID!, $ceNodeId: ID!) {\\n        MergeAnnotationCETargetTarget(\\n            from: {identifier: $annotationCeTargetId}\\n            to: {identifier: $ceNodeId}\\n        ) {\\n            from {identifier}\\n            to {identifier}\\n        }\\n    }\\n\"])));\nvar CreateAnnotation = gql(templateObject_15 || (templateObject_15 = __makeTemplateObject([\"\\n    mutation CreateAnnotation($creator: String!, $motivation: AnnotationMotivation!) {\\n        CreateAnnotation(\\n            creator: $creator\\n            motivation: $motivation\\n        ) {\\n            identifier\\n        }\\n    }\\n\"], [\"\\n    mutation CreateAnnotation($creator: String!, $motivation: AnnotationMotivation!) {\\n        CreateAnnotation(\\n            creator: $creator\\n            motivation: $motivation\\n        ) {\\n            identifier\\n        }\\n    }\\n\"])));\nvar DeleteAnnotation = gql(templateObject_16 || (templateObject_16 = __makeTemplateObject([\"\\n    mutation DeleteAnnotation($annotationId: ID!) {\\n        DeleteAnnotation(identifier: $annotationId) {\\n            identifier\\n        }\\n    }\\n\"], [\"\\n    mutation DeleteAnnotation($annotationId: ID!) {\\n        DeleteAnnotation(identifier: $annotationId) {\\n            identifier\\n        }\\n    }\\n\"])));\nvar MergeAnnotationTargetNode = gql(templateObject_17 || (templateObject_17 = __makeTemplateObject([\"\\n    mutation MergeAnnotationTargetNode($annotationId: ID!, $targetNodeId: ID!){\\n        MergeAnnotationTargetNode(\\n            from: {identifier: $annotationId}\\n            to: {identifier: $targetNodeId}\\n        ) {\\n            from {\\n                identifier\\n            }\\n            to {\\n                identifier\\n            }\\n        }\\n    }\\n\"], [\"\\n    mutation MergeAnnotationTargetNode($annotationId: ID!, $targetNodeId: ID!){\\n        MergeAnnotationTargetNode(\\n            from: {identifier: $annotationId}\\n            to: {identifier: $targetNodeId}\\n        ) {\\n            from {\\n                identifier\\n            }\\n            to {\\n                identifier\\n            }\\n        }\\n    }\\n\"])));\nvar MergeAnnotationBodyText = gql(templateObject_18 || (templateObject_18 = __makeTemplateObject([\"\\n    mutation MergeAnnotationBodyText($annotationId: ID!, $bodyNodeId: ID!){\\n        MergeAnnotationBodyText(\\n            from: {identifier: $annotationId}\\n            to: {identifier: $bodyNodeId}\\n        ) {\\n            from {\\n                identifier\\n            }\\n            to {\\n                identifier\\n            }\\n        }\\n    }\\n\"], [\"\\n    mutation MergeAnnotationBodyText($annotationId: ID!, $bodyNodeId: ID!){\\n        MergeAnnotationBodyText(\\n            from: {identifier: $annotationId}\\n            to: {identifier: $bodyNodeId}\\n        ) {\\n            from {\\n                identifier\\n            }\\n            to {\\n                identifier\\n            }\\n        }\\n    }\\n\"])));\nvar annotation_common = \"\\n\\tidentifier\\n\\tcreator\\n\\tcreated {\\n\\t\\tformatted\\n\\t}\\n\\ttargetUrl\\n\\ttargetNode {\\n\\t\\ttarget {\\n\\t\\t\\t__typename\\n\\t\\t\\tidentifier\\n\\t\\t\\turl\\n\\t\\t\\tsource\\n\\t\\t\\t... on MediaObject {\\n\\t\\t\\t    contentUrl\\n\\t\\t\\t}\\n\\t\\t\\t... on AudioObject {\\n\\t\\t\\t    contentUrl\\n\\t\\t\\t}\\n\\t\\t}\\n\\t\\tfield\\n\\t\\tfragment\\n\\t}\\n    motivation\\n    motivationUrl\\n    motivationNode {\\n      identifier\\n      creator\\n      broaderMotivation\\n      broaderUrl\\n      title\\n      description\\n    }\\n    motivationDefinedTerm {\\n      identifier\\n      broaderMotivation\\n      termCode\\n      broaderUrl\\n      additionalType\\n    }\\n\\tbodyUrl\\n\\tbodyText {\\n\\t\\tidentifier\\n\\t\\tvalue\\n\\t\\tformat\\n\\t\\tlanguage\\n\\t}\\n\\tbodyNode {\\n\\t\\t__typename\\n\\t\\tidentifier\\n\\t\\t... on DefinedTerm {\\n\\t\\t\\ttermCode\\n\\t\\t\\tadditionalType\\n\\t\\t\\tinDefinedTermSet {\\n\\t\\t\\t\\t... on DefinedTermSet {\\n\\t\\t\\t\\t\\tidentifier\\n\\t\\t\\t\\t\\tadditionalType\\n\\t\\t\\t\\t\\tname\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\t\\t}\\n\\t\\t... on Rating {\\n\\t\\t    creator\\n\\t\\t\\tratingValue\\n\\t\\t\\tbestRating\\n\\t\\t\\tworstRating\\n\\t\\t\\tadditionalType\\n\\t\\t}\\n\\t}\\n\";\nvar GetAnnotationsForCreator = gql(templateObject_19 || (templateObject_19 = __makeTemplateObject([\"\\n    query AnnotationForCreator($creator: String!) {\\n        Annotation(creator: $creator) {\\n            \", \"\\n        }\\n    }\\n\"], [\"\\n    query AnnotationForCreator($creator: String!) {\\n        Annotation(creator: $creator) {\\n            \", \"\\n        }\\n    }\\n\"])), annotation_common);\nvar GetAnnotationsForItem = gql(templateObject_20 || (templateObject_20 = __makeTemplateObject([\"\\n    query AnnotationForNode($nodeId: String!) {\\n        Annotation(filter:{targetNode:{target:{identifier:$nodeId}}}) {\\n            \", \"\\n        }\\n    }\\n\"], [\"\\n    query AnnotationForNode($nodeId: String!) {\\n        Annotation(filter:{targetNode:{target:{identifier:$nodeId}}}) {\\n            \", \"\\n        }\\n    }\\n\"])), annotation_common);\nvar GetAnnotation = gql(templateObject_21 || (templateObject_21 = __makeTemplateObject([\"\\n    query Annotation($annotationId: ID!) {\\n        Annotation(identifier: $annotationId) {\\n            \", \"\\n        }\\n    }\\n\"], [\"\\n    query Annotation($annotationId: ID!) {\\n        Annotation(identifier: $annotationId) {\\n            \", \"\\n        }\\n    }\\n\"])), annotation_common);\nvar GetAnnotationToolkitForItem = gql(templateObject_22 || (templateObject_22 = __makeTemplateObject([\"\\n    query AnnotationToolkitForItem($itemId: ID!) {\\n        ItemList(identifier:$itemId) {\\n            additionalType\\n            identifier\\n            name\\n            itemListElement {\\n                ... on ListItem {\\n                    identifier\\n                    name\\n                    itemUrl\\n                    item {\\n                        __typename\\n                        identifier\\n                        ... on DefinedTermSet {\\n                            name\\n                            additionalType\\n                            hasDefinedTerm {\\n                                identifier\\n                                broaderUrl\\n                                broaderMotivation\\n                                termCode\\n                                image\\n                            }\\n                        }\\n                        ... on Rating {\\n                            name\\n                            worstRating\\n                            bestRating\\n                        }\\n                    }\\n                }\\n            }\\n        }\\n    }\\n\"], [\"\\n    query AnnotationToolkitForItem($itemId: ID!) {\\n        ItemList(identifier:$itemId) {\\n            additionalType\\n            identifier\\n            name\\n            itemListElement {\\n                ... on ListItem {\\n                    identifier\\n                    name\\n                    itemUrl\\n                    item {\\n                        __typename\\n                        identifier\\n                        ... on DefinedTermSet {\\n                            name\\n                            additionalType\\n                            hasDefinedTerm {\\n                                identifier\\n                                broaderUrl\\n                                broaderMotivation\\n                                termCode\\n                                image\\n                            }\\n                        }\\n                        ... on Rating {\\n                            name\\n                            worstRating\\n                            bestRating\\n                        }\\n                    }\\n                }\\n            }\\n        }\\n    }\\n\"])));\nvar GetRatingDefinitionsForUser = gql(templateObject_23 || (templateObject_23 = __makeTemplateObject([\"\\n    query RatingDefinitionsForUser($creator: String!) {\\n        Rating(creator: $creator, filter: {additionalType_contains: [\\\"\", \"\\\"]}) {\\n            identifier\\n            creator\\n            additionalType\\n            name\\n            description\\n            bestRating\\n            worstRating\\n        }\\n    }\\n\"], [\"\\n    query RatingDefinitionsForUser($creator: String!) {\\n        Rating(creator: $creator, filter: {additionalType_contains: [\\\"\", \"\\\"]}) {\\n            identifier\\n            creator\\n            additionalType\\n            name\\n            description\\n            bestRating\\n            worstRating\\n        }\\n    }\\n\"])), ADDITIONAL_TYPE_RATING_DEFINITION);\nvar DeleteRating = gql(templateObject_24 || (templateObject_24 = __makeTemplateObject([\"\\n    mutation DeleteRating($identifier: ID!) {\\n        DeleteRating(identifier: $identifier) {\\n            identifier\\n        }\\n    }\\n\"], [\"\\n    mutation DeleteRating($identifier: ID!) {\\n        DeleteRating(identifier: $identifier) {\\n            identifier\\n        }\\n    }\\n\"])));\nvar CreateRating = gql(templateObject_25 || (templateObject_25 = __makeTemplateObject([\"\\n    mutation CreateRating($name: String!, $creator: String!, $bestRating: Int!, $worstRating: Int!, \\n        $ratingValue: Int, $additionalType: String!, $description: String\\n    ) {\\n        CreateRating(\\n            creator: $creator\\n            name: $name\\n            bestRating: $bestRating\\n            worstRating: $worstRating\\n            additionalType: [$additionalType]\\n            description: $description\\n            ratingValue: $ratingValue\\n        ) {\\n            identifier\\n            creator\\n            name\\n            description\\n            bestRating\\n            worstRating\\n            ratingValue\\n            additionalType\\n        }\\n    }\\n\"], [\"\\n    mutation CreateRating($name: String!, $creator: String!, $bestRating: Int!, $worstRating: Int!, \\n        $ratingValue: Int, $additionalType: String!, $description: String\\n    ) {\\n        CreateRating(\\n            creator: $creator\\n            name: $name\\n            bestRating: $bestRating\\n            worstRating: $worstRating\\n            additionalType: [$additionalType]\\n            description: $description\\n            ratingValue: $ratingValue\\n        ) {\\n            identifier\\n            creator\\n            name\\n            description\\n            bestRating\\n            worstRating\\n            ratingValue\\n            additionalType\\n        }\\n    }\\n\"])));\nvar GetAnnotationCEMotivationsForUser = gql(templateObject_26 || (templateObject_26 = __makeTemplateObject([\"\\n    query AnnotationCEMotivationForUser($creator: String!) {\\n        AnnotationCEMotivation(creator: $creator) {\\n            identifier\\n            creator\\n            created {formatted}\\n            title\\n            description\\n            broaderUrl\\n            broaderMotivation\\n        }\\n    }\\n\"], [\"\\n    query AnnotationCEMotivationForUser($creator: String!) {\\n        AnnotationCEMotivation(creator: $creator) {\\n            identifier\\n            creator\\n            created {formatted}\\n            title\\n            description\\n            broaderUrl\\n            broaderMotivation\\n        }\\n    }\\n\"])));\nvar DeleteAnnotationCEMotivation = gql(templateObject_27 || (templateObject_27 = __makeTemplateObject([\"\\n    mutation AnnotationCEMotivation($identifier: ID!) {\\n        DeleteAnnotationCEMotivation(identifier: $identifier) {\\n            identifier\\n        }\\n    }\\n\"], [\"\\n    mutation AnnotationCEMotivation($identifier: ID!) {\\n        DeleteAnnotationCEMotivation(identifier: $identifier) {\\n            identifier\\n        }\\n    }\\n\"])));\nvar CreateAnnotationCEMotivation = gql(templateObject_28 || (templateObject_28 = __makeTemplateObject([\"\\n    mutation CreateAnnotationCEMotivation($title: String!, $creator: String!, $description: String,\\n        $broaderUrl: String, $broaderMotivation: AnnotationMotivation\\n    ) {\\n        CreateAnnotationCEMotivation(\\n            creator: $creator\\n            title: $title\\n            description: $description\\n            broaderUrl: $broaderUrl\\n            broaderMotivation: $broaderMotivation\\n        ) {\\n            identifier\\n            creator\\n            created {formatted}\\n            title\\n            description\\n            broaderUrl\\n            broaderMotivation\\n        }\\n    }\\n\"], [\"\\n    mutation CreateAnnotationCEMotivation($title: String!, $creator: String!, $description: String,\\n        $broaderUrl: String, $broaderMotivation: AnnotationMotivation\\n    ) {\\n        CreateAnnotationCEMotivation(\\n            creator: $creator\\n            title: $title\\n            description: $description\\n            broaderUrl: $broaderUrl\\n            broaderMotivation: $broaderMotivation\\n        ) {\\n            identifier\\n            creator\\n            created {formatted}\\n            title\\n            description\\n            broaderUrl\\n            broaderMotivation\\n        }\\n    }\\n\"])));\nvar templateObject_1, templateObject_2, templateObject_3, templateObject_4, templateObject_5, templateObject_6, templateObject_7, templateObject_8, templateObject_9, templateObject_10, templateObject_11, templateObject_12, templateObject_13, templateObject_14, templateObject_15, templateObject_16, templateObject_17, templateObject_18, templateObject_19, templateObject_20, templateObject_21, templateObject_22, templateObject_23, templateObject_24, templateObject_25, templateObject_26, templateObject_27, templateObject_28;\n","var __makeTemplateObject = (this && this.__makeTemplateObject) || function (cooked, raw) {\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\n    return cooked;\n};\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { SearchResult } from 'trompa-multimodal-component';\nimport { gql } from \"@apollo/client\";\nvar AudioObject = /** @class */ (function () {\n    function AudioObject() {\n    }\n    AudioObject.filters = [{\n            onProperty: 'format',\n            name: 'format',\n        }];\n    AudioObject.searchAllQuery = gql(templateObject_1 || (templateObject_1 = __makeTemplateObject([\"\\n        query($query: String!, $first: Int = 9999) {\\n            allResults: searchMetadataText(onTypes: [AudioObject], onFields: [title], substring: $query, first: $first) {\\n                ... on AudioObject {\\n                    identifier\\n                    format\\n                    _searchScore\\n                }\\n            }\\n        }\\n    \"], [\"\\n        query($query: String!, $first: Int = 9999) {\\n            allResults: searchMetadataText(onTypes: [AudioObject], onFields: [title], substring: $query, first: $first) {\\n                ... on AudioObject {\\n                    identifier\\n                    format\\n                    _searchScore\\n                }\\n            }\\n        }\\n    \"])));\n    AudioObject.searchQuery = gql(templateObject_2 || (templateObject_2 = __makeTemplateObject([\"\\n        query($filter: _AudioObjectFilter) {\\n            results: AudioObject(filter: $filter, first: 50) {\\n                __typename\\n                ... on AudioObject {\\n                    identifier\\n                    name\\n                    title\\n                    contributor\\n                    creator\\n                    source\\n                    contentUrl\\n                    format\\n                    encodingFormat\\n                }\\n            }\\n        }\\n    \"], [\"\\n        query($filter: _AudioObjectFilter) {\\n            results: AudioObject(filter: $filter, first: 50) {\\n                __typename\\n                ... on AudioObject {\\n                    identifier\\n                    name\\n                    title\\n                    contributor\\n                    creator\\n                    source\\n                    contentUrl\\n                    format\\n                    encodingFormat\\n                }\\n            }\\n        }\\n    \"])));\n    return AudioObject;\n}());\nexport default AudioObject;\nexport var renderSearchResult = function (type, item, onClick) {\n    return _jsx(SearchResult, { title: function () { return onClick(item); } }, void 0);\n};\nvar templateObject_1, templateObject_2;\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport { access, getSolidDataset, getUrl, getThing, getContainedResourceUrlAll, } from \"@inrupt/solid-client\";\nimport { WS } from \"@inrupt/vocab-solid-common\";\nimport { v4 as uuidv4 } from \"uuid\";\nvar httpVerb;\n(function (httpVerb) {\n    httpVerb[\"POST\"] = \"POST\";\n    httpVerb[\"GET\"] = \"GET\";\n    httpVerb[\"PUT\"] = \"PUT\";\n    httpVerb[\"DELETE\"] = \"DELETE\";\n    httpVerb[\"PATCH\"] = \"PATCH\";\n})(httpVerb || (httpVerb = {}));\n;\nvar SolidClient = /** @class */ (function () {\n    function SolidClient(session) {\n        var _this = this;\n        this.solidRESTInteraction = function (url, method, headers, payload) { return __awaiter(_this, void 0, void 0, function () {\n            var fetchOptions;\n            return __generator(this, function (_a) {\n                headers[\"content-type\"] = \"application/ld+json\";\n                headers[\"accept\"] = \"application/ld+json\";\n                // if POSTing ensure a payload exists and an \"@id\" is set\n                if (method === \"POST\") {\n                    // prepare for payload URI after POST success (using @id and Slug)\n                    // use Slug if provided in headers, otherwise take the @id\n                    // warn if both are provided and there is a mismatch\n                    if (!payload || !(\"@id\" in payload)) {\n                        console.warn('Cowardly refusing to POST without a JSON-LD payload with an \"@id\" set.');\n                        return [2 /*return*/, null];\n                    }\n                    else if (\"Slug\" in headers && payload[\"@id\"] !== headers[\"Slug\"]) {\n                        console.debug('Mismatch between top-level payload \"@id\" and Slug header. I hope you know what you are doing...');\n                    }\n                    else if (!(\"Slug\" in headers)) {\n                        headers[\"Slug\"] = payload[\"@id\"].substring(payload[\"@id\"].lastIndexOf(\"/\") + 1);\n                    }\n                }\n                fetchOptions = { method: method, headers: headers };\n                if (payload) {\n                    fetchOptions[\"body\"] = JSON.stringify(payload);\n                }\n                ;\n                return [2 /*return*/, this.session.fetch(url.toString(), fetchOptions)\n                        .then(function (response) {\n                        return response;\n                    })\n                        .catch(function (err) {\n                        console.error(\"Error with solidInteraction:\", err);\n                        return err;\n                    })];\n            });\n        }); };\n        this.isPublicReadable = function (resourceUri) { return __awaiter(_this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, access.getPublicAccess(resourceUri.toString(), { fetch: this.session.fetch })\n                            .then(function (access) {\n                            if (access === null) {\n                                console.warn(\"Could not check whether the following resource is public readable. User may not have view access, or resource access may have been modified with incompatible Solid authn library.\", resourceUri);\n                                return false;\n                            }\n                            else {\n                                return access.read;\n                            }\n                        })];\n                    case 1: return [2 /*return*/, _a.sent()];\n                }\n            });\n        }); };\n        this.userControlsAccess = function (resourceUri) { return __awaiter(_this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, access.getAgentAccess(resourceUri.toString(), this.session.info.webId.toString(), { fetch: this.session.fetch })\n                            .then(function (access) {\n                            if (access === null) {\n                                console.warn(\"Could not check whether the user controls access over the following resource. Have you turned on 'Control' for this URI in the Solid Pod's trusted application preferences? Otherwise, resource access may have been modified with incompatible Solid authn library.\", resourceUri);\n                                return false;\n                            }\n                            else {\n                                return access.controlRead;\n                            }\n                        })];\n                    case 1: return [2 /*return*/, _a.sent()];\n                }\n            });\n        }); };\n        this.grantPublicReadable = function (resourceUri) { return __awaiter(_this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                access.setPublicAccess(resourceUri.toString(), { read: true, write: false }, { fetch: this.session.fetch }).then(function (newAccess) {\n                    if (newAccess === null) {\n                        console.warn(\"Could not load access details for resource at \", resourceUri.toString());\n                    }\n                    else {\n                        console.debug(\"After revokePublicReadable on \", resourceUri.toString(), \" public access is: \", newAccess);\n                    }\n                });\n                return [2 /*return*/];\n            });\n        }); };\n        this.revokePublicReadable = function (resourceUri) { return __awaiter(_this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                access.setPublicAccess(resourceUri.toString(), { read: false, write: false }, { fetch: this.session.fetch }).then(function (newAccess) {\n                    if (newAccess === null) {\n                        console.warn(\"Could not load access details for resource at \", resourceUri.toString());\n                    }\n                    else {\n                        console.debug(\"After revokePublicReadable on \", resourceUri.toString(), \" public access is: \", newAccess);\n                    }\n                });\n                return [2 /*return*/];\n            });\n        }); };\n        this.saveAnnotation = function (annotation, container) { return __awaiter(_this, void 0, void 0, function () {\n            var profileDocUri, profileDataset, profile, postUrl, podUrl;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        profileDocUri = this.session.info.webId.split(\"#\")[0];\n                        return [4 /*yield*/, getSolidDataset(profileDocUri, { fetch: this.session.fetch })];\n                    case 1:\n                        profileDataset = _a.sent();\n                        profile = getThing(profileDataset, this.session.info.webId);\n                        if (!container.startsWith('/')) {\n                            container = '/' + container;\n                        }\n                        if (profile) {\n                            podUrl = getUrl(profile, WS.storage);\n                            if (podUrl) {\n                                postUrl = new URL(new URL(podUrl).origin + container);\n                            }\n                            else {\n                                console.error(\"Could not determine POD URL from user's webId profile. Dangerously hacking it from webId URL instead!\");\n                                postUrl = new URL(new URL(this.session.info.webId).origin + container);\n                            }\n                        }\n                        else {\n                            console.error(\"Could not access user's profile. Dangerously hacking POD URL from webId URL instead!\");\n                            postUrl = new URL(new URL(this.session.info.webId).origin + container);\n                        }\n                        if (\"@id\" in annotation) {\n                            annotation[\"@id\"] = annotation[\"@id\"].toString();\n                        }\n                        else {\n                            annotation[\"@id\"] = postUrl.origin + container + uuidv4().toString() + \".jsonld\";\n                        }\n                        annotation[\"@context\"] = \"http://www.w3.org/ns/anno.jsonld\";\n                        annotation[\"@type\"] = \"Annotation\";\n                        return [2 /*return*/, this.solidRESTInteraction(postUrl, httpVerb.POST, {}, annotation)];\n                }\n            });\n        }); };\n        this.deleteAnnotation = function (annotationUrl) { return __awaiter(_this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                console.debug(\"Trying to delete annotation at URL: \", annotationUrl.toString());\n                return [2 /*return*/, this.solidRESTInteraction(annotationUrl, httpVerb.DELETE, {}, null)];\n            });\n        }); };\n        this.fetchAnnotation = function (annotationUrl) { return __awaiter(_this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        console.debug(\"Trying to fetch annotation at URL: \", annotationUrl.toString());\n                        return [4 /*yield*/, this.solidRESTInteraction(annotationUrl, httpVerb.GET, {}, null)];\n                    case 1: return [2 /*return*/, _a.sent()];\n                }\n            });\n        }); };\n        this.fetchAnnotations = function (containerUrl, filter) { return __awaiter(_this, void 0, void 0, function () {\n            var containerDataset, annotationUrls, annotationPromises, annotations, filtered;\n            var _this = this;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, getSolidDataset(containerUrl.toString(), { fetch: this.session.fetch })];\n                    case 1:\n                        containerDataset = _a.sent();\n                        return [4 /*yield*/, getContainedResourceUrlAll(containerDataset)];\n                    case 2:\n                        annotationUrls = _a.sent();\n                        annotationPromises = annotationUrls.map(function (url) {\n                            return _this.fetchAnnotation(new URL(url));\n                        });\n                        return [4 /*yield*/, Promise.all(annotationPromises).then(function (responses) {\n                                // filter out responses with error status\n                                var goodResponses = responses.filter(function (resp) {\n                                    if (resp.status >= 400) {\n                                        console.error(\"Could not fetch annotation:\", resp);\n                                    }\n                                    return resp.status < 400;\n                                });\n                                // only include those annotations passing constraints specified in filter object\n                                // return those annotations...\n                                var readerPromises = goodResponses.map(function (resp) {\n                                    return resp.body.getReader().read();\n                                });\n                                return Promise.all(readerPromises).then(function (dataAllResponses) {\n                                    return dataAllResponses.map(function (data) {\n                                        var decoded = new TextDecoder(\"utf-8\").decode(data.value);\n                                        try {\n                                            return JSON.parse(decoded);\n                                        }\n                                        catch (_a) {\n                                            console.error(\"Error parsing json document, skipping\");\n                                            console.log(decoded);\n                                            return null;\n                                        }\n                                    }).filter(function (d) { return d !== null; });\n                                });\n                            })];\n                    case 3:\n                        annotations = _a.sent();\n                        filtered = annotations.filter(function (anno) {\n                            var passes = true;\n                            // ... with properties (keys) ...\n                            Object.keys(filter).forEach(function (key) {\n                                // ... that have values matching the equivalent property values in the filter.\n                                if (key in anno) {\n                                    var valsInAnno_1 = Array.isArray(anno[key]) ? anno[key] : [anno[key]];\n                                    var valsInFilter = Array.isArray(filter[key]) ? filter[key] : [filter[key]];\n                                    valsInFilter.forEach(function (val) {\n                                        if (!(valsInAnno_1.includes(val))) {\n                                            // uh oh, filter's value for this key is not included in annotation\n                                            passes = false;\n                                        }\n                                    });\n                                }\n                                else {\n                                    // uh oh, filter on a property that this annotation doesn't include\n                                    passes = false;\n                                }\n                            });\n                            return passes;\n                        });\n                        console.debug(\"fetchAnnotations returning the following filtered list of annotations:\", filtered);\n                        return [2 /*return*/, filtered];\n                }\n            });\n        }); };\n        this.session = session;\n    }\n    return SolidClient;\n}());\nexport default SolidClient;\n/*\n   fetchAnnotations(): Annotation[] {\n// Fetch annotations and format as {id, start, end, data}\nreturn [];\n}\n\nfetchAnnotationTypes(): AnnotationMotivation[] {\n// Fetch annotation types\nreturn [];\n}*/\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Component } from \"react\";\nimport { Button, Col, Form, Row } from \"react-bootstrap-v5\";\nvar AudioSelector = /** @class */ (function (_super) {\n    __extends(AudioSelector, _super);\n    function AudioSelector() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.state = {\n            nodeid: \"7c338222-6c68-45ce-a1aa-f2a41a261520\",\n            result: \"\"\n        };\n        _this.onInputChange = function (e) {\n            _this.setState({ nodeid: e.target.value });\n        };\n        _this.searchNode = function () { return __awaiter(_this, void 0, void 0, function () {\n            var response, error_1;\n            var _a, _b;\n            return __generator(this, function (_c) {\n                switch (_c.label) {\n                    case 0:\n                        console.debug(\"Hello \" + this.state.nodeid);\n                        _c.label = 1;\n                    case 1:\n                        _c.trys.push([1, 3, , 4]);\n                        return [4 /*yield*/, this.props.trompaClient.getThingById(this.state.nodeid)];\n                    case 2:\n                        response = _c.sent();\n                        console.debug(\"Apollo response:\", response);\n                        if ((_b = (_a = response === null || response === void 0 ? void 0 : response.data) === null || _a === void 0 ? void 0 : _a.ThingInterface) === null || _b === void 0 ? void 0 : _b.length) {\n                            this.setState({ result: \"You selected \" + response.data.ThingInterface[0].contentUrl });\n                            // Send the resource back to the parent component\n                            this.props.onSelect({ source: response.data.ThingInterface[0].contentUrl });\n                        }\n                        else {\n                            this.setState({ result: \"No item with this id\" });\n                        }\n                        return [3 /*break*/, 4];\n                    case 3:\n                        error_1 = _c.sent();\n                        this.setState({ result: \"Error! \" + error_1 });\n                        return [3 /*break*/, 4];\n                    case 4: return [2 /*return*/];\n                }\n            });\n        }); };\n        return _this;\n    }\n    AudioSelector.prototype.render = function () {\n        return (_jsxs(\"div\", { children: [_jsxs(Row, __assign({ className: \"align-items-center\" }, { children: [_jsx(Col, { children: _jsx(Form.Group, __assign({ controlId: \"exampleForm.ControlInput1\" }, { children: _jsx(Form.Control, { placeholder: \"CE uuid\", value: this.state.nodeid, onChange: this.onInputChange }, void 0) }), void 0) }, void 0),\n                        _jsx(Col, __assign({ xs: \"auto\" }, { children: _jsx(Button, __assign({ type: \"submit\", className: \"mb-2\", onClick: this.searchNode }, { children: \"Submit\" }), void 0) }), void 0)] }), void 0),\n                this.state.result] }, void 0));\n    };\n    return AudioSelector;\n}(Component));\nexport default AudioSelector;\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __spreadArray = (this && this.__spreadArray) || function (to, from) {\n    for (var i = 0, il = from.length, j = to.length; i < il; i++, j++)\n        to[j] = from[i];\n    return to;\n};\nimport { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { Component } from 'react';\nimport { Button, Col, FormControl, InputGroup, ListGroup, Row } from 'react-bootstrap-v5';\nimport { useWebId } from \"@solid/react\";\nimport { ADDITIONAL_TYPE_TAG_COLLECTION, ADDITIONAL_TYPE_TAG_COLLECTION_ELEMENT } from \"../API/CEAPI\";\n/**\n * A wrapper that ensures that we always give a logged in user to DefinedTermSetEditor\n * @param trompaClient\n * @constructor\n */\nvar DefinedTermSetEditorWithUser = function (_a) {\n    var trompaClient = _a.trompaClient;\n    var webId = useWebId();\n    return _jsxs(\"div\", { children: [webId && _jsx(DefinedTermSetEditor, { trompaClient: trompaClient, webId: webId }, void 0),\n            !webId && _jsx(\"p\", { children: \"You need to log in to use the editor\" }, void 0)] }, void 0);\n};\nvar DefinedTermSetEditor = /** @class */ (function (_super) {\n    __extends(DefinedTermSetEditor, _super);\n    function DefinedTermSetEditor(props) {\n        var _this = _super.call(this, props) || this;\n        _this.createDefinedTermSet = function () { return __awaiter(_this, void 0, void 0, function () {\n            var dts, response, existingData, newData, _a;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        dts = {\n                            type: 'DefinedTermSet',\n                            creator: this.props.webId,\n                            additionalType: ADDITIONAL_TYPE_TAG_COLLECTION,\n                            name: this.state.newDtsName,\n                            hasDefinedTerm: []\n                        };\n                        _b.label = 1;\n                    case 1:\n                        _b.trys.push([1, 3, , 4]);\n                        return [4 /*yield*/, this.props.trompaClient.createOrUpdateDefinedTermSet(dts)];\n                    case 2:\n                        response = _b.sent();\n                        existingData = [];\n                        if (this.state.data !== undefined) {\n                            existingData = this.state.data.slice();\n                        }\n                        newData = __spreadArray(__spreadArray([], existingData), [response.data.CreateDefinedTermSet]);\n                        this.setState({ data: newData, newDtsName: '' });\n                        return [3 /*break*/, 4];\n                    case 3:\n                        _a = _b.sent();\n                        return [3 /*break*/, 4];\n                    case 4: return [2 /*return*/];\n                }\n            });\n        }); };\n        _this.createDefinedTerm = function () { return __awaiter(_this, void 0, void 0, function () {\n            var newData, selectedDts, dtsIdentifier, dt, response, existingData, e_1;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (this.state.selectedDts === undefined) {\n                            return [2 /*return*/];\n                        }\n                        newData = __spreadArray([], this.state.data);\n                        selectedDts = __assign({}, newData[this.state.selectedDts]);\n                        dtsIdentifier = selectedDts.identifier;\n                        dt = {\n                            type: 'DefinedTerm',\n                            creator: this.props.webId,\n                            additionalType: ADDITIONAL_TYPE_TAG_COLLECTION_ELEMENT,\n                            termCode: this.state.newDtName,\n                        };\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([1, 3, , 4]);\n                        return [4 /*yield*/, this.props.trompaClient.createOrUpdateDefinedTerm(dtsIdentifier, dt)];\n                    case 2:\n                        response = _a.sent();\n                        existingData = [];\n                        if (selectedDts.hasDefinedTerm.length) {\n                            existingData = selectedDts.hasDefinedTerm.slice();\n                        }\n                        selectedDts.hasDefinedTerm = __spreadArray(__spreadArray([], existingData), [response.data]);\n                        newData[this.state.selectedDts] = selectedDts;\n                        this.setState({ data: newData, newDtName: '' });\n                        return [3 /*break*/, 4];\n                    case 3:\n                        e_1 = _a.sent();\n                        console.error(\"Error when creating DefinedTerm\");\n                        console.error(e_1);\n                        return [3 /*break*/, 4];\n                    case 4: return [2 /*return*/];\n                }\n            });\n        }); };\n        _this.deleteDefinedTermSet = function (identifier, index) { return __awaiter(_this, void 0, void 0, function () {\n            var existingData, e_2;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 2, , 3]);\n                        return [4 /*yield*/, this.props.trompaClient.deleteDefinedTermSet(identifier)];\n                    case 1:\n                        _a.sent();\n                        existingData = this.state.data.slice();\n                        existingData.splice(index, 1);\n                        this.setState({ data: existingData });\n                        return [3 /*break*/, 3];\n                    case 2:\n                        e_2 = _a.sent();\n                        console.debug(\"error while deleting a DTS\");\n                        console.error(e_2);\n                        return [3 /*break*/, 3];\n                    case 3: return [2 /*return*/];\n                }\n            });\n        }); };\n        _this.deleteDefinedTerm = function (dtIdentifier, dtIndex) { return __awaiter(_this, void 0, void 0, function () {\n            var newData, selectedDts, existingDefinedTerms, e_3;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (this.state.selectedDts === undefined) {\n                            return [2 /*return*/];\n                        }\n                        newData = __spreadArray([], this.state.data);\n                        selectedDts = __assign({}, newData[this.state.selectedDts]);\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([1, 3, , 4]);\n                        return [4 /*yield*/, this.props.trompaClient.deleteDefinedTerm(selectedDts.identifier, dtIdentifier)];\n                    case 2:\n                        _a.sent();\n                        existingDefinedTerms = selectedDts.hasDefinedTerm.slice();\n                        existingDefinedTerms.splice(dtIndex, 1);\n                        selectedDts.hasDefinedTerm = existingDefinedTerms;\n                        newData[this.state.selectedDts] = selectedDts;\n                        this.setState({ data: newData });\n                        return [3 /*break*/, 4];\n                    case 3:\n                        e_3 = _a.sent();\n                        console.error(\"Error deleting DefinedTerm\");\n                        console.error(e_3);\n                        return [3 /*break*/, 4];\n                    case 4: return [2 /*return*/];\n                }\n            });\n        }); };\n        _this.setSelectedDts = function (selected) {\n            _this.setState({ selectedDts: selected });\n        };\n        _this.updateNewDtsName = function (event) {\n            _this.setState({ newDtsName: event.target.value });\n        };\n        _this.updateNewDtName = function (event) {\n            _this.setState({ newDtName: event.target.value });\n        };\n        _this.state = {\n            data: [],\n            selectedDts: undefined,\n            newDtsName: '',\n            newDtName: '',\n            error: false\n        };\n        return _this;\n    }\n    DefinedTermSetEditor.prototype.componentDidMount = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var response, e_4;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 2, , 3]);\n                        return [4 /*yield*/, this.props.trompaClient.getDefinedTermSetsForUser(this.props.webId, 'https://vocab.trompamusic.eu/vocab#TagCollection')];\n                    case 1:\n                        response = _a.sent();\n                        this.setState({ data: response.data.DefinedTermSet });\n                        return [3 /*break*/, 3];\n                    case 2:\n                        e_4 = _a.sent();\n                        this.setState({ error: true });\n                        return [3 /*break*/, 3];\n                    case 3: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    DefinedTermSetEditor.prototype.render = function () {\n        var _this = this;\n        var _a;\n        return _jsxs(Row, { children: [_jsx(Col, __assign({ lg: 6 }, { children: _jsxs(ListGroup, { children: [\" \", this.state.data &&\n                                this.state.data.map(function (definedTermSet, index) {\n                                    return _jsx(ListGroup.Item, __assign({ action: true, as: \"a\", active: _this.state.selectedDts === index, onClick: function () { return _this.setSelectedDts(index); } }, { children: _jsxs(Row, { children: [_jsxs(Col, { children: [definedTermSet.name, _jsx(\"br\", {}, void 0),\n                                                        _jsxs(\"small\", { children: [\"id: \", definedTermSet.identifier] }, void 0)] }, void 0),\n                                                _jsx(Col, __assign({ xs: 3 }, { children: _jsx(Button, __assign({ variant: \"outline-danger\", size: \"sm\", onClick: function (e) {\n                                                            _this.deleteDefinedTermSet(definedTermSet.identifier, index);\n                                                            _this.setSelectedDts(undefined);\n                                                            e.stopPropagation();\n                                                        } }, { children: \"Delete\" }), void 0) }), void 0)] }, void 0) }), definedTermSet.identifier);\n                                }),\n                            _jsx(ListGroup.Item, __assign({ action: true, as: \"a\" }, { children: _jsxs(InputGroup, { children: [_jsx(FormControl, { placeholder: \"New Category\", \"aria-label\": \"New Category\", type: \"text\", value: this.state.newDtsName, onChange: this.updateNewDtsName }, void 0),\n                                        _jsx(Button, __assign({ variant: \"outline-success\", onClick: this.createDefinedTermSet }, { children: \"Create\" }), void 0)] }, void 0) }), void 0)] }, void 0) }), void 0),\n                _jsx(Col, { children: this.state.selectedDts !== undefined && this.state.data && this.state.data[this.state.selectedDts] && _jsxs(_Fragment, { children: [_jsx(\"h4\", { children: \"DefinedTerms\" }, void 0),\n                            _jsxs(ListGroup, { children: [(_a = this.state.data[this.state.selectedDts].hasDefinedTerm) === null || _a === void 0 ? void 0 : _a.map(function (definedTerm, dtIndex) {\n                                        return (_jsx(ListGroup.Item, __assign({ action: true, as: \"a\" }, { children: _jsxs(Row, { children: [_jsx(Col, { children: definedTerm.termCode }, void 0),\n                                                    _jsx(Col, __assign({ xs: 3 }, { children: _jsx(Button, __assign({ variant: \"outline-danger\", size: \"sm\", onClick: function () {\n                                                                _this.deleteDefinedTerm(definedTerm.identifier, dtIndex);\n                                                            } }, { children: \"Delete\" }), void 0) }), void 0)] }, void 0) }), definedTerm.identifier));\n                                    }),\n                                    _jsx(ListGroup.Item, __assign({ action: true, as: \"a\" }, { children: _jsxs(InputGroup, { children: [_jsx(FormControl, { placeholder: \"New Category\", \"aria-label\": \"New Category\", type: \"text\", value: this.state.newDtName, onChange: this.updateNewDtName }, void 0),\n                                                _jsx(Button, __assign({ variant: \"outline-success\", onClick: this.createDefinedTerm }, { children: \"Create\" }), void 0)] }, void 0) }), void 0)] }, void 0)] }, void 0) }, void 0)] }, void 0);\n    };\n    return DefinedTermSetEditor;\n}(Component));\nexport { DefinedTermSetEditor };\nexport default DefinedTermSetEditorWithUser;\n","import React, { Component } from \"react\";\nimport SelectableScore from \"selectable-score/lib/selectable-score\";\nimport NextPageButton from \"selectable-score/lib/next-page-button.js\";\nimport PrevPageButton from \"selectable-score/lib/prev-page-button.js\";\nimport AnnotationSubmitter from \"../annotations/AnnotationSubmitter\";\nimport SelectionHandler from \"../annotations/selectionHandler\";\nimport AnnotationList from \"../annotations/annotationList\";\nimport ReactPlayer from \"react-player\";\nimport RenditionsPlaylist from \"../annotations/renditionsPlaylist\";\n\nimport ArrowToLeft from \"../graphics/arrow-to-left-regular.svg\";\nimport ArrowToRight from \"../graphics/arrow-to-right-regular.svg\";\nimport SearchMinus from \"../graphics/search-minus-solid.svg\";\nimport SearchPlus from \"../graphics/search-plus-solid.svg\";\nimport { AnyAction, bindActionCreators, Dispatch } from \"redux\";\nimport { connect } from \"react-redux\";\nimport FtempoSearch from \"./FtempoSearch\";\nimport { Session } from \"@inrupt/solid-client-authn-browser\";\nimport { SolidClient } from \"trompa-annotation-component/dist\";\nimport { Button } from \"react-bootstrap-v5\";\n\nconst vAdjust = 25; // num. pixels to nudge down anno measureBoxes+\nconst defaultVerovioScale = 50;\n\nlet viewPortHeight = window.outerHeight;\nlet viewPortWidth = window.outerWidth;\n// prettier-ignore\nconst defaultVerovioHeight = (viewPortHeight < 1439) ? 2000 : 2500;\n// prettier-ignore\nconst defaultVerovioWidth = (viewPortWidth > 1925) ? 2800 : 2000;\n\n// Selector to say if we're showing the annotation interface or F-tempo search\nenum ApplicationMode {\n  Annotate = \"Annotate\",\n  Search = \"Search\",\n  Ready = \"Ready\",\n}\n\ntype VerovioOptions = {\n  scale: number;\n  adjustPageHeight: number;\n  pageHeight: number;\n  pageWidth: number;\n  footer: string;\n  unit: number;\n};\n\ntype SelectableScoreAppProps = {\n  resourceUri: string;\n  submitUri: string;\n  currentMedia?: string;\n  // Bound from the SelectableScore redux\n  score: any;\n  solidSession: Session;\n};\n\ntype SelectableScoreAppState = {\n  annoValue: string;\n  selection: Element[];\n  selectorString: string[];\n  replyAnnotationTarget: AnnotationTarget[];\n  currentAnnotation: Annotation[];\n  hasContent: boolean;\n  currentMedia: string;\n  seekTo: string;\n  measuresToAnnotationsMap: { [key: string]: string[] };\n  annoToDisplay: any[];\n  replyAnnotationTargetId: string;\n  areRepliesVisible: boolean;\n  scoreReady: boolean;\n  applicationMode: ApplicationMode;\n  vrvOptions: VerovioOptions;\n};\n\nclass SelectableScoreApp extends Component<\n  SelectableScoreAppProps,\n  SelectableScoreAppState\n> {\n  constructor(props: Readonly<SelectableScoreAppProps>) {\n    super(props);\n    this.state = {\n      annoValue: \"\",\n      selection: [],\n      selectorString: [],\n      replyAnnotationTarget: [],\n      currentAnnotation: [],\n      hasContent: true,\n      currentMedia: this.props.currentMedia || \"\",\n      seekTo: \"\",\n      measuresToAnnotationsMap: {},\n      annoToDisplay: [],\n      replyAnnotationTargetId: \"\",\n      areRepliesVisible: false,\n\n      scoreReady: false,\n      applicationMode: ApplicationMode.Ready,\n      vrvOptions: {\n        scale: defaultVerovioScale,\n        adjustPageHeight: 0,\n        pageHeight: defaultVerovioHeight,\n        pageWidth: defaultVerovioWidth,\n        footer: \"none\",\n        unit: 6,\n      },\n    };\n    this.handleSelectionChange = this.handleSelectionChange.bind(this);\n    this.handleStringChange = this.handleStringChange.bind(this);\n    this.convertCoords = this.convertCoords.bind(this);\n    this.annotate = this.annotate.bind(this);\n    this.handlePageTurn = this.handlePageTurn.bind(this);\n  }\n\n  private player = React.createRef<ReactPlayer>();\n\n  zoomIn = () => {\n    let step = 5;\n    let initialZoom = this.state.vrvOptions.scale;\n    let initialHeight = this.state.vrvOptions.pageHeight;\n    let initialWidth = this.state.vrvOptions.pageWidth;\n\n    const newVrvOptions = Object.assign({}, this.state.vrvOptions);\n    newVrvOptions.scale = initialZoom + step;\n    //prettier-ignore\n    newVrvOptions.pageHeight = initialHeight - (newVrvOptions.scale * 5);\n    //prettier-ignore\n    newVrvOptions.pageWidth = initialWidth - (newVrvOptions.scale * 2);\n    if (newVrvOptions.scale < 50) {\n      //prettier-ignore\n      newVrvOptions.pageWidth = initialWidth - (newVrvOptions.scale * 5);\n    }\n\n    if (newVrvOptions.scale < 40) {\n      //prettier-ignore\n      newVrvOptions.pageHeight = initialHeight - (newVrvOptions.scale * 8);\n      //prettier-ignore\n      newVrvOptions.pageWidth = initialWidth - (newVrvOptions.scale * 5);\n    }\n    if (viewPortWidth >= 1925) {\n      if (newVrvOptions.pageWidth > 3500) {\n        newVrvOptions.pageWidth = 3500;\n      }\n    }\n\n    if (newVrvOptions.scale >= 80) {\n      console.log(\"max zoom reached\");\n      return;\n    }\n    // if (newVrvOptions.pageWidth >= 2380) {\n    //   newVrvOptions.pageWidth = 2380;\n    // }\n    // if (newVrvOptions.pageWidth < 1500 || newVrvOptions.pageWidth > 1500) {\n    //   newVrvOptions.pageWidth = 1500;\n    // }\n    // if (newVrvOptions.pageHeight < 1500 || newVrvOptions.pageHeight > 1500) {\n    //   newVrvOptions.pageHeight = 1500;\n    // }\n    console.log(\n      \"ZOOM INCREASE\",\n      newVrvOptions.scale,\n      \"page w\",\n      newVrvOptions.pageWidth,\n      \"page h\",\n      newVrvOptions.pageHeight\n    );\n    this.setState({ vrvOptions: newVrvOptions });\n  };\n\n  zoomOut = () => {\n    let step = 5;\n    let initialZoom = this.state.vrvOptions.scale;\n    let initialHeight = this.state.vrvOptions.pageHeight;\n    let initialWidth = this.state.vrvOptions.pageWidth;\n    //   vrvOptions.scale = vrvOptions.scale + step;\n    //   vrvOptions.pageHeight = (pageHeight * 100) / vrvOptions.scale;\n    //   vrvOptions.pageWidth = (pageWidth * 100) / vrvOptions.scale;\n    //\n    const newVrvOptions = Object.assign({}, this.state.vrvOptions);\n    newVrvOptions.scale = initialZoom - step;\n    //prettier-ignore\n    newVrvOptions.pageHeight = initialHeight + (newVrvOptions.scale * 5);\n    //prettier-ignore\n    newVrvOptions.pageWidth = initialWidth + (newVrvOptions.scale * 2);\n    if (newVrvOptions.scale < 50) {\n      //prettier-ignore\n      newVrvOptions.pageWidth = initialWidth + (newVrvOptions.scale * 5);\n    }\n\n    if (newVrvOptions.scale < 40) {\n      //prettier-ignore\n      newVrvOptions.pageHeight = initialHeight + (newVrvOptions.scale * 8);\n      //prettier-ignore\n      newVrvOptions.pageWidth = initialWidth + (newVrvOptions.scale * 5);\n    }\n\n    if (newVrvOptions.scale <= 25) {\n      console.log(\"minimum zoom reached\");\n      return;\n    }\n    // if (newVrvOptions.pageWidth < 1500 || newVrvOptions.pageWidth > 1500) {\n    //   newVrvOptions.pageWidth = 1500;\n    // }\n    // if (newVrvOptions.pageHeight < 1500 || newVrvOptions.pageHeight > 1500) {\n    //   newVrvOptions.pageHeight = 1500;\n    // }\n    console.log(\n      \"ZOOM DECREASE\",\n      newVrvOptions.scale,\n      \"page w\",\n      newVrvOptions.pageWidth,\n      \"page h\",\n      newVrvOptions.pageHeight\n    );\n    this.setState({ vrvOptions: newVrvOptions });\n  };\n\n  showReplyHandler = () => {\n    this.setState({ areRepliesVisible: !this.state.areRepliesVisible });\n  };\n\n  convertCoords(elem: SVGGraphicsElement) {\n    if (\n      document.getElementById(elem.getAttribute(\"id\")!) &&\n      elem.style.display !== \"none\" &&\n      (elem.getBBox().x !== 0 || elem.getBBox().y !== 0)\n    ) {\n      //trims the box to fit within the measure and avoids overflowing slurs etc\n      const staff1 = elem.getElementsByClassName(\"staff\")[0];\n      //magic from David Lewis\n      const staffLines = Array.prototype.filter.call(\n        staff1.children,\n        (x) => x.tagName === \"path\"\n      );\n      //sets the bounding box size to the stafflines size\n      const bbox = staffLines[0].getBBox();\n      const x = elem.getBBox().x;\n      const width = bbox.width;\n      const y = elem.getBBox().y;\n      const height = elem.getBBox().height;\n      const offset = elem\n        .closest(\"svg\")!\n        .parentElement!.getBoundingClientRect();\n      const matrix = elem.getScreenCTM()!;\n      return {\n        x: matrix.a * x + matrix.c * y + matrix.e - offset.left,\n        y: matrix.b * x + matrix.d * y + matrix.f - offset.top,\n        x2: matrix.a * (x + width) + matrix.c * y + matrix.e - offset.left,\n        y2: matrix.b * x + matrix.d * (y + height) + matrix.f - offset.top,\n      };\n    } else {\n      console.warn(\"Element unavailable on page: \", elem.getAttribute(\"id\"));\n      return { x: 0, y: 0, x2: 0, y2: 0 };\n    }\n  }\n\n  handleStringChange(selectorString: string[]) {\n    this.setState({ selectorString });\n  }\n\n  handleSelectionChange(selection: Element[]) {\n    this.setState({ selection });\n  }\n\n  //////////// NEEDS TO WIPE TARGET REPLY AFTER REPLYING TO IT ALSO THE ANNOTATION TYPE HANDLING IS MESSY\n  // TODO: Don't make reply handler change the annotator field - use an input box below the listed annotation\n  onAnnoReplyHandler = (\n    replyTarget: AnnotationTarget[],\n    replyTargetId: string\n  ) => {\n    this.setState({\n      replyAnnotationTarget: replyTarget,\n      replyAnnotationTargetId: replyTargetId,\n    });\n  };\n\n  /**\n   * Called when the AnnotationSubmitter wants to save an annotation\n   */\n  saveAnnotation = async (annotation: any) => {\n    console.log(\"selectable score: about to save an annotation\");\n    console.log(annotation);\n    const solidClient = new SolidClient(this.props.solidSession);\n    await solidClient.saveAnnotation(annotation, this.props.submitUri);\n    // TODO: we shouldn't reload all annotations - instead just update state and re-compute boxes\n    await this.onRefreshClick();\n  };\n\n  /**\n   * Called when the \"load annotations\" <button> is clicked\n   */\n  onRefreshClick = async () => {\n    const solidClient = new SolidClient(this.props.solidSession);\n    // TODO: correctly get the pod uri for this session\n    let podUrl = new URL(this.props.solidSession.info!.webId!).origin;\n    if (!podUrl.endsWith(\"/\")) {\n      podUrl = podUrl + \"/\";\n    }\n    const containerUrl = podUrl + this.props.submitUri;\n    const annotations = await solidClient.fetchAnnotations(\n      new URL(containerUrl),\n      {}\n    );\n    console.log(\"loaded annotations\");\n    console.log(annotations);\n    this.setState({\n      replyAnnotationTarget: [],\n      replyAnnotationTargetId: \"\",\n      annoToDisplay: [],\n    });\n    this.onReceiveAnnotationContainerContent(annotations);\n  };\n\n  onMediaClick = (bodyMedia: string) => {\n    console.log(\"button click\", bodyMedia);\n    //appends http fragment to avoid partial linking error\n    //const mediaCue = bodies[0][\"id\"];\n    // TODO validate properly\n    const currentMedia = bodyMedia.split(\"#\")[0];\n    const seekTo = bodyMedia.split(\"#\")[1].replace(\"t=\", \"\");\n    console.log(\"Setting up seek to: \", currentMedia, seekTo);\n    this.setState({ currentMedia }, () => {\n      if (this.player.current) {\n        this.player.current.seekTo(parseInt(seekTo, 10));\n      }\n    });\n  };\n\n  /**\n   * Called when a bunch of annotations are loaded by selectablescore\n   * @param content array of annotations\n   */\n  onReceiveAnnotationContainerContent = (content: Annotation[]) => {\n    // No annotations, undo all of the boxes on the score\n    if (!content || !content.length) {\n      alert(\"no annotation to retrieve\");\n      const noLongerInFocusList = Array.from(\n        document.getElementsByClassName(\"inFocus\")\n      );\n      noLongerInFocusList.forEach((noFocusElement) =>\n        noFocusElement.classList.remove(\"inFocus\")\n      );\n      document.querySelectorAll(\".measureBox\").forEach((mb) => mb.remove());\n      document\n        .querySelectorAll(\".measureBoxBackground\")\n        .forEach((mb) => mb.remove());\n      return;\n    }\n    // FIXME: Validate that these are (TROMPA?) Web Annotations\n    content = content.filter((c) => c && c[\"@id\"]!.endsWith(\".jsonld\"));\n\n    let measuresToAnnotationsMapList = content.map((anno) => {\n      let distinctMeasures: any[] = [];\n      // replying annotations don't have distinct measures since they target\n      // annotations, *not* MEI elements\n      if (anno.motivation !== \"replying\") {\n        const measures = anno.target\n          .map((jsonTarget: AnnotationTarget) => {\n            const targetId = jsonTarget.id;\n            const fragment = targetId.substr(targetId.lastIndexOf(\"#\"));\n            const element = document.querySelector(fragment);\n            let measure = null;\n            if (element) {\n              measure = element.closest(\".measure\");\n            }\n            return measure;\n          })\n          .filter((el: Element | null) => el); // ensure element exists on screen\n        distinctMeasures = Array.from(new Set(measures));\n      }\n      return { annoId: anno[\"@id\"]!, measures: distinctMeasures };\n    });\n    let newMap: { [key: string]: string[] } = {};\n    measuresToAnnotationsMapList.forEach((measureToAnnoMap) => {\n      measureToAnnoMap.measures.forEach((m) => {\n        const mId: string = m.getAttribute(\"id\");\n        if (mId in newMap) {\n          newMap[mId].push(measureToAnnoMap.annoId);\n        } else {\n          newMap[mId] = [measureToAnnoMap.annoId];\n        }\n      });\n    });\n\n    this.setState(\n      { currentAnnotation: content, measuresToAnnotationsMap: newMap },\n      () => {\n        const noLongerInFocusList = Array.from(\n          document.getElementsByClassName(\"inFocus\")\n        );\n        noLongerInFocusList.forEach((noFocusElement) =>\n          noFocusElement.classList.remove(\"inFocus\")\n        );\n        // delete any existing measure boxes so we can redraw from blank slate\n        document.querySelectorAll(\".measureBox\").forEach((mb) => mb.remove());\n        document\n          .querySelectorAll(\".measureBoxBackground\")\n          .forEach((mb) => mb.remove());\n        console.log(\"Mapped annotations \", newMap);\n        console.log(\"current annotations \", content);\n        // draw bounding boxes for all measures containing annotations\n        const annotatedMeasuresOnScreen = Object.keys(\n          this.state.measuresToAnnotationsMap\n        ).filter(\n          (measureId) => document.querySelectorAll(\"#\" + measureId).length\n        );\n        console.log(\n          \"Annotated measures on screen: \",\n          annotatedMeasuresOnScreen\n        );\n        annotatedMeasuresOnScreen.forEach((measureId) => {\n          const coords = this.convertCoords(\n            document.querySelector(\"#\" + measureId)!\n          );\n          console.log(\"Coords: \", coords);\n\n          const measureBox = document.createElement(\"div\");\n          const measureBoxBackground = document.createElement(\"div\");\n\n          const coordsBox = {\n            left: Math.floor(coords.x),\n            top: Math.floor(coords.y) + vAdjust,\n            width: Math.ceil(coords.x2 - coords.x),\n            height: Math.ceil(coords.y2 - coords.y),\n          };\n          console.log(\"Coords box: \", coordsBox);\n          measureBox.setAttribute(\"id\", \"measureBox-\" + measureId);\n          measureBox.setAttribute(\"class\", \"measureBox\");\n          measureBox.setAttribute(\n            \"style\",\n            \"position: absolute;\" +\n              \"background: rgba(0, 0, 0, 0);\" +\n              \"left: \" +\n              coordsBox.left +\n              \"px;\" +\n              \"top: \" +\n              coordsBox.top +\n              \"px;\" +\n              \"width: \" +\n              coordsBox.width +\n              \"px;\" +\n              \"height: \" +\n              coordsBox.height +\n              \"px;\" +\n              \"z-index: 1\"\n          );\n\n          measureBoxBackground.setAttribute(\n            \"id\",\n            \"measureBoxBackground-\" + measureId\n          );\n          measureBoxBackground.setAttribute(\"class\", \"measureBoxBackground\");\n          measureBoxBackground.classList.remove(\"isOpen\");\n          measureBoxBackground.classList.add(\"isClosed\");\n          measureBoxBackground.setAttribute(\n            \"style\",\n            \"position: absolute;\" +\n              // \"background: rgba(241, 145, 0, 0.25);\" +\n              // \"border:1px solid orange;\" +\n              \"left: \" +\n              coordsBox.left +\n              \"px;\" +\n              \"top: \" +\n              coordsBox.top +\n              \"px;\" +\n              \"width: \" +\n              coordsBox.width +\n              \"px;\" +\n              \"height: \" +\n              coordsBox.height +\n              \"px;\" +\n              \"z-index: -1\"\n          );\n          console.log(\"TRYING TO DRAW\", measureBox);\n          document\n            .querySelector(\".annotationBoxesContainer\")!\n            .appendChild(measureBox);\n          document\n            .querySelector(\".annotationBoxesContainer\")!\n            .appendChild(measureBoxBackground);\n\n          measureBox.onclick = (e) => {\n            const noLongerInFocusList = Array.from(\n              document.getElementsByClassName(\"inFocus\")\n            );\n            noLongerInFocusList.forEach((noFocusElement) =>\n              noFocusElement.classList.remove(\"inFocus\")\n            );\n            const bgBoxes = document.querySelectorAll(\".measureBoxBackground\");\n            const frontBox = (e.target as HTMLElement).closest(\".measureBox\");\n            bgBoxes.forEach((box) => {\n              box.classList.add(\"isClosed\");\n              box.classList.remove(\"isOpen\");\n              const bgBoxId = box.id.split(\"measureBoxBackground-\")[1];\n              const frontBoxId = frontBox!.id.split(\"measureBox-\")[1];\n\n              if (frontBoxId === bgBoxId) {\n                box.classList.remove(\"isClosed\");\n                box.classList.add(\"isOpen\");\n              }\n            });\n\n            const noLongerShowing = Array.from(\n              document.getElementsByClassName(\"showReply\")\n            );\n            console.log(\"no longer showing \", noLongerShowing);\n            //hides them\n\n            if (noLongerShowing.length) {\n              //const replyHolder = document.createElement(\"div\");\n              if (this.state.areRepliesVisible) {\n                this.setState({ areRepliesVisible: false });\n              }\n              const annoContainer = document.querySelector(\".listContainer\");\n              console.log(annoContainer);\n              //annoContainer.appendChild(replyHolder);\n              noLongerShowing.forEach((noReplyShowing) => {\n                noReplyShowing.classList.add(\"hiddenReply\");\n                annoContainer!.appendChild(noReplyShowing);\n              });\n              noLongerShowing.forEach((noReplyShowing) =>\n                noReplyShowing.classList.remove(\"showReply\")\n              );\n            }\n            this.handleAnnoShowingUpdate(content, measureId);\n          };\n        });\n      }\n    );\n\n    content.forEach((anno: Annotation) => {\n      if (anno.motivation !== \"replying\") {\n        anno.target.forEach((jsonTarget: AnnotationTarget) => {\n          const bodies = anno.body;\n          const targetId = jsonTarget.id;\n          const fragment = targetId.substr(targetId.lastIndexOf(\"#\"));\n          const element = document.querySelector(fragment);\n          if (!element) {\n            return console.warn(\"no content has been found\");\n          }\n          const annoId = anno[\"@id\"]!;\n          const annoIdFragment = annoId.substr(annoId.lastIndexOf(\"/\") + 1);\n          //checks what's the motivation of the target\n          switch (anno.motivation) {\n            case \"describing\":\n              if (bodies.length) {\n                if (\"value\" in bodies[0]) {\n                  // const title = document.createElementNS(\n                  //   \"http://www.w3.org/2000/svg\",\n                  //   \"title\"\n                  // );\n                  // Embeds the annotation text into this title node\n                  //title.innerHTML = bodies[0][\"value\"];\n                  //element.insertBefore(title, element.firstChild);\n                  //element.classList.add(anno.anno.motivation);\n                  element.classList.add(\"focus-\" + annoIdFragment);\n                }\n              }\n              break;\n            case \"linking\":\n              if (bodies.length) {\n                // make the target clickable, linking to the (first) body URI\n                // element.addEventListener(\n                //   \"click\",\n                //   function () {\n                //     //appends http fragment to avoid partial linking error\n                //     const URL = bodies[0][\"id\"];\n                //     if (URL.startsWith(\"http\")) {\n                //       window.open(URL, \"_blank\");\n                //     } else {\n                //       const appendURL = \"https://\" + URL;\n                //       window.open(appendURL, \"_blank\");\n                //     }\n                //   },\n                //   true\n                // );\n                // and turn the cursor into a pointer as a hint that it's clickable\n                element.classList.add(\"focus-\" + annoIdFragment);\n                //element.classList.add(anno.anno.motivation);\n                element.classList.add(\"focus-\" + annoIdFragment);\n              }\n              break;\n            case \"trompa:cueMedia\":\n              if (bodies.length) {\n                // make the target clickable, seeking player to the (first) body media cue\n                // element.onMediaClick = () => {\n                //   //appends http fragment to avoid partial linking error\n                //   const mediaCue = bodies[0][\"id\"];\n                //   // TODO validate properly\n                //   const currentMedia = mediaCue.split(\"#\")[0];\n                //   const seekTo = mediaCue.split(\"#\")[1].replace(\"t=\", \"\");\n                //   console.log(\"Setting up seek to: \", currentMedia, seekTo);\n                //   this.setState({ currentMedia }, () =>\n                //     this.player.current.seekTo(seekTo)\n                //   );\n                // };\n                // and turn the cursor into a pointer as a hint that it's clickable\n                element.classList.add(\"focus-\" + annoIdFragment);\n                //element.classList.add(\"cueMedia\");\n              }\n              break;\n            case \"trompa:cueImage\":\n              if (bodies.length) {\n                element.classList.add(\"focus-\" + annoIdFragment);\n                //element.classList.add(\"cueMedia\");\n              }\n              break;\n            case \"trompa:playlist\": {\n              return;\n            }\n\n            default:\n              console.log(\n                \"sorry, don't know what to do for this annotation boss\"\n              );\n          }\n        });\n      }\n    });\n  };\n\n  /**\n   * When clicking on a highlighted measure on the score, get a list\n   * of annotations (and all replies, even if they're not replies to\n   *  annotations in this measure)\n   * @param content all annotations that have been loaded\n   * @param measureId the fragment id of the measure that was selected\n   */\n  handleAnnoShowingUpdate = (content: Annotation[], measureId: string) => {\n    let _annoIds = content.map((jsonIds) => {\n      return jsonIds[\"@id\"];\n    });\n    let _filteredAnnoIds = this.state.measuresToAnnotationsMap[measureId];\n    let compare = _annoIds.filter(\n      (anno) => anno && _filteredAnnoIds.includes(anno)\n    );\n    // compare has all annotation IDs *for our measure*\n    // we want those, PLUS all replying annotations (which aren't tied to measures)\n    const annotationsToDisplay = [\n      ...compare,\n      ...content\n        .filter((anno) => anno.motivation === \"replying\") // get the replies\n        .map((anno) => anno[\"@id\"]), // and return their IDs\n    ];\n    console.log(\"to display: \", annotationsToDisplay);\n    this.setState({\n      annoToDisplay: annotationsToDisplay,\n    });\n  };\n\n  handleScoreUpdate = async (scoreElement: any) => {\n    // TODO: We shouldn't re-retrieve annotations on score update, just re-filter\n    //  the list that we have\n    console.log(\"Received updated score DOM element: \", scoreElement);\n    await this.onRefreshClick();\n  };\n\n  handlePageTurn() {\n    document.querySelectorAll(\".measureBox\").forEach((mb) => mb.remove());\n    document\n      .querySelectorAll(\".measureBoxBackground\")\n      .forEach((mb) => mb.remove());\n  }\n\n  annotate = () => {\n    this.setState({\n      applicationMode: ApplicationMode.Annotate,\n    });\n    this.onRefreshClick();\n  };\n\n  render() {\n    console.log(\n      \"rendering: is logged in? \" + this.props.solidSession.info.isLoggedIn\n    );\n    return (\n      <div>\n        <div>\n          <div className=\"scoreContainer\">\n            <div className=\"controls\">\n              <div className=\"prevPageButton\" onClick={this.handlePageTurn}>\n                <PrevPageButton\n                  buttonContent={<img src={ArrowToLeft} alt=\"previous page\" />}\n                  uri={this.props.resourceUri}\n                />\n              </div>\n              <button onClick={this.zoomOut} className=\"zoomOut\">\n                <img src={SearchMinus} alt=\"zoom out\" />\n              </button>\n              {/* pass anything as buttonContent that you'd like to function as a clickable next page button */}\n              <button onClick={this.zoomIn} className=\"zoomIn\">\n                <img src={SearchPlus} alt=\"zoom in\" />\n              </button>\n              <div className=\"nextPageButton\" onClick={this.handlePageTurn}>\n                <NextPageButton\n                  buttonContent={<img src={ArrowToRight} alt=\"next page\" />}\n                  uri={this.props.resourceUri}\n                />\n              </div>\n            </div>\n            <div className=\"annotationBoxesContainer\" />\n            <SelectableScore\n              uri={this.props.resourceUri}\n              vrvOptions={this.state.vrvOptions}\n              onSelectionChange={this.handleSelectionChange}\n              selectorString={this.state.selectorString}\n              onScoreUpdate={this.handleScoreUpdate}\n              selectionArea=\".scoreContainer\"\n              onScoreReady={() => {\n                this.setState({ scoreReady: true });\n              }}\n            />\n          </div>\n        </div>\n\n        <div>\n          {this.state.applicationMode === ApplicationMode.Ready && (\n            <>\n              <h3>Search using F-TEMPO (experimental)</h3>\n              <Button\n                variant=\"info\"\n                onClick={() => {\n                  this.setState({ applicationMode: ApplicationMode.Search });\n                }}\n                disabled={!this.state.scoreReady}\n              >\n                Show search options\n              </Button>\n\n              <h3>Annotate the score using the Annotation Tools</h3>\n              {!this.props.solidSession.info.isLoggedIn && (\n                <>\n                  <small>You must be logged in to perform annotations</small>\n                  <br />\n                </>\n              )}\n              <Button\n                variant=\"info\"\n                onClick={this.annotate}\n                disabled={\n                  !this.state.scoreReady ||\n                  !this.props.solidSession.info.isLoggedIn\n                }\n              >\n                Make an annotation\n              </Button>\n            </>\n          )}\n        </div>\n\n        {this.state.applicationMode === ApplicationMode.Search && (\n          <FtempoSearch vrvToolkit={this.props.score.vrvTk} />\n        )}\n\n        {this.state.applicationMode === ApplicationMode.Annotate && (\n          <div>\n            <SelectionHandler\n              selectorString={this.state.selectorString}\n              handleStringChange={this.handleStringChange}\n            />\n            {/*annotation submission component*/}\n            <AnnotationSubmitter\n              creator={this.props.solidSession.info!.webId!}\n              uri={this.props.resourceUri}\n              selection={this.state.selection}\n              saveAnnotation={this.saveAnnotation}\n              onRefreshClick={this.onRefreshClick}\n            />\n\n            <RenditionsPlaylist\n              allEntries={this.state.currentAnnotation}\n              onRefreshClick={this.onRefreshClick}\n            />\n\n            <AnnotationList\n              allEntries={this.state.currentAnnotation}\n              filteringEntries={this.state.annoToDisplay}\n              onAnnoReplyHandler={this.onAnnoReplyHandler}\n              onMediaClick={this.onMediaClick}\n              replyAnnotationTarget={this.state.replyAnnotationTarget}\n              showReplyHandler={this.showReplyHandler}\n              areRepliesVisible={this.state.areRepliesVisible}\n              onRefreshClick={this.onRefreshClick}\n            />\n            <ReactPlayer\n              width=\"80%\"\n              height=\"80%\"\n              ref={this.player}\n              url={this.state.currentMedia}\n              controls={true}\n              onReady={() => {\n                if (this.state.seekTo && this.player.current) {\n                  console.log(\"Seeking to: \", this.state.seekTo);\n                  this.player.current.seekTo(\n                    Math.floor(Number(this.state.seekTo))\n                  );\n                  this.setState({ seekTo: \"\" });\n                }\n              }}\n            />\n          </div>\n        )}\n      </div>\n    );\n  }\n}\n\nfunction mapStateToProps({ score }: any) {\n  return { score };\n}\n\nfunction mapDispatchToProps(dispatch: Dispatch<AnyAction>) {\n  return bindActionCreators({}, dispatch);\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps, null, {\n  forwardRef: true,\n})(SelectableScoreApp);\n","import React, { useState } from \"react\";\n\nimport SelectableScoreApp from \"./SelectableScoreApp\";\nimport {useSession} from \"@inrupt/solid-ui-react\";\n\nconst SolidWrapper = (props: {resourceUri: string}) => {\n    const [userInput, setUserInput] = useState(\"private/\");\n    const {session} = useSession();\n\n    return (\n        <div id=\"authWrapper\">\n            <p>Specify the annotation container path inside your Pod:</p>\n            <div>\n                <input\n                    title=\"enter your preferred POD folder\"\n                    type=\"text\"\n                    placeholder=\"private/\"\n                    onChange={(e) => {\n                        setUserInput(e.target.value ? e.target.value : \"private/\");\n                    }}\n                    className=\"sizedTextBox\"\n                />\n            </div>\n                <SelectableScoreApp\n                    resourceUri={props.resourceUri}\n                    submitUri={userInput}\n                    solidSession={session}\n                />\n        </div>\n    );\n};\n\nexport default SolidWrapper;\n","import React from \"react\";\nconst HelpPage = () => {\n  return (\n    <div>\n      <h3>Below you can find some tips on how to use the annotation tool:</h3>\n      <br />\n      <div>\n        <h4>How do I create an annotation?</h4>\n        <ol>\n          <li>\n            Select the type of selection you want to use (note, measure,\n            directives etc)\n          </li>\n          <li>\n            Drag across the score in order to select the elements you want to\n            annotate\n          </li>\n          <li>\n            You can select discontinuous measures by holding the shift key\n          </li>\n          <li>\n            Sometimes slurs can get in the way of your selection, you can\n            deselect unwanted measures by holding the shift key and clicking on\n            the measure you wish to deselect\n          </li>\n          <li>\n            Select the type of annotation you wish to submit (description, link\n            etc)\n          </li>\n          <li>\n            Type the text or paste the URL you wish to attach to the annotation\n          </li>\n          <li>Click the green submit button</li>\n        </ol>\n        <h4>I made a mistake in my annotation, how can I delete it?</h4>\n        <ul>\n          <li>\n            You can delete you annotation by clicking the rubbish bin icon in\n            the annotation item and click yes to delete it\n          </li>\n        </ul>\n\n        <h4>\n          I have replied to an annotation but I can’t see my reply, where is it?\n        </h4>\n        <ul>\n          <li>\n            You can see all the replies to the specific annotation by clicking\n            the “show replies button” in the annotation you are replying to\n          </li>\n        </ul>\n        <h4>\n          Can I create a different type of reply (media or image content)?\n        </h4>\n        <ul>\n          <li>\n            Not right now, this feature will be released in a future version of\n            the software\n          </li>\n        </ul>\n        <h4>How does the solid pod system work, is my data really safe?</h4>\n        <ul>\n          <li>\n            Solid was purposely built for data safety and protection, and by\n            design everything contained in the pod is private unless specified.\n            For more information visit the{\" \"}\n            <a\n              href=\"https://solidproject.org/\"\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n            >\n              solid project\n            </a>{\" \"}\n            page for more info\n          </li>\n        </ul>\n        <h4>I have found a bug, what can i do?</h4>\n        <ul>\n          <li>\n            Please submit a bug report to{\" \"}\n            <a href=\"mailto:fzuba001@gold.ac.uk?subject=Bug report\">\n              fzuba001@gold.ac.uk\n            </a>{\" \"}\n            describing the nature of the bug and how to reproduce it, make sure\n            to include browser model and operating system used. Thanks! :)\n          </li>\n        </ul>\n      </div>\n    </div>\n  );\n};\n\nexport default HelpPage;\n","import { Route, Switch, useLocation } from \"react-router-dom\";\nimport ResourceLoader from \"./ResourceLoader\";\nimport SolidWrapper from \"./SolidWrapper\";\nimport React from \"react\";\nimport HelpPage from \"./HelpPage\";\n\n/**\n * Check if the user is logged in with a solid session. If not, show a message informing\n * them that they need to be logged in.\n * If the are logged in, route to resource chooser or the annotator.\n */\nconst AnnotatorRouter = () => {\n  const location = useLocation();\n  const query = new URLSearchParams(location.search);\n  const resource = query.get(\"resource\");\n\n  return (\n    <Switch>\n      <Route exact path=\"/\">\n        <ResourceLoader />\n      </Route>\n      <Route exact path=\"/annotate\">\n        <SolidWrapper resourceUri={resource!} />\n      </Route>\n      <Route exact path=\"/help\">\n        <HelpPage />\n      </Route>\n    </Switch>\n  );\n};\n\nexport default AnnotatorRouter;\n","import React from \"react\";\nimport { ApolloClient, ApolloProvider, InMemoryCache } from \"@apollo/client\";\n\nimport { reducers } from \"meld-clients-core/lib/reducers\";\nimport { createStore, applyMiddleware } from \"redux\";\nimport thunk from \"redux-thunk\";\nimport { Provider } from \"react-redux\";\nimport ReduxPromise from \"redux-promise\";\nimport Navigation from \"./containers/Navigation\";\nimport { SessionProvider } from \"@inrupt/solid-ui-react\";\nimport { Container } from \"react-bootstrap-v5\";\nimport \"bootstrap/dist/css/bootstrap.min.css\";\nimport { useHistory } from \"react-router-dom\";\nimport AnnotatorRouter from \"./containers/AnnotatorRouter\";\n\nconst CE_URL = \"https://api.trompamusic.eu\";\n\nconst client = new ApolloClient({\n  uri: CE_URL,\n  cache: new InMemoryCache(),\n});\n\nfunction App() {\n  const createStoreWithMiddleware = applyMiddleware(\n    thunk,\n    ReduxPromise\n  )(createStore);\n\n  let history = useHistory();\n  // According to https://docs.inrupt.com/developer-tools/javascript/client-libraries/tutorial/restore-session-browser-refresh/\n  // A session created with solid-client-authn-browser won't reload when the user refreshes the page, so we\n  // use the {restorePreviousSession: true} trick to make this happen.\n  // The SessionProvider will call this callback once the user has been logged in, allowing us to\n  // redirect back to where they were.\n  const onSessionRestore = (url: string) => {\n    console.debug(\"onrestor url: \" + url);\n    const u = new URL(url);\n    console.debug(u);\n    history.push(u.hash.substring(1));\n  };\n\n  return (\n    <SessionProvider\n      sessionId=\"trompa-music-scholars-annotator\"\n      onSessionRestore={onSessionRestore}\n    >\n      <Provider store={createStoreWithMiddleware(reducers)}>\n        <ApolloProvider client={client}>\n          <Navigation />\n          <Container fluid=\"lg\" style={{ paddingLeft: \"0px\" }}>\n            <AnnotatorRouter />\n          </Container>\n        </ApolloProvider>\n      </Provider>\n    </SessionProvider>\n  );\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { HashRouter } from \"react-router-dom\";\n\nimport App from \"./App\";\n\nReactDOM.render(\n  // Load BrowserRouter as soon as possible so that we can use reactrouter\n  // hooks in App\n  <HashRouter>\n    <App />\n  </HashRouter>,\n  document.querySelector(\".container\")\n);\n"],"sourceRoot":""}